<!DOCTYPE html>
<!--

License:

OneZoom version 1.0.360 (2012)
Copyright (c) 2012 owned by James Rosindell and Imperial College, London
URL: www.onezoom.org
Citation: "OneZoom: A Fractal Explorer for the Tree of Life" PLoS Biology (2012) Rosindell, J. and Harmon, L. J.
All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), 
to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, 
and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, 
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


Notes:

Conceptualised and written by James Rosindell with advisory input at all stages of development from Luke Harmon

Please edit to include your own data by opening in a text editor and following the instructions
Please send us your edited software to be displayed at www.OneZoom.org where you will be credited as a contributor
Please refer to www.OneZoom.org for software updates
Please e-mail us using the address mail@onezoom.org
By using OneZoom, you agree to cite the associated paper in any resulting publications
When editing the software, you must not remove the author and copyright attribution information

If you see only control buttons and no phylogenetic tree on loading, your browser probably does not support the html 5 canvas element 
This software has been tested on the latest versions of safari (Mac), Google Chrome (PC) and firefox (Mac and PC) 

-->



<script type="text/javascript">
	
    function userdata()
	{
		// edit this line to change the default data
		fulltree = new midnode("(Cafeteria_roenbergensis_A0669_AY827851:1000,((Cafeteria_roenbergensis_A0672L27633:333.0718946,Cafeteria_roenbergensis_A0671_AY827849:333.0718946):333.3585326,(Cafeteria_roenbergensis_A0670_AY827850:333.2653687,((((((((((((((((((((((((((((((((((Thalassiosira_mediterranea_A0779_CS16C:9.517428224,Paraphysomonas_imperforata_A0798_AF109323:9.517428224):9.488145498,Thalassiosira_mediterranea_A0780_CS16D:19.00557372):9.536972716,Paraphysomonas_imperforata_A0799_AF109324:28.54254644):9.500808649,uncultured_diatom_A0612_AY180017:38.04335509):9.559433091,(Paraphysomonas_foraminifera_A0795_AF174376:23.76229832,Spumella_like_flagellateJBM06_A0834_AY651096:23.76229832):23.84048986):9.492446224,Paraphysomonas_foraminifera_A0794Z38025:57.0952344):9.529159928,Paraphysomonas_bandaiensis_A0800_AF109322:66.62439433):9.5345262,(Spumella_like_flagellateJBC29_A0828_AY651090:38.05011141,Spumella_like_flagellateJBNZ40_A0829_AY651091:38.05011141):38.10880912):9.527892975,(Paraphrysomonas_like_chrysophyte_A0804_AY821968_uncultured:42.79953798,Paraphysomonas_butcheri_A0797_AF109326:42.79953798):42.88727553):9.536416999,((((((Chrysamoeba_mikrokonta_A0785_AF123287:13.56797729,Chrysamoeba_pyrenoidifera_A0786_AF123286:13.56797729):13.61991703,uncultured_chrysophyte_A0807_AY821972:27.18789432):13.60288391,(Oikomonas_mutabilis_A1265U42454:20.37880808,Spumella_like_flagellateJBAF35_A0809_AY651071:20.37880808):20.41197015):13.58529519,Chromulina_nebulosa_A0789_AF123285:54.37607342):13.62745593,(((Paraphysomonas_vestita_A0792_AF109325:16.97859881,Spumella_like_flagellateJBAS37_A0832_AY651094:16.97859881):17.01368573,(Paraphysomonas_foraminifera_A0796_AB022864:16.9898866,Paraphysomonas_vestita_A0793Z28335:16.9898866):17.00239794):17.01458005,(Monas_sp._TONO_A1209_AB168053:25.47248097,Spumella_like_flagellateJBNZ43_A0833_AY651095:25.47248097):25.53438362):16.99666477):13.55173253,Phaeoplaca_thallosa_A0791_AF123296:81.55526188):13.66796862):9.520502782,(((((Chromulina_chromophila_A0781M87332:17.4244478,Chrysosaccus_sp._CCMP295_A0783_AF123300:17.4244478):17.48067216,(Chrysosphaera_parvula_A0782_AF123299:17.42543722,Lagynion_scherffelii_A0803_AF123288:17.42543722):17.47968274):17.42611424,Ochromonas_tuberculata_A1214_AF123293:52.3312342):17.47106074,(Spumella_like_flagellateJBM08_A0836_AY651098:34.89821339,Spumella_like_flagellateJBM18_A0830_AY651092:34.89821339):34.90408155):17.47513798,((uncultured_chrysophyte_A0805_AY180010:29.05427416,uncultured_chrysophyte_A0806_AJ867745:29.05427416):29.10331024,uncultured_stramenopile_A1284_AY179989:58.15758441):29.11984851):17.46630036):9.518499737,(((((Chrysochaete_britannica_A0788_AF123284:19.01639858,uncultured_eukaryote_A1317_AY082970:19.01639858):19.05106867,Chromophyton_rosanoffii_A0802_AF123282:38.06746725):19.02156317,Hibberdia_magna_A0801M87331:57.08903043):19.04118795,Chrysocapsa_vernalis_A0787_AF123283:76.13021838):19.06565854,(Cyclonexis_annularis_A1208_AF123292:47.58625577,Spumella_like_flagellateJBC27_A0831_AY651093:47.58625577):47.60962115):19.0663561):9.536896854,(((((((((Spumella_like_flagellateJBC31_A0810_AY651072:38.05735354,(((Spumella_like_flagellateJBAF32_A0814_AY651076:9.497947277,Spumella_like_flagellateJBNZ41_A0813_AY651075:9.497947277):9.518216976,Spumella_like_flagellateJBC30_A0811_AY651073:19.01616425):9.536147865,(Spumella_like_flagellateJBC07_A0835_AY651097:14.25783219,Spumella_like_flagellateJBM10_A0812_AY651074:14.25783219):14.29447993):9.505041424):9.505043307,uncultured_eukaryote_A1321_AY082999:47.56239685):9.534148275,uncultured_eukaryote_A1319_AY082987:57.09654512):9.56353979,(((Poterioochromonas_malhamensis_A1201_AB023070:16.66121947,Poterioochromonas_stipitata_A1202_AF123295:16.66121947):16.6307431,Poterioochromonas_sp._DO2004_A1203_AY699607:33.29196258):16.66369737,Spumella_like_flagellateJBAF33_A0815_AY651077:49.95565994):16.70442497):9.504237991,((Ochromonas_sphaerocystis_A1213_AF123294:25.3681744,Spumella_like_flagellateJBC22_A0816_AY651078:25.3681744):25.39666337,Ochromonas_danica_A1212M32704:50.76483777):25.39948513):9.468296723,Spumella_like_flagellateJBM28_A0827_AY651089:85.63261963):9.530999238,Chrysolepidomonas_dendrolepidota_A0784_AF123297:95.16361887):9.581158682,(((((((((Spumella_like_flagellateJBC13_A0818_AY651080:8.712339084,Spumella_like_flagellateJBCS23_A0819_AY651081:8.712339084):8.725754857,Spumella_danica_A1204_AJ236861:17.43809394):8.724864762,Spumella_like_flagellateJBAS36_A0817_AY651079:26.1629587):8.741832251,((soil_flagellate_AND29_A1198_AY994316:11.6178432,Spumella_like_flagellateJBCS24_A0820_AY651082:11.6178432):11.63357124,Spumella_like_flagellateJBMS11_A0821_AY651083:23.25141444):11.65337651):8.703113223,Spumella_like_flagellateJBM19_A0822_AY651084:43.60790418):8.717471514,Spumella_like_flagellateJBMS12_A0823_AY651085:52.32537569):8.751923742,(Ochromonas_CCMP584_A1210U42381:30.52581641,Uroglena_americana_A1207_AF123290:30.52581641):30.55148302):8.752275903,((((soil_flagellate_AND30_A1197_AY965871:13.95542989,Spumella_like_flagellateJBL14_A0824_AY651086:13.95542989):13.94775251,Spumella_like_flagellateJBM09_A0825_AY651087:27.9031824):13.95076817,uncultured_stramenopile_A1270_AF372747:41.85395057):13.9672181,Spumella_like_flagellateJBNZ39_A0826_AY651088:55.82116867):14.00840667):8.710496789,((Chrysoxys_sp._CCMP591_A0790_AF123302:26.15610883,Ochromonas_CCMP1278_A1211U42382:26.15610883):26.21196343,(Dinobryon_sertularia_A1205_AF123289:26.15389735,Dinobryon_socialevaramericana_A1206_AF123291:26.15389735):26.21417491):26.17199986):26.20470542):9.513671449,((Chrysonephele_palustris_A1199U71196:38.04880131,Epipyxis_aurea_A1195_AF123301:38.04880131):38.07144497,Epipyxis_pulchra_A1200_AF123298:76.12024628):38.13820271):9.540680878):9.417121098,Tessellaria_volvocina_A1215U73219:133.216251):9.605675798,(((Mallomonas_adamas_A1219U73225:35.67063716,Mallomonas_splendens_A1225U73226:35.67063716):35.70875907,(Mallomonas_caudata_A1222U73228:35.67980637,Mallomonas_matvienkoae_A1223U73227:35.67980637):35.69958985):35.69454224,Mallomonas_annulata_A1221U73230:107.0739385):35.74798831):9.438351014,Mallomonas_akrokomos_A1220U73229:152.2602778):9.603108981,((Mallomonas_papillosa_A1216M55285:53.92036852,Mallomonas_rasilis_A1224U73231:53.92036852):53.96319428,(Mallomonas_striata_A1217U73232:53.93270315,Mallomonas_striata_A1218M87333:53.93270315):53.95085965):53.97982397):9.508083166,(Synura_glabra_A1227U73224:85.62684365,Synura_petersenii_A1229U73223:85.62684365):85.74462629):9.442737669,Synura_uvella_A1231U73222:180.8142076):9.58441012,(Synura_mammillosa_A1228U73220:95.15612633,Synura_spinosa_A1226M87336:95.15612633):95.2424914):9.444151842,Synura_sphagnicola_A1230U73221:199.8427696):9.601192453,(Chlamydomyxa_labyrinthuloides_A1196_AJ130893:104.6760474,uncultured_chrysophyte_A0808_AY821967:104.6760474):104.7679146):9.431191854,Picophagus_flagellatus_A1305_AF185051:218.8751539):9.671713912,(((((Eustigmatos_magna_A0850U41051:38.03896112,Vischeria_helvetica_A0851_AF045051:38.03896112):38.11959158,Pseudocharaciopsis_minuta_A0852U41052:76.1585527):38.0940841,((((((Nannochloropsis_oculata_A0856_AF045045:16.29300151,Nannochloropsis_oculata_A0854U38902:16.29300151):16.33089786,Nannochloropsis_oculata_A0855_AF045044:32.62389936):16.33106025,((Nannochloropsis_sp._CCAP21178_A0893_AF045035:19.5621748,Nannochloropsis_sp_strain_IOLR_A0895_AF067956:19.5621748):19.59832504,((Nannochloropsis_oceanica_A0881_AB183587:24.46157874,(((Nannochloropsis_oceanica_A0879_AB052276:7.327439864,Nannochloropsis_oceanica_A0878_AB052275:7.327439864):7.354028517,(Nannochloropsis_oceanica_A0877_AB052274:9.769270996,(Nannochloropsis_sp._CCAP21146_A0894_AF045034:4.889812658,Nannochloropsis_maritima_A0858_AY680703:4.889812658):4.879458338):4.912197385):4.879090128,Nannochloropsis_sp._UTEX2379_A0896_AY560119:19.56055851):4.901020233):4.912336578,(Nannochloropsis_oceanica_A0876_AB052273:19.55429663,(Nannochloropsis_oceanica_A0880_AB052277:9.773407399,Nannochloropsis_CCMP531_A0891U41094:9.773407399):9.780889233):9.819618689):9.786584524):9.794459768):16.33868987,((Nannochloropsis_CCMP505_A0892U41050:21.75914038,Nannochloropsis_limnetica_A0857_AF251496:21.75914038):21.74950214,((Nannochloropsis_granulata_A0872_AF045041:16.31870038,Nannochloropsis_granulata_A0873_AF045042:16.31870038):16.30391742,(((Nannochloropsis_granulata_A0875U41092:7.247168992,Nannochloropsis_granulata_A0871_AB183582:7.247168992):7.232285038,Nannochloropsis_granulata_A0874_AF045043:14.47945403):7.273960565,(Nannochloropsis_granulata_A0869_AB052272:10.84436621,Nannochloropsis_granulata_A0870U38903:10.84436621):10.90904838):10.86920321):10.88602472):21.78500696):16.32928068,(((Nannochloropsis_salina_A0887_AF045049:35.67808696,(Nannochloropsis_salina_A0883_AB183586:23.77242813,(Nannochloropsis_gaditana_A0865_AF045038:11.8951171,Nannochloropsis_salina_A0882_AB052278:11.8951171):11.87731103):11.90565883):11.9237361,(Nannochloropsis_salina_A0886_AF045048:23.78391761,Nannochloropsis_gaditana_A0862_AF133819:23.78391761):23.81790545):23.80260523,((((Nannochloropsis_salina_A0885_AF045047:22.66065645,(Nannochloropsis_gaditana_A0866_AF045039:11.31632415,Nannochloropsis_gaditana_A0867_AF045040:11.31632415):11.3443323):11.32999597,(Nannochloropsis_salina_A0889U41093:16.97879977,Nannochloropsis_gaditana_A0863_AF045036:16.97879977):17.01185264):17.02432577,((Nannochloropsis_gaditana_A0868_AF067957:30.57882315,((Nannochloropsis_salina_A0884_AF045046:10.18328521,Nannochloropsis_gaditana_A0859_AB052269:10.18328521):10.18927449,Nannochloropsis_salina_A0888_AF045050:20.3725597):10.20626345):10.2088194,(Nannochloropsis_gaditana_A0860_AB052270:20.37299091,Nannochloropsis_gaditana_A0861_AB052271:20.37299091):20.41465164):10.22733564):10.18387816,(Nannochloropsis_gaditana_A0864_AF045037:30.57593489,Nannochloropsis_salina_A0890M87328:30.57593489):30.62292145):10.20557195):10.21850187):16.24407889,Monodopsis_subterranea_A0853U41054:97.86700905):16.38562775):38.12445251,((((Aureoumbra_lagunensis_A1000U40258:30.43183645,Coccoid_pelagophyteCCMP1410_A1006U40926:30.43183645):30.51176989,((Chrysocystis_sp._MBIC11134_A1003_AB183669:20.28232305,Sarcinochrysis_marina_A1002U78033:20.28232305):20.30982148,Pulvinaria_sp._CCMP292_A1001U78032:40.59214453):20.35146181):30.47805735,(((Coccoid_pelagophyteCCMP1145_A1008U40928:22.83599958,Pelagomonas_calceolata_A1004U14389:22.83599958):22.87308795,(Coccoid_pelagophyteCCMP1395_A1007U40927:22.79576345,Pelagococcus_subviridis_A1005U14386:22.79576345):22.91332408):22.83869884,((Aureococcus_anophagefferens_A1012U40257:41.09336529,((Aureococcus_anophagefferens_A1009_AF117778:13.69521552,(Aureococcus_anophagefferens_A1011_AF117779:6.833075605,Aureococcus_anophagefferens_A1010_AF119119:6.833075605):6.862139914):13.6952624,Aureococcus_anophagefferens_A1015_AF117777:27.39047792):13.70288737):13.73689501,(Aureococcus_anophagefferens_A1014_AF118443:27.40279361,Aureococcus_anophagefferens_A1013_AF117776:27.40279361):27.42746669):13.71752607):22.87387732):30.45045658,((((((((((((Stschapovia_flagellaris_A1103_AB117921:19.54155918,(((Saccorhiza_polyschides_A1128L43059:3.252689563,Sporochnus_comosus_A1020L43061:3.252689563):3.246720832,Chorda_tomentosa_A1130L43056:6.499410395):6.54664988,(((Costaria_costata_A1134X53229:3.250561398,Costaria_costata_A1135M97958:3.250561398):3.267436955,((((Agarum_clathratum_A1132_AF123576:1.218801152,((Laminaria_japonica_A1138_AF123575:0.4337804086,Laminaria_angustata_A1140_AB022818:0.4337804086):0.3963907762,(Ecklonia_cava_A1142_AF123579:0.4315905728,Lessonia_sp_strain_Ilo_A1143_AF123581:0.4315905728):0.398580612):0.3886299672):1.213742768,Laminaria_japonica_A1139_AB022817:2.43254392):1.21714133,Costaria_costata_A1133_AB022819:3.649685249):1.243828469,((Kjellmaniella_crassifolia_A1136_AF123577:1.622524875,Postelsia_palmaeformis_A1137_AF123582:1.622524875):1.628360005,Egregia_menziesii_A1141_AF123580:3.250884879):1.642628839):1.624484635):3.241962169,Alaria_fistulosa_A1129_AF123578:9.759960522):3.286099752):6.495498906):6.55621451,((Haplospora_globosa_A1017_AB117925:8.679891059,Phaeosiphoniella_cryophila_A1019_AB117926:8.679891059):8.704913569,Tilopteris_mertensii_A1018_AB117927:17.38480463):8.712969063):8.705687801,(Pseudochorda_gracilis_A1127_AF123583:17.38771281,Pseudochorda_nagaii_A1126_AF123584:17.38771281):17.41574868):8.728897784,(Chorda_filum_A1131_AF123585:34.77434291,(((((((((Ectocarpus_siliculosus_A1093_AY307398:2.164269349,Ectocarpus_sp._UTEXLB1433_A1095_AY307399:2.164269349):2.166857552,Ectocarpus_siliculosus_A1094L43062:4.331126901):2.19709003,(Scytosiphon_lomentaria_A1105L43066:3.246308003,Scytosiphon_lomentaria_A1106D16558:3.246308003):3.281908928):2.154797832,Pleurocladia_lacustris_A1104_AY307397:8.683014763):2.194129024,((((Myrionema_strangulans_A1100_AY232605:2.168772942,Acrothrix_sp._EYL2003_A1097_AY232604:2.168772942):2.164584417,Leathesia_difformis_A1099_AY232603:4.333357359):2.180674742,Halothrix_ambigua_A1101_AY232607:6.514032101):2.184813669,((Papenfussiella_kuromo_A1102_AY232606:2.888432933,Tribonema_marinum_A1251_AF038005:2.888432933):2.897412969,Pylaiella_littoralis_A1096_AY032606:5.785845901):2.912999869):2.178298017):2.145429079,Ishige_sinicola_A1098_AY232600:13.02257287):2.195731957,(Asterocladon_interjectum_A1145_AB102865:7.591516017,Asteronema_rhodochortonoides_A1147_AB056156:7.591516017):7.626788806):2.180630011,(Desmarestia_ligulata_A1021L43060:8.684953583,Desmarestia_viridis_A1022_AJ295828:8.684953583):8.713981251):8.715634212,((((Fucus_distichus_A1114_AB011423:5.204801614,Fucus_distichus_A1115M97959:5.204801614):5.207644787,Fucus_gardneri_A1116X53987:10.4124464):5.225177469,Silvetia_babingtonii_A1117_AB011424:15.63762387):5.249146686,((Coccophora_langsdorfii_A1118_AB011426:6.941291712,Cystoseira_hakodatensis_A1121_AB011425:6.941291712):6.97555635,((Hizikia_fusiformis_A1120_AB011428:4.628325549,((Myagropsis_myagroides_A1119_AB011427:1.542508783,Sargassum_horneri_A1122_AB011429:1.542508783):1.549034513,(Sargassum_sp_A1123_AB011430:1.538946114,Sargassum_confusum_A1124_AB011431:1.538946114):1.552597182):1.536782253):4.629658228,Sargassum_macrocarpum_A1125_AB011432:9.257983777):4.658864284):6.969922495):5.22779849):8.659773867):8.758016362):8.702001183,(((((Distromium_decumbens_A1023_AB087116:8.685557693,Distromium_decumbens_A1025_AB087117:8.685557693):8.701577861,(((((((Lobophora_variegata_A1058_AF350232:9.250498336,((((Zonaria_crenata_A1087_AF350234:2.769456986,Zonaria_diesingiana_A1088_AF350233:2.769456986):2.79523629,(((Lobophora_variegata_A1062_AB096086:1.387474013,Lobophora_variegata_A1063_AB090391:1.387474013):1.388780385,Lobophora_variegata_A1059_AB095296:2.776254397):1.3839073,Lobophora_variegata_A1061_AB090390:4.160161697):1.404531578):1.399596986,(Lobophora_sp._PALNG021_A1065_AB087121:5.779868831,((((Zonaria_diesingiana_A1089_AB095301:1.159056038,Zonaria_diesingiana_A1090_AB095302:1.159056038):1.152177458,Zonaria_diesingiana_A1091_AB087134:2.311233497):1.15664253,Zonaria_diesingiana_A1092_AB087135:3.467876027):1.151762756,Newhousia_imbricata_A1039_AY423547:4.619638783):1.160230048):1.184421431):1.149692849,(Lobophora_sp._PALNGl020_A1064_AB087120:4.044120464,Lobophora_variegata_A1060_AB087119:4.044120464):4.069862646):1.136515226):1.157816471,Distromium_decumbens_A1024_AF350231:10.40831481):1.19997629,(((Dictyota_linearis_A1056_AB087108:7.22054567,((((Pachydictyon_coriaceum_A1028_AB090389:1.445103639,Dictyota_sp._YMGTB002_A1055_AB087109:1.445103639):1.453715184,(Pachydictyon_coriaceum_A1026_AF350224:1.445676194,Pachydictyon_coriaceum_A1027_AF350225:1.445676194):1.453142629):1.430463041,Pachydictyon_coriaceum_A1029_AB087111:4.329281864):1.467111621,((Dictyota_dichotoma_A1051_AF350227:1.443529476,Dictyota_dichotoma_A1053_AB087107:1.443529476):1.45047451,Dictyota_dichotoma_A1050_AF350226:2.894003986):2.902389498):1.424152186):1.473617112,(Dictyota_dichotoma_A1052_AB087106:4.337128819,Dictyota_sp._SZKIZ067_A1057_AB090387:4.337128819):4.357033963):1.459367652,((Dilophus_okamurae_A1033_AB090388:6.072384978,((Dictyota_intermedia_A1054_AF350228:2.018604871,Dilophus_okamurae_A1032_AF350230:2.018604871):2.02733638,Dilophus_okamurae_A1034_AB087110:4.045941251):2.026443728):2.02137039,Dilophus_okamurae_A1031_AF350229:8.093755369):2.059775065):1.454760663):1.149507183,((Stypopodium_sp._PALCH069_A1037_AB090395:4.235511663,Stypopodium_sp._SMNOK073_A1038_AB095300:4.235511663):4.247871364,Stypopodium_zonale_A1036_AB087133:8.483383028):4.274415252):1.169902219,(((Dictyopteris_prolifera_A1048_AB087114:4.154173299,Dictyopteris_prolifera_A1047_AB095294:4.154173299):4.19453299,((Dictyopteris_polypodioides_A1040_AB087113:2.774065429,Dictyopteris_punctata_A1049_AB095295:2.774065429):2.77703984,Dictyopteris_polypodioides_A1041_AB095293:5.551105269):2.79760102):2.780680383,(Spatoglossum_crassum_A1081_AF350222:5.536926274,Spatoglossum_crassum_A1082_AB087129:5.536926274):5.592460397):2.798313826):1.152699254,(((Spatoglossum_pacificum_A1085_AB087130:5.016589567,(Spatoglossum_pacificum_A1086_AB087131:2.501531096,Dictyopteris_undulata_A1044_AB087115:2.501531096):2.515058471):2.502252435,Spatoglossum_pacificum_A1083_AF350223:7.518842002):2.526404176,(Spatoglossum_pacificum_A1084_AB087132:5.034203446,Dictyopteris_divaricata_A1043_AB087112:5.034203446):5.011042732):5.035153574):1.171170566,((((Dictyopteris_acrosticoides_A1045_AF350236:3.223287976,Dictyopteris_prolifera_A1046_AF350237:3.223287976):3.242016763,Dictyopteris_divaricata_A1042_AF350238:6.465304739):3.285087593,(((((Padinacrassa_A1066_AF350240:1.618814119,Padinatenuis_A1069_AF350239:1.618814119):1.617186409,Padina_sp._INDGR032_A1076_AB087128:3.236000528):1.611101367,Padina_sp._PALML024_A1075_AB087127:4.847101896):1.648722284,(((Padina_australis_A1074_AB090393:1.623823546,Padina_australis_A1072_AB087124:1.623823546):1.602952477,Padina_australis_A1073_AB087123:3.226776023):1.646837904,(((Padinajaponica_A1078_AB090394:1.212840213,Padinajaponica_A1080_AB095298:1.212840213):1.2121739,Padinajaponica_A1079_AB087126:2.425014113):1.208962797,Padina_sp._GUMOR034_A1077_AB095299:3.63397691):1.239637016):1.622210253):1.623417388,((Padinacrassa_A1067_AB087125:2.688384644,Padinacrassa_A1068_AB095297:2.688384644):2.720943794,(Padina_arborescens_A1070_AB087122:2.693994708,Padina_arborescens_A1071_AB090392:2.693994708):2.71533373):2.709913129):1.631150765):3.198408444,Lobospira_bicuspidata_A1030_AF350235:12.94880078):3.302769541):1.135565236):8.672596666,Homoeostrichus_flabellatus_A1035_AB087118:26.05973222):8.754321394,((((((Heribaudiella_fluviatilis_A1110_AY307393:4.966377999,Heribaudiella_fluviatilis_A1107_AY307392:4.966377999):4.974572068,(Bodanella_lauterborni_A1112_AY307396:4.94837053,Bodanella_lauterborni_A1113_AY307395:4.94837053):4.992579538):4.953698892,Heribaudiella_fluviatilis_A1109_AY307390:14.89464896):4.977402957,Heribaudiella_fluviatilis_A1108_AY307391:19.87205192):4.958657395,Heribaudiella_fluviatilis_A1111_AY307394:24.83070931):4.98807945,Phaeostrophion_irregulare_A1146_AB117949:29.81878876):4.995264853):8.657204523,Sphacelaria_sp._UTEXLB800_A1144_AY307401:43.47125814):8.763102321):8.6439427,Porterinema_fluviatile_A1016_AY307400:60.87830316):8.703805198,Schizocladia_ischiensis_A1308_AB085614:69.58210836):8.702044933,Phaeothamnion_confervicola_A1267_AF044846:78.28415329):8.782288987,((((((Bumilleriopsis_filiformis_A1237_AF083398:12.43344468,Bumilleriopsis_pyrenoidosa_A1232_AJ579332:12.43344468):12.42101121,((Tribonema_aequale_A1250M55286:8.277228289,Tribonema_intermixum_A1252_AF083397:8.277228289):8.282880336,Botrydium_stoloniferum_A1234U41648:16.56010863):8.294347263):12.42820868,Heterothrix_debilis_A1253U43277:37.28266457):12.41897623,Bumilleriopsis_peterseniana_A1238_AJ579331:49.70164079):12.48189659,(((((((Botrydiopsis_alpina_A1241_AJ579343:7.768421421,Pleurochloris_meiringensis_A1235_AF109728:7.768421421):7.755050341,Botrydiopsis_callosa_A1244_AJ579340:15.52347176):7.774423682,Botryochloris_sp._SiM2003_A1245_AJ579341:23.29789544):7.776333672,(Botrydiopsis_intercedens_A1240U41647:15.54071175,Chlorellidium_pyrenoidosum_A1247_AJ579338:15.54071175):15.53351737):7.756572463,Sphaerosorus_composita_A1246_AJ579333:38.83080158):7.80406272,((((Chlorellidium_sp._SAG8111_A1249_AJ580950:9.300006559,Chlorellidium_tetrabotrys_A1248_AJ580949:9.300006559):9.351660716,(((Heterococcus_pleurococcoides_A1256_AJ579335:4.656608196,Heterococcus_sp._SiM2003_A1257_AJ579336:4.656608196):4.645339855,Heterococcus_protonematoides_A1255_AJ579334:9.301948051):4.660362569,Heterococcus_caespitosus_A1254_AF083399:13.96231062):4.689356655):9.291973219,Botrydiopsis_constricta_A1243_AJ579339:27.94364049):9.33173102,Pseudopleurochloris_antarctica_A1236_AF109729:37.27537151):9.359492786):7.730216011,Mischococcus_sphaerocephalus_A1239_AF083400:54.36508031):7.818457069):12.38147348,Vaucheria_bursata_A1233U41646:74.56501086):12.50143142):8.623016275,Botrydiopsis_pyrenoidosa_A1242_AJ579337:95.68945855):8.795288307,(((((((Chattonella_marina_A1170_AY788925:48.17870578,(((Chattonella_marina_A1168_AY788927:13.37427513,Chattonella_antiqua_A1160_AY788922:13.37427513):13.36719149,Chattonella_marina_A1169_AY788928:26.74146663):13.44168488,((Chattonella_sp._CCMP218_A1165_AY788930:24.08534032,(Chattonella_marina_A1167_AY788926:16.04785516,(Chattonella_ovata_A1162_AY788923:8.015199105,Chattonella_antiqua_A1158_AY788921:8.015199105):8.032656052):8.037485164):8.045558435,(Chattonella_ovata_A1161_AY788924:16.05151814,Haramonas_dimorpha_A1157_AY788929:16.05151814):16.07938062):8.052252749):7.995554279):8.021284674,Chattonella_antiqua_A1159_AY788920:56.19999046):8.08516048,(((((Chattonella_subsalsa_A1174_AY788938:6.404059167,Chattonella_subsalsa_A1176_AY788942:6.404059167):6.436781281,(Chattonella_subsalsa_A1172_AY788941:6.408640053,Chattonella_subsalsa_A1177_AY788943:6.408640053):6.432200395):6.438712125,(Chattonella_subsalsa_A1175_AY788939:9.626605027,Chattonella_subsalsa_A1173_AY788944:9.626605027):9.652947546):6.396086218,Chattonella_subsalsa_A1178U41649:25.67563879):6.433958686,Chattonella_subsalsa_A1171_AY788940:32.10959748):32.17555346):8.039801407,(((Heterosigma_akashiwo_A1181_AY788933:21.09871647,Heterosigma_akashiwo_A1185_AB183667:21.09871647):21.04814199,Heterosigma_akashiwo_A1182_AB001287:42.14685846):21.12761819,(((Heterosigma_akashiwo_A1187_AY788934:22.58263062,Heterosigma_akashiwo_A1180_AY788935:22.58263062):22.6037082,((((Heterosigma_akashiwo_A1186_AY788932:9.025760578,Heterosigma_carterae_A1179L42529:9.025760578):9.033870496,Heterosigma_akashiwo_A1189U41650:18.05963107):9.037618567,Heterosigma_akashiwo_A1184_AB183666:27.09724964):9.028820062,Heterosigma_akashiwo_A1188_AY788936:36.1260697):9.060269116):9.019183279,Heterosigma_akashiwo_A1183_AB183609:54.2055221):9.068954553):9.050475692):7.970682447,Vacuolaria_virescens_A1155U41651:80.29563479):8.038128126,Chattonella_cf_verruculosa_A1166_AY788946:88.33376292):8.043849176,Fibrocapsa_japonica_A1156_AY788931:96.37761209):8.107134765):8.693863864,(((Polypodo_chrysisteissieri_A1150_AB058925:28.26319681,Polypodo_chrysisteissieri_A1148_AF438322:28.26319681):28.284981,Polypodo_chrysisteissieri_A1149_AB183614:56.54817782):28.32592011,((Pinguiochrysis_pyriformis_A1151_AF438326:28.29339222,Pinguiochrysis_pyriformis_A1152_AB058926:28.29339222):28.25674905,((Coccoid_stramenopileCCMP1144_A1303U40929:18.831491,Pinguiococcus_pyrenoidosus_A1154_AF438324:18.831491):18.87380238,Glossomastix_chrysoplasta_A1153_AF438325:37.70529338):18.84484789):28.32395666):28.30451279):8.693509549):30.50496904):38.07432004,(((((((((((((((((((((((Fragilaria_sp._HGC20072_A0579_EU090025:15.80272241,Fragilaria_sp._HGC20072_A0578_EU090024:15.80272241):15.84513298,(Fragilaria_striatula_A0562_AY485474:25.30057981,((Fragilaria_sp._HGC20072_A0576_EU090022:12.65322479,(Fragilaria_cf_islandica_A0566_AJ535190:6.298571299,Fragilaria_sp._HGC20072_A0577_EU090023:6.298571299):6.354653492):6.312884602,Fragilaria_sp._HGC20072_A0581_EU090027:18.96610939):6.334470416):6.347275587):6.309033697,Fragilaria_sp._HGC20072_A0580_EU090026:37.95688909):6.364266348,(Fragilaria_striatula_A0563X77704:22.1177585,(Fragilaria_striatula_A0571_EU090017:11.05259042,Fragilaria_striatula_A0572_EU090018:11.05259042):11.06516807):22.20339694):6.32253565,(Fragilaria_sp._HGC20072_A0582_EU090028:25.29242326,Fragilaria_striatula_A0570_EU090016:25.29242326):25.35126783):6.291298647,Fragilaria_barbararum_A0009_AJ971376:56.93498974):6.378363727,((Synedra_hyperborea_A0586_AY485464:23.70809495,Fragilaria_sp._HGC20071_A0573_EU090019:23.70809495):23.76783797,((Fragilaria_sp._HGC20071_A0575_EU090021:15.80308772,Fragilaria_sp._HGC20071_A0574_EU090020:15.80308772):15.85137818,(Fragilaria_spp437_A0565_AJ535141:15.79697161,Fragilaria_cf_striatula_A0010_AJ971377:15.79697161):15.85749428):15.82146703):15.83742054):6.333024263,((Synedropsis_sp._CCMP2745_A0553_EF106791:23.17219335,Synedropsis_sp._CCMP2747_A0554_EF106786:23.17219335):23.22156959,Synedropsis_cf_recta_A0552_AY485491:46.39376294):23.25261479):6.337846348,(((((((((((((Operculina_ammonoides_diatom_endosymbiont_A0632_AM233846:3.780772027,Operculinella_cumingii_diatom_endosymbiont1_A0636_AM233849:3.780772027):3.814066709,(Nummulites_venosus_diatom_endosymbiont3_A0639_AM233852:3.781361672,Nummulites_venosus_diatom_endosymbiont2_A0638_AM233851:3.781361672):3.813477064):3.777034618,Operculina_elegans_diatom_endosymbiont_A0634_AM233847:11.37187335):3.804224054,Operculina_elegans_diatom_endosymbiont_A0635_AM233848:15.17609741):3.795406697,Operculinella_cumingii_diatom_endosymbiont2_A0637_AM233850:18.97150411):3.783384649,Nummulites_venosus_diatom_endosymbiont1_A0641_AM233854:22.75488875):3.79766618,Nummulites_venosus_diatom_endosymbiont1_A0640_AM233853:26.55255493):3.836339591,((Cycloclypeus_carpenteri_diatom_endosymbiont1_A0645_AM233856:10.10461704,Operculina_complanata_diatom_endosymbiont_A0643_AM233867:10.10461704):10.12023273,Operculina_complanata_diatom_endosymbiont_A0642_AM233855:20.22484977):10.16404475):3.80110557,((Planoperculina_heterosteginoides_diatom_endosymbiont_A0653_AM233865:24.38359786,((Planostegina_operculinoides_diatom_endosymbiont2_A0651_AM233861:14.6254885,((Cycloclypeus_carpenteri_diatom_endosymbiont1_A0646_AM233860:4.861070918,Cycloclypeus_carpenteri_diatom_endosymbiont2_A0648_AM233857:4.861070918):4.899522564,(Cycloclypeus_carpenteri_diatom_endosymbiont3_A0649_AM233858:4.870046336,Cycloclypeus_carpenteri_diatom_endosymbiont4_A0658_AM233859:4.870046336):4.890547147):4.86489502):4.882742967,Operculina_complanata_diatom_endosymbiont_A0644_AM233866:19.50823147):4.87536639):4.924716435,((Planostegina_operculinoides_diatom_endosymbiont1_A0650_AM233863:7.299475731,Planostegina_operculinoides_diatom_endosymbiont3_A0659_AM233862:7.299475731):7.312513115,Planoperculina_heterosteginoides_diatom_endosymbiont_A0652_AM233864:14.61198885):14.69632545):4.8816858):3.798873705,((((Thalassionema_nitzschioides_A0541X77702:4.73509496,Thalassionema_sp._CCMP1100_A0543_EF192983:4.73509496):4.731530229,Synedra_fragilaroides_A0587_EF193001:9.466625189):9.524518733,((Operculina_ammonoides_diatom_endosymbiont_A0630_AM233844:6.30968764,Operculina_sp_diatom_endosymbiont_A0633_AM233845:6.30968764):6.327591542,Operculina_ammonoides_diatom_endosymbiont_A0631_AM233843:12.63727918):6.353864741):9.494509708,(Cycloclypeus_carpenteri_diatom_endosymbiont1_A0647_AM233842:14.21146059,Thalassionema_spp474_A0542_AJ535140:14.21146059):14.27419304):9.50322017):9.491729503,(((Heterostegina_depressa_diatom_endosymbiont_A0654_AM233868:11.85096975,Heterostegina_depressa_diatom_endosymbiont_A0655_AM233869:11.85096975):11.87007762,Heterostegina_depressa_diatom_endosymbiont_A0657_AM233870:23.72104736):11.86096072,Heterostegina_depressa_diatom_endosymbiont_A0656_AM233871:35.58200808):11.89859522):9.478790291,(Tabularia_tabulata_A0560_AY485475:28.47982515,Tabularia_tabulata_A0561_AY216907:28.47982515):28.47956844):9.52051109,((Fragilariforma_virescens_A0559_AJ535137:22.12600054,Synedra_acus_A0583_DQ250712:22.12600054):22.18952422,((((Fragilaria_ulna_A0567_AJ866993:8.839183139,Synedra_ulna_A0584_AJ535139:8.839183139):8.874544231,Fragilaria_ulnavaracus_A0568_AJ866994:17.71372737):8.846253709,Synedra_spp517_A0585_AJ535138:26.55998108):8.875846653,Fragilaria_crotonensis_A0564_AF525662:35.43582773):8.87969703):22.16437992):9.504319391):6.261088219,Cyclophora_tenuis_A0537_AJ535142:82.2453123):6.395292401,(Nitzschia_filiformis_A0069_AJ866999:66.42596007,((Achnanthes_brevipes_A0029_AY485476:22.12536968,Achnanthidium_cf_longipes_A0033_AY485500:22.12536968):22.20096259,((((Nitzschia_pusilla_A0063_AJ867015:8.844884017,Nitzschia_pusilla_A0064_AJ867016:8.844884017):8.867652844,Nitzschia_cf_pusilla_A0058_AJ867017:17.71253686):8.869522958,(((Nitzschia_paleacea_A0066_AJ866996:6.628260482,Nitzschia_paleaformis_A0067_AJ866997:6.628260482):6.646999563,Nitzschia_paleaformis_A0068_AJ866998:13.27526004):6.645233664,Nitzschia_acicularis_A0070_AJ867000:19.92049371):6.661566109):8.855611725,(Amphora_sp._AuricN7_A0175_AY485451:17.69519554,Nitzschia_thermalis_A0062_AY485458:17.69519554):17.74247601):8.888660729):22.09962779):22.21464463):6.343581383,((((Achnanthes_bongranii_A0028_AJ535150:18.97594885,Achnanthes_spp346_A0027_AJ535151:18.97594885):18.99308454,(Nitzschia_sp._MBIC11128_A0065_AB183668:32.51996081,(((((Nitzschia_like_diatom_A0606_AY821973uncultured:5.40153325,Nitzschia_linearis_A0073_AJ867013:5.40153325):5.448044316,(Nitzschia_linearis_A0071_AJ867011:5.410721358,Nitzschia_linearis_A0072_AJ867012:5.410721358):5.438856208):5.409204183,Nitzschia_sp._AnM0026_A0055_EU090031:16.25878175):5.421995223,Psammodictyon_panduriforme_A0035_AY485485:21.68077697):5.433224498,Nitzschia_longissima_A0082_AY881968:27.11400147):5.405959342):5.449072584):19.0177539,(Nitzschia_sigma_A0080_AJ867279:49.82373886,(((((Eunotia_bilunaris_A0183_AJ866995:14.2244958,(Eunotia_formica_var_smatrana_A0179_AB085830:7.103477967,Eunotia_pectinalis_A0178_AB085832:7.103477967):7.12101783):7.132906767,(Eunotia_like_diatom_A0607_AY821975uncultured:10.65651263,Eunotia_monodon_var_asiatica_A0180_AB085831:10.65651263):10.70088993):7.128849803,(Eunotia_cf_pectinalisfminor_A0182_AJ535146:14.21519333,Eunotia_sp._M16_A0181_AJ535145:14.21519333):14.27105904):7.098383794,Nitzschia_apiculata_A0056M87334:35.58463616):7.112711002,Striatella_unipunctata_A0600_AF525666:42.69734716):7.126391695):7.163048432):18.99670407,(Nitzschia_vitrea_A0081_AJ867280:60.74029624,(Undatella_spp446_A0177_AJ535163:45.54287212,(((Nitzschia_closterium_A0061_AY485455:7.544500335,Cylindrotheca_fusiformis_A0036_AY485457:7.544500335):7.642434515,Cylindrotheca_closterium_A0037_AY485471:15.18693485):15.18651169,(((Cylindrotheca_closterium_A0045_DQ082742:15.16794637,(((Cylindrotheca_closterium_A0046_DQ178392:3.795392184,Cylindrotheca_closterium_A0044_DQ082741:3.795392184):3.789068429,(uncultured_diatom_A0611_AY180016:3.781441353,Cylindrotheca_closterium_A0049M87326:3.781441353):3.80301926):3.78264567,Cylindrotheca_closterium_A0039_AY866418:11.36710628):3.800840088):3.814764171,(Cylindrotheca_closterium_A0047_DQ178393:9.472999395,Cylindrotheca_closterium_A0038_AY866417:9.472999395):9.509711145):3.809270623,(Cylindrotheca_closterium_A0040_DQ019446:15.16330987,(Cylindrotheca_closterium_A0041_DQ082738:7.57177949,((Cylindrotheca_closterium_A0043_DQ082740:2.517647337,Cylindrotheca_closterium_A0042_DQ082739:2.517647337):2.526294554,Cylindrotheca_closterium_A0048_DQ178394:5.04394189):2.5278376):7.591530376):7.628671297):7.581465372):15.16942559):15.19742411):15.24319513):19.00069471):6.328948198,((Nitzschia_dissipata_A0074_AJ867018:67.47371551,((((Diatomatenue_A0544_AJ535143:13.50040858,uncultured_marinediatom_A0604_DQ916403:13.50040858):13.49662749,(Asterionella_formosa_A0550_AF525657:13.4856612,Diatomahyemalis_A0545_AB085829:13.4856612):13.51137486):13.52237651,((((Nanofrustulum_shiloi_A0556_EF491891:13.48469778,((Nanofrustulum_shiloi_A0557_AY485505:3.36439558,Nanofrustulum_shiloi_A0555_AF525658:3.36439558):3.376674061,Fragilaria_pinnata_A0569_EF192988:6.741069641):6.743628138):6.755337381,((uncultured_stramenopile_A1301_AF372749:6.725035766,uncultured_stramenopile_A1302_AF372748:6.725035766):6.770494874,uncultured_stramenopile_A1291_AY179997:13.49553064):6.74450452):6.779512007,((Staurosiraconstruens_A0558_AF525659:8.961993663,Synedra_berolinensis_A0588_EF491890:8.961993663):9.016154562,uncultured_stramenopile_A1292_AY179998:17.97814823):9.041398942):6.74186799,((Licmophora_communis_A0592_AY633756:11.23166721,Licmophora_flabellata_A0591_AY633757:11.23166721):11.25709821,Convolutaconvoluta_diatom_endosymbiont_A0617_AY345013:22.48876541):11.27264974):6.757997423):13.50687433,(((Licmophora_juergensii_A0589_AF525661:13.47862286,Licmophora_juergensii_A0590_AY633759:13.47862286):13.51723232,uncultured_diatom_A0608_AY180007:26.99585518):13.51816255,((Licmophora_abbreviata_A0593_AY633760:13.48397577,Licmophora_abbreviata_A0594_AY633761:13.48397577):13.49578251,Licmophora_gracilis_A0595_AY633758:26.97975828):13.53425945):13.51226918):13.4474286):13.58016485,(((Nitzschia_communis_A0059_AJ867014:20.23423449,Nitzschia_communis_A0060_AJ867278:20.23423449):20.25822346,Peridinium_foliaceumendo_symbiont_A0616Y10567:40.49245795):20.28905448,(((((((Nitzschia_palea_A0089_AJ867007:6.488283624,Nitzschia_palea_A0091_AJ867009:6.488283624):6.512820193,Nitzschia_palea_A0092_AJ867010:13.00110382):6.539941295,(Nitzschia_palea_A0087_AJ867005:12.9916101,(Nitzschia_palea_A0084_AJ867002:6.495232832,Nitzschia_palea_A0086_AJ867004:6.495232832):6.496377272):6.549435008):6.50770734,((Nitzschia_palea_A0088_AJ867006:8.657735099,Nitzschia_palea_A0083_AJ867001:8.657735099):8.68108422,Nitzschia_palea_A0090_AJ867008:17.33881932):8.709933133):8.650444911,Nitzschia_palea_A0085_AJ867003:34.69919736):8.68314765,Peridinium_balticumendo_symbiont_A0615Y10566:43.38234501):8.667222844,Nitzschia_palea_A0093_DQ288289:52.04956786):8.731944578):20.27236793):20.25925392):6.333908265,(((Rhabdonema_sp._LM2002_A0540_AF525660:83.42841413,((Nitzschia_fonticola_A0078_AJ867022:68.2610147,(((((Pseudonitzschia_multiseries_A0097_AY221947:15.92217558,Pseudonitzschia_multiseries_A0099_AM235381:15.92217558):15.94245036,(Pseudonitzschia_multiseries_A0101U18241:21.22866017,(Pseudonitzschia_multiseries_A0098_AM235380:10.60115014,Pseudonitzschia_multiseries_A0100_AM235382:10.60115014):10.62751003):10.63596578):10.5982293,Pseudonitzschia_sp._CCMP1309_A0096_AY485490:42.46285524):10.65832285,(uncultured_marinediatom_485EKD54_A0603_AF290085:45.50788214,((Pseudonitzschia_pungens_A0094U18240:18.93957991,Pseudonitzschia_australis_A0095_AM235384:18.93957991):19.00453806,((((Thalassiosira_antarctica_A0502_AF374482:7.556869735,Fragilariopsis_cylindrus_A0050_AY485467:7.556869735):7.618014113,(Stauroneis_constricta_A0105_AY485521:10.09951497,(Fragilariopsis_cylindrus_A0051_AY672802:5.048206155,Fragilariopsis_cylindrus_A0052_EF140624:5.048206155):5.051308814):5.075368878):7.563163218,Fragilariopsis_sublineata_A0054_AF525665:22.73804707):7.590036081,Fragilariopsis_curta_A0053_EF140623:30.32808315):7.616034822):7.563764168):7.613295963):7.55151317,uncultured_stramenopile_A1288_AY179994:60.67269127):7.58832343):7.640194933,(((Nitzschia_cf_supralitorea_A0076_AJ867020:25.28423783,Nitzschia_inconspicua_A0077_AJ867021:25.28423783):25.30129185,(((Bacillariophyta_sp._MBIC10811_A0623_AB183643:12.62438211,Bacillariophyta_sp._MBIC10099_A0622_AB183591:12.62438211):12.66019212,Bacillariophyta_sp._MBIC10816_A0624_AB183646:25.28457424):12.6481406,Nitzschia_amphibia_A0079_AJ867277:37.93271484):12.65281484):12.61471395,Nitzschia_supralitorea_A0075_AJ867019:63.20024362):12.70096601):7.527204503):7.654781619,(((((Phaeodactylum_tricornutum_A0108_EF140622:22.05761266,Phaeodactylum_tricornutum_A0107_AY485459:22.05761266):22.08519564,(Phaeodactylum_tricornutum_A0106_AJ269501:22.03937795,Phaeodactylum_tricornutum_A0109_DQ402479:22.03937795):22.10343034):22.09092769,(((((((Entomoneis_sp._CCMP1693_A0004_EF585586:8.256143894,Surirella_fastuosavarcuneata_A0020_AJ535161:8.256143894):8.287330197,Entomoneis_cf_alata_A0017_AJ535160:16.54347409):8.279432634,(((Amphiprora_alata_A0104_AY485497:6.203510379,Entomoneis_cf_alata_A0016_AY534908:6.203510379):6.202572156,Amphiprora_paludosa_A0103_AY485468:12.40608253):6.210261882,uncultured_stramenopile_A1297_AY180025:18.61634442):6.206562307):8.2925027,((Surirella_angusta_A0021_AJ867028:11.01418912,Surirella_brebissoni_A0022_AJ867029:11.01418912):11.02462902,Cymatopleura_elliptica_A0024_AJ867030:22.03881814):11.07659128):8.248790137,uncultured_stramenopile_A1295_AY180009:41.36419956):8.317261885,(((((uncultured_stramenopile_A1285_AY179991:8.263971485,uncultured_stramenopile_A1286_AY179992:8.263971485):8.276849244,Achnanthes_sp._CCAP10011_A0030_AY485496:16.54082073):8.27740364,Amphora_cf_capitellata_A0173_AJ535158:24.81822437):8.30118769,((Bacillariophyta_sp._MBIC10806_A0620_AB183641:19.85254991,((Bacillariophyta_sp._MBIC10809_A0621_AB183642:6.619756021,Bacillariophyta_sp._MBIC10819_A0627_AB183647:6.619756021):6.606520964,Bacillariophyta_sp._MBIC10815_A0626_AB183645:13.22627698):6.626272929):6.630319509,(Amphora_sp._MBIC10098_A0176_AB183590:13.23116087,Amphora_montana_A0171_AJ243061:13.23116087):13.25170856):6.636542637):8.254196984,(Bacillariophyta_sp._MBIC10100_A0618_AB183592:20.68372051,Bacillariophyta_sp._MBIC10814_A0625_AB183644:20.68372051):20.68988853):8.307852403):8.274721614,(((((Navicula_sp._Nav30_A0150_AY485502:12.85563428,Navicula_sp._NavI_A0149_AY485460:12.85563428):12.88122881,Navicula_cryptocephalavarveneta_A0144_AJ297724:25.73686308):12.89095844,(((((Pseudogomphonema_sp._LM2002_A0136_AF525663:6.418075242,Pseudogomphonema_spp382_A0137_AJ535152:6.418075242):6.452366027,(Navicula_like_diatom_A0605_AY821971uncultured:6.425424147,Navicula_sp._GGM2004a_A0151_AY485513:6.425424147):6.445017121):6.416049897,Navicula_phyllepta_A0157_AY485456:19.28649117):6.474473174,(((Navicula_sp._ArM0002_A0140_EU090029:6.430980553,Navicula_sp._ArM0003_A0141_EU090030:6.430980553):6.440801268,(Navicula_lanceolata_A0147_AY485484:6.412741431,Navicula_ramosissima_A0148_AY485512:6.412741431):6.45904039):6.435349046,((uncultured_stramenopile_A1289_AY179995:6.425005304,uncultured_stramenopile_A1290_AY179996:6.425005304):6.429860772,uncultured_diatom_A0609_AY180014:12.85486608):6.452264792):6.453833473):6.405890955,Navicula_sclesviscensis_A0146_AY485483:32.16685529):6.460966223):6.429574943,(Navicula_glaciei_A0154_EF106789:22.51567925,Navicula_glaciei_A0155_EF106788:22.51567925):22.54171721):6.411639345,Navicula_diserta_A0145_AJ535159:51.46903581):6.487147254):8.277552929):8.294074113,((((((Bacillariophyta_sp._MBIC10102_A0619_AB183593:11.47418122,Navicula_sp._CCMP2746_A0156_EF106790:11.47418122):11.51252467,(Navicula_pelliculosa_A0143_AY485454:11.45517233,Navicula_saprophila_A0152_AJ867025:11.45517233):11.53153357):11.51051272,(Eolimna_subminuscula_A0133_AJ867026:17.20200161,Eolimna_subminuscula_A0134_AJ243064:17.20200161):17.295217):17.24253646,((((Pleurosigma_planktonicum_A0112_AY485514:10.31865492,Pleurosigma_sp._GGM2004_A0113_AY485515:10.31865492):10.36116835,Pleurosigma_intermedium_A0110_AY485489:20.67982327):10.33931545,Pleurosigma_sp._LM2002_A0111_AF525664:31.01913872):10.37598446,(Gyrosigma_limosum_A0114_AY485516:20.68234283,uncultured_diatom_A0610_AY180015:20.68234283):20.71278035):10.34463189):10.3596687,((Diadesmis_gallica_A0102_AJ867023:49.62890281,(((Achnanthes_minutissima_A0031_AJ866992:14.46864426,Pauliella_toeniata_A0025_AY485528:14.46864426):14.50051013,((Cocconeis_cf_molesta_A0026_AJ535148:9.630816876,uncultured_diatom_A0614_AY821977:9.630816876):9.667849146,Planothidium_lanceolatum_A0032_AJ535189:19.29866602):9.670488368):14.4970619,((Encyonema_triangulatum_A0015_AJ535157:31.01467682,(((Lyrella_atlantica_A0019_AJ544659:8.273056408,Lyrella_sp._LM2002_A0018_AJ535149:8.273056408):8.274748333,(Campylodiscus_ralfsii_A0023_AJ535162:8.256788156,uncultured_stramenopile_A1294_AY180000:8.256788156):8.291016585):8.286519423,((Cymbella_cymbiformis_A0014_AJ535156:12.41422375,(Gomphonema_parvulum_A0011_AJ243062:6.190774711,Gomphonema_pseudaugur_A0012_AB085833:6.190774711):6.223449037):6.194423063,Anomoeoneissphaerophora_A0013_AJ535153:18.60864681):6.225677354):6.180352656):6.209471665,Dickiei_aulvacea_A0139_AY485462:37.22414849):6.242067809):6.162686519):6.254591228,(((Haslea_ostrearia_A0129_AY485523:13.94504705,Haslea_pseudostrearia_A0132_AY485524:13.94504705):13.97485047,Haslea_crucigera_A0130_AY485482:27.91989753):13.94768508,Haslea_nipkowii_A0131_AY485488:41.86758261):14.01591143):6.215929725):6.223861563,((((((((Pinnularia_termitina_A0123_AM743107:7.583060425,Pinnularia_cf_interrupta_A0116_AJ544658:7.583060425):7.56017185,Pinnularia_sp._LM2002_A0115_AJ535154:15.14323227):7.624752233,(((((((Pinnularia_brauniana_A0124_AM743097:2.840354506,Pinnularia_mayeri_A0126_AM743102:2.840354506):2.845651541,((Pinnularia_viridiformis_A0128_AM743108:1.892629563,Pinnularia_gentilis_A0125_AM743099:1.892629563):1.889250024,Pinnularia_subcapitata_A0127_AM743106:3.781879587):1.90412646):2.834822442,Pinnularia_gibba_A0122_AM743100:8.52082849):2.840498774,Pinnularia_biceps_A0118_AM743096:11.36132726):2.84494588,Pinnularia_acrosphaeria_A0119_AM743094:14.20627314):2.84228065,Pinnularia_mesolepta_A0120_AM743101:17.04855379):2.838987765,Pinnularia_nodosa_A0121_AM743103:19.88754156):2.88044295):7.57792392,((uncultured_eukaryote_A1318_AY082977:10.09215049,uncultured_eukaryote_A1320_AY082992:10.09215049):10.13417055,Pinnularia_rupestris_A0117_AJ867027:20.22632104):10.11958739):7.584029992,(Navicula_atomusvarpermitis_A0153_AJ867024:18.97117101,Navicula_pelliculosa_A0142_AJ544657:18.97117101):18.95876741):7.563552316,Amphora_coffeaeformis_A0174_AY485498:45.49349074):7.637338371,(((((((Sellaphora_laevissima_A0158_AJ544655:6.633537096,Sellaphora_laevissima_A0159_AJ544656:6.633537096):6.623564604,Sellaphora_pupula_A0161_AJ544654:13.2571017):6.657575639,((((Sellaphora_pupula_A0167_AJ544649:6.624481596,(Sellaphora_pupula_A0168_AJ544647:3.304193978,Sellaphora_pupula_A0160_AJ544650:3.304193978):3.320287618):3.307944362,Sellaphora_pupula_A0165_AJ544648:9.932425958):3.342953921,(Sellaphora_pupula_A0164_AJ544645:6.603345552,Sellaphora_pupula_A0166_AJ544646:6.603345552):6.672034326):3.313561786,(Sellaphora_pupula_A0169_AJ544651:8.29051938,Sellaphora_pupulafcapitata_A0170_AJ535155:8.29051938):8.298422285):3.325735674):6.612473307,Sellaphora_pupula_A0162_AJ544652:26.52715065):6.638588301,Sellaphora_pupula_A0163_AJ544653:33.16573895):6.631238685,Eolimna_minima_A0135_AJ243063:39.79697763):6.670569475,(Rossia_sp._CH2_A0138_AJ535144:23.22377452,uncultured_stramenopile_A1287_AY179993:23.22377452):23.24377259):6.663282):7.522207538,Amphora_cf_proteus_A0172_AJ535147:60.65303665):7.670248684):6.204524773):8.193954352,Nitzschia_frustulum_A0057_AJ535164:82.72176445):8.3614313):8.271221578,(Bacillaria_paxillifer_A0034M87325:74.47709679,((Asterionella_glacialis_A0549_AY485447:24.82162798,Hyalosira_delicatula_A0602_AF525654:24.82162798):24.83518324,(((Grammatophora_marina_A0599_AY216906:12.38593841,Grammatophora_oceanica_A0598_AY485466:12.38593841):12.43504706,Grammatophora_gibberula_A0596_AF525656:24.82098546):12.42394971,Grammatophora_oceanica_A0597_AF525655:37.24493517):12.41187605):24.82028556):24.87732055):8.29262521):8.267125715,(((((Asterionellopsis_glacialis_A0547_AY216904:19.291658,Asterionellopsis_glacilia_A0546X77701:19.291658):19.30158491,Asterionella_japonica_A0551_AY485463:38.59324291):19.33639709,Asterionellopsis_kariana_A0548Y10568:57.92964):19.29391887,Talaroneis_posidoniae_A0202_AY216905:77.22355887):19.38531778,(Delphineis_sp._CCMP1095_A0539_AY485465:48.23486411,Rhaphoneis_belgicae_A0538_X77703:48.23486411):48.37401253):19.30529161):8.29107966,((((Eucampia_antarcia_A0204_AY485503:24.78987918,Eucampia_antarctica_A0203X85389:24.78987918):24.85549215,Eucampia_zoodiacus_A0006_EF585584:49.64537132):24.86983892,(((Urosolenia_sp_A0185Y988C:18.59224663,Urosolenia_sp_A0186Y988D:18.59224663):18.64632606,Urosolenia_sp_A0184Y988A:37.23857269):18.63934917,(((((((Chaetoceros_muelleri_A0213_AY625896:6.964479679,Chaetoceros_calcitrans_A0235_DQ887756:6.964479679):6.990981513,Chaetoceros_muelleri_A0212_AY485453:13.95546119):6.977261011,Chaetoceros_gracilis_A0225_AY625895:20.9327222):7.001901814,(((Chaetoceros_curvisetus_A0227_AY229895:6.964078957,Chaetoceros_gracilis_A0224_AY229897:6.964078957):6.989646738,Chaetoceros_debilis_A0222_AY229896:13.95372569):7.001475774,(Chaetoceros_sp._NMBguh0031_A0230_DQ886406:10.44149558,Chaetoceros_sp._NMBguh0032_A0231_DQ886407:10.44149558):10.51370589):6.97942255):6.996474625,(((Chaetoceros_sp._NIOZ_A0233_EF192996:17.443115,((Chaetoceros_neogracile_A0216_EU090013:5.811001343,Chaetoceros_sp._ArM0005_A0217_EU090014:5.811001343):5.80691231,Chaetoceros_neogracile_A0215_EU090012:11.61791365):5.825201348):5.806849351,Chaetoceros_sp_A0221X85390:23.24996435):5.852241642,(Chaetoceros_sp_A0220_AF145226:14.50774144,Peridinium_quinquecorneendo_symbiont_A0629_AB246746:14.50774144):14.59446455):5.828892648):6.940210895,Chaetoceros_socialis_A0223_AY485446:41.87130954):7.027475308,((Chaetoceros_rostratus_A0219X85391:16.28931839,Chaetoceros_spp442_A0226_AJ535167:16.28931839):16.30459765,(Chaetoceros_didymus_A0218X85392:24.41011543,((Chaetoceros_calcitrans_A0234_AY485449:8.138852053,Chaetoceros_calcitransfpumilus_A0236_AY625894:8.138852053):8.129259364,Chaetoceros_spjonquieri_A0229_DQ830988:16.26811142):8.142004011):8.183800613):16.3048688):6.979137016):18.63728838):24.83809812,((Attheya_cf_septentrionalis_A0211_AY485517:59.56388087,((Chaetoceros_sp._CCMP214_A0228_AY485450:19.85355963,Thalassiosira_gravida_A0516_EF192999:19.85355963):19.876584,(Pseudochaetoceros_sp._CCMP2083_A0214_AY485492:19.83696348,Chaetoceros_sp._CCMP212_A0232_EF106785:19.83696348):19.89318015):19.83373724):19.89231118,uncultured_stramenopile_A1293_AY179999:79.45619205):19.89711631):24.85193956):8.293208568,(((((((((((((((Planktoniella_sol_A0275_AJ535173:6.366122301,Thalassiosira_nodulolineata_A0487BEN0233:6.366122301):6.363377966,(Thalassiosira_angustelineata_A0488BEN0230:6.344134429,Thalassiosira_hendeyi_A0510_AM050629:6.344134429):6.385365838):6.343719367,Thalassiosira_angulata_A0481_AJ810854:19.07321963):6.395750322,(Thalassiosira_minuscula_A0515_FB0231:12.68062863,Thalassiosira_parthenia_A0491CCMP1093:12.68062863):12.78834132):6.385294297,((((Thalassiosira_aestivalis_A0513_DQ093369:6.36155391,Thalassiosira_nordenskioeldii_A0498_DQ093365:6.36155391):6.353374237,Detonula_confervacea_A0425_NB48:12.71492815):6.3637744,Thalassiosira_sp_A0484_FB0235:19.07870255):6.365384268,Thalassiosira_tenera_A0508_AJ810858:25.44408681):6.410177438):6.354534997,(((Thalassiosira_curviseriata_A0509_AJ810859:11.74093412,Thalassiosira_profunda_A0514_AM235383:11.74093412):11.73384641,Thalassiosira_nordenskioeldii_A0497_FB0219:23.47478053):11.78608317,((((((((((Skeletonema_subsalsum_A0404_AY684964:5.847046137,((Skeletonema_subsalsum_A0405_CP10778F:1.463076088,Skeletonema_subsalsum_A0403_CP10778J:1.463076088):1.456214067,Skeletonema_subsalsum_A0402_AY684967:2.919290155):2.927755982):2.974602365,((Skeletonema_subsalsum_A0422_AJ535166:3.84778655,Skeletonema_subsalsum_A0406_DQ011159:3.84778655):3.854649223,((Skeletonema_subsalsum_A0420_CP10778D:4.388992046,(Skeletonema_subsalsum_A0414_AY684966:2.195580526,Skeletonema_subsalsum_A0418_CP10778H:2.195580526):2.19341152):2.221392872,((Skeletonema_subsalsum_A0413_AY684965:2.746094187,Skeletonema_subsalsum_A0417_CP10778G:2.746094187):2.755991308,(((Skeletonema_subsalsum_A0412_AY684963:1.465338148,Skeletonema_subsalsum_A0416_CP10778E:1.465338148):1.45526383,Skeletonema_subsalsum_A0411_AY684962:2.920601978):1.487913342,(((Skeletonema_subsalsum_A0408_CP10778C:1.101741963,Skeletonema_subsalsum_A0409_AY684959:1.101741963):1.101878119,(Skeletonema_subsalsum_A0419_CP10778A:1.100793211,Skeletonema_subsalsum_A0407_AY684961:1.100793211):1.102826871):1.103002502,(Skeletonema_subsalsum_A0410_AY684960:1.635935339,Skeletonema_subsalsum_A0415_CP10778B:1.635935339):1.670687244):1.101892736):1.093570176):1.108299423):1.092050856):1.119212728):2.895375936,Skeletonema_subsalsum_A0421_AY485494:11.71702444):2.937279271,Skeletonema_costatum_A0357_DQ396523:14.65430371):2.937942472,Skeletonema_costatum_A0358_DQ396524:17.59224618):2.981595819,((((Skeletonema_menzelii_A0371CCMP787A:4.102407553,Skeletonema_menzellii_A0370_AY684939:4.102407553):4.09941504,Skeletonema_menzelii_A0368CCMP787:8.201822593):4.132547156,(Skeletonema_menzellii_A0367_AY684940:8.210146302,(Skeletonema_menzelii_A0372_AJ536450:4.099650566,Skeletonema_menzellii_A0369_DQ011161:4.099650566):4.110495736):4.124223447):4.116868655,((Skeletonema_menzellii_A0373_AJ632218:5.469754651,Skeletonema_menzellii_A0374_AJ632217:5.469754651):5.493598402,Skeletonema_menzelii_A0375_AJ535168:10.96335305):5.487885351):4.122603596):2.943618767,(Skeletonema_grevillei_A0337_DQ396512:20.53718587,((((((Skeletonema_marinoi_A0366_AJ632216:2.605656928,Skeletonema_marinoi_A0362_AJ632212:2.605656928):2.604725021,Skeletonema_marinoi_A0363_AJ632213:5.210381948):2.62405137,(Skeletonema_marinoi_A0364_AJ632214:3.896920513,Skeletonema_marinoi_A0361_EF433521:3.896920513):3.937512805):3.921011924,(Skeletonema_marinoi_A0365_AJ632215:8.791762983,((Skeletonema_costatum_A0342_EF433519:2.9264177,Skeletonema_sp._CCMP1009_A0325_AJ535165:2.9264177):2.930218151,Skeletonema_pseudocostatum_A0376_AF462060:5.856635851):2.935127132):2.963682259):2.933144398,(Skeletonema_dohrnii_A0330_AJ632210:7.32319488,Skeletonema_dohrnii_A0331_AJ632211:7.32319488):7.36539476):2.946508183,((Skeletonema_ardens_A0338_DQ396520:5.855643401,Skeletonema_ardens_A0340_DQ396522:5.855643401):5.865281469,Skeletonema_ardens_A0339_DQ396521:11.72092487):5.914172952):2.902088051):2.980274894):2.940511688,((((((Skeletonema_costatum_A0354_AY684949:13.19729915,(((Skeletonema_japonicum_A0336_DQ396518:5.856848575,(Skeletonema_japonicum_A0335_DQ011160:2.929384397,Skeletonema_costatum_A0343_AY485473:2.929384397):2.927464178):2.95887284,(Skeletonema_costatum_A0356_AY684970:6.59430467,((Skeletonema_costatum_A0344_AY684969:2.199697204,Skeletonema_costatum_A0345_NB0245:2.199697204):2.191865207,Skeletonema_costatum_A0360M54988X52006:4.391562412):2.202742258):2.221416745):2.177936822,Skeletonema_costatum_A0355_AY684968:10.99365824):2.203640912):2.220471559,(Skeletonema_costatum_A0350_AY684942:7.701196974,Skeletonema_costatum_A0351_AY684944:7.701196974):7.716573734):2.21955233,(Skeletonema_costatum_A0353_AY684948:11.72355904,(Skeletonema_grethae_A0326_DQ228694:5.852881016,Skeletonema_costatum_A0348_AY684943:5.852881016):5.870678025):5.913763997):2.200229667,((Skeletonema_costatum_A0352_AY684947:7.912426288,Skeletonema_costatum_A0349_AY684946:7.912426288):7.949967553,(((Skeletonema_grethae_A0329_AJ632204:3.955641176,Skeletonema_costatum_A0341_AY684945:3.955641176):3.963412054,Skeletonema_costatum_A0346_AY684941:7.91905323):3.965734664,(Skeletonema_costatum_A0359X85395:5.942853677,Skeletonema_grethae_A0327_DQ011158:5.942853677):5.941934218):3.977605946):3.975158865):2.162829407,Skeletonema_grethae_A0328_AJ632205:22.00038211):2.252557594,(((Skeletonema_tropicum_A0333_DQ396515:4.011910481,Skeletonema_tropicum_A0334_DQ396517:4.011910481):4.054381072,Skeletonema_tropicum_A0332_DQ396516:8.066291554):8.084665326,((Skeletonema_pseudocostatum_A0378_CP10777:8.599241919,(Skeletonema_pseudocostatum_A0384_AY684956:4.301323872,Skeletonema_pseudocostatum_A0389_CP10777G:4.301323872):4.297918047):4.320100139,((((Skeletonema_pseudocostatum_A0386_AY684958:3.335546488,Skeletonema_pseudocostatum_A0390_CP10777I:3.335546488):3.395946893,((Skeletonema_pseudocostatum_A0396X85393:2.686136472,Skeletonema_pseudocostatum_A0397X85394:2.686136472):2.69300695,(((Skeletonema_pseudocostatum_A0382_AY684954:1.342267664,Skeletonema_pseudocostatum_A0393_CP10777D:1.342267664):1.351558175,((Skeletonema_pseudocostatum_A0383_AY684955:0.8998266834,Skeletonema_pseudocostatum_A0394_CP10777E:0.8998266834):0.8973563567,(Skeletonema_pseudocostatum_A0377_AY684950:0.8987862756,Skeletonema_pseudocostatum_A0395UNP00696:0.8987862756):0.8983967645):0.8966427992):1.327648156,Skeletonema_pseudocostatum_A0400_AJ632208:4.021473995):1.357669427):1.352349959):1.351488557,(Skeletonema_pseudocostatum_A0398_AJ632206:6.433781196,(((Skeletonema_pseudocostatum_A0381_AY684953:1.611144173,Skeletonema_pseudocostatum_A0388_CP10777C:1.611144173):1.616177214,(Skeletonema_pseudocostatum_A0385_AY684957:1.607093504,Skeletonema_pseudocostatum_A0387_CP10777H:1.607093504):1.620227883):1.596898652,Skeletonema_pseudocostatum_A0401_AJ632209:4.824220039):1.609561156):1.649200743):1.60965909,((Skeletonema_pseudocostatum_A0379_AY684951:3.209443832,Skeletonema_pseudocostatum_A0391_CP10777A:3.209443832):3.257919474,((Skeletonema_pseudocostatum_A0380_AY684952:2.150660566,Skeletonema_pseudocostatum_A0392_CP10777B:2.150660566):2.130257573,Skeletonema_pseudocostatum_A0399_AJ632207:4.280918139):2.186445166):3.225277723):3.226701029):3.231614822):8.101982827):2.205032747):2.883776793,Thalassiosira_oceanica_A0520CCMP1001:29.34174925):2.958365822,(Thalassiosira_pseudonana_A0525_AJ535169:16.17205201,Thalassiosira_sp._CCMP1281_A0493_AJ535171:16.17205201):16.12806306):2.96074863):2.947935549):6.369607885,((((((Thalassiosira_minima_A0511_DQ093366:6.372721793,Thalassiosira_sp_A0492CCMP991:6.372721793):6.349305921,(Detonula_confervacea_A0424_EF192991:6.34871766,Thalassiosira_sp_A0482CCMP353:6.34871766):6.373310053):6.380417083,(Thalassiosira_affantarctica_A0518_EF192993:9.494067247,Thalassiosira_tumida_A0512_DQ093368:9.494067247):9.608377549):6.371767299,((Thalassiosira_delicatula_A0506_AJ810855:16.94538133,((((((Thalassiosira_rotula_A0530_AF462058:1.690921974,Thalassiosira_rotula_A0529_AF462059:1.690921974):1.690837803,Thalassiosira_rotula_A0532_AF374480:3.381759778):1.695763189,Thalassiosira_rotula_A0528CCMP1812:5.077522967):1.689629633,Thalassiosira_rotula_A0531X85397:6.767152599):1.722190872,(Thalassiosira_eccentrica_A0494BER029:4.213435508,Thalassiosira_eccentrica_A0495X85396:4.213435508):4.275907963):4.24338272,((Thalassiosira_angstii_A0486_NB0222:4.223174093,Thalassiosira_punctigera_A0503_AY485526:4.223174093):4.262787375,((Thalassiosira_punctigera_A0505_AJ810856:2.822288134,Thalassiosira_decipiens_A0485HeMoH14:2.822288134):2.817466976,Thalassiosira_punctigera_A0504_FB026:5.63975511):2.846206358):4.246764723):4.212655134):4.243906049,Thalassiosira_sp_A0489BEN0235:21.18928737):4.28492472):6.325970675,Thalassiosira_concaviuscula_A0507_AJ810857:31.80018277):6.404729729,(((Minidiscus_trioculatus_A0427_AY485472:6.345926467,Minidiscus_trioculatus_A0428_DQ093363:6.345926467):6.359328377,Minidiscus_trioculatus_A0426CCMP495:12.70525484):12.75728891,Thalassiosira_antarctica_A0501_EF140621:25.46254376):12.74236874):6.373494635):6.378965342,(((((Stephanodiscus_binderanus_A0471ESB2:10.86804193,Stephanodiscus_oregonicus_A0474Y981:10.86804193):10.98147997,(Stephanodiscus_agassizensis_A0472CHTC1:14.5338496,(SneoStephanodiscus_neoastraea_A0479:7.260144595,Stephanodiscus_hantzschii_fo_tenuis_A0470WTC21:7.260144595):7.273705007):7.315672306):7.251778193,((((Stephanodiscus_hantzschii_A0475_DQ093370:13.29193598,(((Stephanodiscus_yellowstonensis_A0478Y7:3.321394524,Stephanodiscus_niagarae_A0476_DQ457009:3.321394524):3.31367568,Stephanodiscus_niagarae_A0477OKAA:6.635070204):3.333880151,Stephanodiscus_reimerii_A0473WLO11:9.968950355):3.322985628):3.312842579,Stephanodiscus_minutulus_A0480WTC1:16.60477856):3.32804218,Stephanodiscus_minutulus_fo_gravis_A0469FTC15:19.93282074):3.353310722,((Cyclostephanos_invisitatus_A0189FTC26:8.705794538,Cyclostephanos_sp_A0191WTC18:8.705794538):8.755917949,((Cyclostephanos_invisitatus_A0187FTC26A:5.782476347,Cyclostephanos_invisitatus_A0188FTC26B:5.782476347):5.842245366,Cyclostephanos_sp_A0190WTC16:11.62472171):5.836990774):5.824418977):5.815168637):5.820282005,((Cyclotella_ocellata_A0438_LB8:11.62185697,Cyclotella_ocellata_A0439_LB8D:11.62185697):11.64471619,Cyclotella_bodanica_A0437J981:23.26657316):11.65500894):5.836263036,(((Cyclotella_woltereckii_A0440L435:10.1750854,Peridiniopsis_cf_kevei_diatom_endosymbiont_A0002_AB353772:10.1750854):10.18072775,(Cyclotella_stelligera_A0441L1360:10.16715417,Peridiniopsis_penardii_diatom_endosymbiont_A0003_AB353773:10.16715417):10.18865898):10.19811453,Cyclotella_pseudostelligera_A0450ROR011:30.55392768):10.20391746):10.19952733):10.18905112,(((Thalassiosira_pseudonana_A0522ETC1:20.36142337,Thalassiosira_pseudonana_A0526_AF374481:20.36142337):20.38157796,(((Detonula_confervacea_A0423_AF525672:10.16362899,Thalassiosira_pseudonana_A0524_AY485452:10.16362899):10.20027109,Thalassiosira_pseudonana_A0527_DQ093367:20.36390008):10.19706115,(Thalassiosira_pseudonana_A0523NEPC709:15.26464117,Thalassiosira_oceanica_A0521_DQ093364:15.26464117):15.29632007):10.1820401):10.20745112,((((Cyclotella_cryptica_A0444CCMP331:13.58489497,Cyclotella_cryptica_A0443_AY485499:13.58489497):13.57849672,Cyclotella_meneghiniana_A0460_AY221723:27.16339169):13.58068723,((((Cyclotella_mengheniana_A0429F8:20.35532713,(((Cyclotella_choctawatcheeana_A0442L1844:5.086356032,Cyclotella_sp_A0446_MC01:5.086356032):5.092287677,Cyclotella_atomus_A0431ROR014:10.17864371):5.081745155,Cyclotella_sp_A0445CCMP1586:15.26038886):5.09493827):5.088570874,Cyclotella_meneghiniana_A0461_DQ093371:25.44389801):5.128961642,((Cyclotella_menegheniana_A0436_WC031:21.80933117,((((Cyclotella_meneghiniana_A0452_AM236073:4.356008061,Cyclotella_meneghiniana_A0459_AJ535172:4.356008061):4.359095278,Cyclotella_meneghiniana_A0453_AY496206:8.715103339):4.362401392,Cyclotella_meneghiniana_A0454_AY496207:13.07750473):4.369476056,Cyclotella_meneghiniana_A0458_AY496213:17.44698079):4.362350385):4.354111934,Cyclotella_quillensis_A0451L1263:26.16344311):4.409416544):5.087686525,(((Cyclotella_cf_scaldensisG18W53_A0449_AY496208:8.907388879,Cyclotella_cf_scaldensisG1W11_A0448_AY496209:8.907388879):8.898432711,Cyclotella_meneghiniana_A0457_AY496212:17.80582159):8.923816865,Cyclotella_menegheniana_A0430_TI1:26.72963845):8.93090772):5.083532742):5.108174426,((((Cyclotella_menegheniana_A0432_LS031A:9.150685896,Cyclotella_menegheniana_A0434_LS031C:9.150685896):9.172781391,Cyclotella_menegheniana_A0435_LS031D:18.32346729):9.168419037,Cyclotella_menegheniana_A0433_LS031B:27.49188632):9.183566415,(Cyclotella_meneghiniana_A0455_AY496210:18.30944523,Cyclotella_meneghiniana_A0456_AY496211:18.30944523):18.3660075):9.176800605):5.098199105):10.19597115):10.17107676,((Thalassiosira_nordenskioeldii_A0496_EF192998:23.74029792,Thalassiosira_sp._CCMP1064_A0517_EF192997:23.74029792):23.78924939,Thalassiosira_sp_A0490CCMP1065:47.52954731):23.78795305):10.20566066,(((((Thalassiosira_weissflogii_A0534L1296:13.55326379,Skeletonema_costatum_A0347_CP10773B:13.55326379):13.61713342,Thalassiosira_oceanica_A0519_AF374479:27.17039721):13.5744938,((Thalassiosira_weissflogii_A0535_AJ535170:13.55807486,Thalassiosira_weissflogii_A0533_AF374477:13.55807486):13.59029483,Thalassiosira_weissflogii_A0536_AY485445:27.14836969):13.59652132):13.57142044,Thalassiosira_weissflogii_A0008_EF585582:54.31631145):13.60587579,(Thalassiosira_guillardii_A0499CCMP988:33.95018642,Thalassiosira_guillardii_A0500_AF374478:33.95018642):33.97200082):13.60097377):10.1248383,Thalassiosira_lacustris_A0483ANO28:91.64799931):10.24663146,(((((Porosira_pseudodenticulata_A0467_DQ436461:8.468030195,Porosira_glacialis_A0463_EF192992:8.468030195):8.503843705,(Porosira_glacialis_A0464CCMP1099:8.472328643,(Porosira_pseudodenticulata_A0462_EU090015:4.229171744,Porosira_pseudodenticulata_A0466X85398:4.229171744):4.243156899):8.499545258):8.465322835,Porosira_glacialis_A0007_EF585583:25.43719674):25.48430436,(Lauderia_annulata_A0324_EF192985:25.45514302,Lauderia_borealis_A0323X85399:25.45514302):25.46635807):25.51671479,(Porosira_pseudodelicatula_A0468_AY485469:38.18867199,Porosira_pseudodenticulata_A0465CCMP1433:38.18867199):38.24954388):25.4564149):10.20853467,((Lithodesmiumun_dulatum_A0294Y10569:74.67534082,(((Helicotheca_tamesis_A0295_EF192982:18.66369908,Mediopyxis_helysia_A0628_AJ968728:18.66369908):18.66451363,Streptotheca_thamesis_A0192X85385:37.32821271):18.69250129,Bellerochea_malleus_A0205_AF525671:56.020714):18.65462681):18.73540913,(Lithodesmium_undulatum_A0293CCMP1806:77.80444113,((((Ditylum_brightwellii_A0298_DQ329269:15.55715444,Ditylum_brightwelli_A0302X85386:15.55715444):15.54107326,Ditylum_brightwellii_A0301_DQ329270:31.09822771):15.60405605,(Ditylum_brightwellii_A0296_AY188181:23.32590577,(Ditylum_brightwellii_A0303_DQ329268:11.65609667,Ditylum_brightwellii_A0297_AY188182:11.65609667):11.66980909):23.37637799):15.55966128,(Ditylum_brightwellii_A0300_AY485444:31.10263521,Ditylum_brightwellii_A0299_DQ329271:31.10263521):31.15930983):15.54249609):15.60630882):18.6924155):10.1892193,(((((Biddulphia_sp._CCMP147_A0005_EF585585:20.3591069,Biddulphia_sp._CCMP147_A0207_EF192990:20.3591069):20.35842345,Odontella_aurita_A0198_AY485522:40.71753035):20.43260846,(Pleurosira_cf_laevis_A0201_AJ535188:30.52024302,Pleurosira_laevis_A0200_AF525670:30.52024302):30.62989578):20.32651852,Odontella_sinensis_A0197Y10570:81.47665733):20.4211089,(((Leptocylindrus_danicus_A0208_AY485501:25.44558125,Papiliocellulus_elegans_A0288X85388:25.44558125):25.48860596,((Cyclotella_sp_A0447MCL04:25.44033704,(Minutocellus_polymorphus_A0289_AY485478:12.71388617,Minutocellus_sp_CCMP1701_A0291_AY485520_cf:12.71388617):12.72645087):12.74771377,Arcocellulus_mammifer_A0292_EF192989:38.18805081):12.7461364):25.50000435,(Cymatosira_belgica_A0287X85387:38.18112463,Extubocellulus_spinifer_A0290_AY485504:38.18112463):38.25306693):25.46357467):20.39461852):10.20607174):8.254070175,(((Lampriscus_kittonii_A0199_AF525667:35.17872736,Toxarium_undulatum_A0601_AF525668:35.17872736):35.15606746,Biddulphiopsis_titiana_A0206_AF525669:70.33479482):35.16914772,Rhizosolenia_robusta_A0320_AY485481:105.5039425):35.24858412):8.281145421,((((Paralia_sulcata_A0238_EF192995:29.78484378,(Podosira_stelligera_A0285_AY485507:14.88738384,Hyalodiscus_sp._CCMP1679_A0286_AY485519:14.88738384):14.89745994):29.81384403,(Stephanopyxis_nipponica_A0279M87330:29.79302709,Stephanopyxis_palmeriana_A0280_AY485527:29.79302709):29.80566072):29.8168508,((((((((Aulacoseira_sp._FR9_A0261_AY569575:3.706966391,(Aulacoseira_subarctica_A0249_AY569573:2.469837047,(Aulacoseira_subarctica_A0248_AY569574:1.238222709,Aulacoseira_subarctica_A0250_AY569576:1.238222709):1.231614338):1.237129344):1.242489264,Aulacoseira_subarctica_A0251_AY569577:4.949455655):4.954094619,Aulacoseira_subarctica_A0252_AY121818:9.903550274):4.961742532,Aulacoseira_alpigena_A0256_AY569578:14.86529281):14.94513432,((Aulacoseira_ambigua_A0269X85404:13.40066642,Aulacoseira_ambigua_A0266_AY569580:13.40066642):13.39989432,((Aulacoseira_ambigua_A0265_AY569579:20.83596927,(((Aulacoseira_ambigua_A0264_AY569581:11.89331024,(((Aulacoseira_distans_A0239X85403:2.958059788,Aulacoseira_cf_granulatavangustissima_A0255_AY485493:2.958059788):2.995739683,(Aulacoseira_granulata_A0257_AY569584:2.971993649,Aulacoseira_granulata_A0258_AY569585:2.971993649):2.981805822):2.980509764,(Aulacoseira_nyassensis_A0253_AY121819:4.458803916,Aulacoseira_nyassensis_A0254_AJ535187:4.458803916):4.47550532):2.959001001):2.984711622,Aulacoseira_ambigua_A0268_AY569583:14.87802186):2.977672346,Aulacoseira_valida_A0259_AY569586:17.8556942):2.980275067):2.972525169,Aulacoseira_ambigua_A0267_AY569582:23.80849444):2.992066296):3.009866389):14.89915098,(Aulacoseira_islandica_A0245_AJ535183:22.3127457,((Aulacoseira_baicalensis_A0240_AJ535185:11.14997189,(Aulacoseira_baicalensis_A0241_AJ535186:5.577346214,Aulacoseira_baicalensis_A0242_AY121821:5.577346214):5.572625671):5.601217758,((Aulacoseira_skvortzowii_A0246_AY121822:5.578692775,Aulacoseira_skvortzowii_A0247_AJ535184:5.578692775):5.577518549,(Aulacoseira_islandica_A0244_AY121820:5.579490431,Aulacoseira_islandica_A0243_AY569572:5.579490431):5.576720892):5.59497832):5.561556059):22.3968324):14.90664955,((Aulacoseira_crenulata_A0260_AY569589:19.82511152,Aulacoseira_sp._LPNH1_A0263_AY569588:19.82511152):19.90829114,Aulacoseira_sp._ODR3_A0262_AY569587:39.73340266):19.88282499):14.87989707,((Melosira_varians_A0281_AY569590:24.81893524,(Melosira_varians_A0282_AJ243065:12.39510522,Melosira_varians_A0283X85402:12.39510522):12.42383002):24.85481431,(Melosira_cf_octogona_A0284_AY485518:24.82999038,uncultured_diatom_A0613_AY180020:24.82999038):24.84375917):24.82237517):14.91941389):29.84550972,(((Coscinodiscus_radiatus_A0270X77705:29.76648258,(Coscinodiscus_granii_A0271_AY485495:14.90464337,Coscinodiscus_sp._GGM2004_A0272_AY485448:14.90464337):14.86183921):29.84798724,(Stellarima_microtrias_A0273_AY485477:29.766504,Stellarima_microtrias_A0274_EU090011:29.766504):29.84796582):29.78266727,((Actinocyclus_curvatulus_A0276X85401:29.75358051,Actinocyclus_actinochilus_A0277_AY485506:29.75358051):29.86131176,Actinoptychus_sinensis_A0278_AJ535182:59.61489227):29.78224482):29.86391124):29.77262375):8.291243797,(((((Corethron_hystrix_A0194_AJ535179:15.69330322,Corethron_hystrix_A0195_EF192981:15.69330322):15.74884369,Corethron_criophilum_A0193X85400:31.44214691):31.43612915,Corethron_inerme_A0196_AJ535180:62.87827606):31.52041207,(((Guinardia_flaccida_A0308_AJ535191:15.70885002,(Guinardia_delicatula_A0309_AY485487:7.856168216,Rhizosolenia_setigera_A0315M87329:7.856168216):7.852681807):15.73005018,Guinardia_solstherfothii_A0311_AY485511:31.4389002):31.4721389,(((Guinardia_delicatula_A0310_AJ535192:15.69916517,(Rhizosolenia_setigera_A0314_AY485461:7.846561593,Rhizosolenia_cf_setigera_A0318_AY485479:7.846561593):7.852603581):15.75921233,(((Rhizosolenia_setigera_A0312_AY485509:5.217202103,(Rhizosolenia_imbricata_A0316_AJ535178:2.6099008,Rhizosolenia_similoides_A0317_AJ535177:2.6099008):2.607301304):5.248809093,Rhizosolenia_setigera_A0313_AY485508:10.4660112):10.46440165,Rhizosolenia_pungens_A0321_AY485486:20.93041285):10.52796466):15.73115442,(Rhizosolenia_fallax_A0319_AY485480:23.58789681,Rhizosolenia_shubsholei_A0322_AY485510:23.58789681):23.60163512):15.72150718):31.48764903):31.45736062,(((Leptocylindrus_danicus_A0209_AJ535175:31.41437943,Leptocylindrus_minimus_A0210_AJ535176:31.41437943):31.50851506,Paralia_sol_A0237_AJ535174:62.9228945):31.4523509,(((Proboscia_alata_A0305_AJ535181:23.58569225,Proboscia_alata_A0304_AY485525:23.58569225):23.58545017,Proboscia_inermis_A0307_EF192984:47.17114242):23.5643506,Proboscia_indica_A0306_AY485470:70.73549302):23.63975238):31.48080335):31.46886713):8.253936307,(Bolidomonas_mediterranea_A0772_AF123596:82.76588986,(((Bolidomonas_pacifica_A0773_AF167157:20.6715548,Bolidomonas_pacifica_A0774_AF167156:20.6715548):20.70599861,Bolidomonas_pacifica_A0778_AF123595:41.37755341):20.70865699,((Bolidomonas_pacifica_A0775_AF167154:20.66759772,Bolidomonas_pacifica_A0777_AF167153:20.66759772):20.7155412,Bolidomonas_pacifica_A0776_AF167155:41.38313891):20.70307149):20.67967946):82.81296233):8.265974731,(Giraudyopsis_stellifera_A1266U78034:86.91953858,(uncultured_stramenopile_A1296_AY180021:43.42469322,Olisthodiscus_luteus_A1304_AY788937:43.42469322):43.49484537):86.92528833):8.308598332,(((Florenciella_ultra_A0837_AY254857:45.55037852,(Chattonella_verruculosa_A1163_AY788947:22.70384275,Chattonella_verruculosa_A1164_AY788948:22.70384275):22.84653577):45.50009941,(Dictyocha_speculum_A0839U14385:45.51170864,Dictyocha_fibula_A0840_AB096710:45.51170864):45.53876929):45.56838437,((Rhizochromulina_cf_marina_A0838U14388:45.50292793,(Ciliophrys_infusionum_A0846_AB081641:22.74859246,Ciliophrys_infusionum_A0847L37205:22.74859246):22.75433547):45.56756556,(uncultured_dictyochophyte_A0841_AY821963:45.51679138,((((Apedinella_radians_A0842U14384:9.08957527,(Pteridomonas_danica_A0844_AB081640:4.533020816,Pteridomonas_danica_A0845L37204:4.533020816):4.556554455):9.107340794,Helicopedinella_tricostata_A0849_AB097408:18.19691606):9.093800625,Pseudopedinella_elastica_A0843U14387:27.29071669):9.09272919,Pedinella_sp_squamata_A0848_AB081517:36.38344588):9.133345497):45.55370211):45.54836882):45.53456295):8.297984099):38.09545844):9.527739875,((((((((((((Blastocystis_cycluri_A0675_AY590116:7.17047684,Blastocystis_cycluri_A0676_AY266474:7.17047684):7.247485984,(((((((Blastocystis_ratti_A0681_AY590111:1.803031659,Blastocystis_ratti_A0682_AY590113:1.803031659):1.781834996,Blastocystis_ratti_A0683_AY590114:3.584866655):1.822004115,((Blastocystis_hominis_A0718_AY244619:1.793488665,Blastocystis_hominis_A0719_AY244620:1.793488665):1.809446283,Blastocystis_hominis_A0720_AY244621:3.602934948):1.803935821):1.778700882,Blastocystis_sp_A0771U51152:7.185571652):1.827586037,((Blastocystis_sp._RN949_A0741_AB071000:4.490195814,(unidentified_guinea_pig_faeces_isolate_U26177_A0723U26177:2.248641123,Blastocystis_sp_A0766_AY135408:2.248641123):2.241554692):2.260996282,(Blastocystis_sp_A0765_AY135407:3.381754674,Blastocystis_sp._RN949_A0742_AB091251:3.381754674):3.369437422):2.261965593):1.789856934,(Blastocystis_sp._MJ99132_A0752_AB107970:5.3936428,Blastocystis_sp._BJ99319_A0753_AB107971:5.3936428):5.409371824):1.816208643,(((((Blastocystis_hominis_A0694_AB091235:1.570692289,Blastocystis_hominis_A0687_AB070988:1.570692289):1.56746092,Blastocystis_hominis_A0685_AB070986:3.138153209):1.590090237,(Blastocystis_hominis_A0693_AB091234:2.35842269,(Blastocystis_hominis_A0706_AY618268:1.183478931,(Blastocystis_sp._PJ99162_A0745_AB107963:0.598797407,Blastocystis_sp._CJ99363_A0747_AB107965:0.598797407):0.5846815242):1.174943759):2.369820756):1.578937344,(Blastocystis_hominis_A0692_AB091233:3.132553715,Blastocystis_sp_A0760_AY135402:3.132553715):3.174627075):3.125870231,Blastocystis_hominis_A0691_AB070992:9.433051022):3.186172245):1.798739558):7.165279896,Blastocystis_sp._AFJ96T8_A0756_AY266467:21.58324272):21.69580908,((Blastocystis_lapemi_A0677_AY590115:14.40274805,Blastocystis_lapemi_A0678_AY266471:14.40274805):14.4537412,((Blastocystis_pythoni_A0679_AY590112:9.617628798,Blastocystis_pythoni_A0680_AY266472:9.617628798):9.566965328,Blastocystis_sp._R44_A0724_AY266475:19.18459413):9.671895127):14.42256254):21.64549511,(((((((Blastocystis_hominis_A0721_AY618265:8.100200471,Blastocystis_sp._JM922_A0735_AB070997:8.100200471):8.113303667,(Blastocystis_hominis_A0686_AB070987:8.100904496,Blastocystis_sp._MJ99116_A0751_AB107969:8.100904496):8.112599642):8.080918922,Blastocystis_hominis_A0707_AY956324:24.29442306):8.163011948,((Blastocystis_hominis_A0717U51151:12.95980016,Blastocystis_sp_A0763_AY135405:12.95980016):12.99423008,((Blastocystis_hominis_A0688_AB070989:12.94430006,(Blastocystis_sp_A0764_AY135406:6.457319694,((((((Blastocystis_hominis_A0710_AB023499:2.153331146,((Blastocystis_hominis_A0700_AB091241:0.7269137895,Blastocystis_hominis_A0699_AB091240:0.7269137895):0.7115627594,Blastocystis_sp_A0762_AY135404:1.438476549):0.7148545975):0.7174034151,Blastocystis_hominis_A0711_AB023578:2.870734562):0.7166761546,Blastocystis_sp._CK861_A0725_AB070993:3.587410716):0.7172796435,Blastocystis_sp_A0761_AY135403:4.30469036):0.7404348427,((Blastocystis_hominis_A0708_AY618267:1.668512612,Blastocystis_sp._PJ99154_A0743_AB107961:1.668512612):1.687890546,Blastocystis_sp._MJ99568_A0750_AB107968:3.356403158):1.688722044):0.7214699455,((Blastocystis_sp._PJ99172_A0744_AB107962:1.906556298,Blastocystis_sp._MJ99424_A0749_AB107967:1.906556298):1.937491017,(Blastocystis_hominis_A0709_AY590110:1.91246573,Blastocystis_hominis_A0722_AY618266:1.91246573):1.931581584):1.922547834):0.6907245458):6.486980361):6.484550585,Blastocystis_hominis_A0704_AF439782:19.42885064):6.525179601):6.503404767):8.067080244,Blastocystis_hominis_A0705_AF538348:40.52451525):8.169273408,((((Blastocystis_sp._PJ99188_A0746_AB107964:8.09439801,Blastocystis_sp._SY947_A0740_AB091250:8.09439801):8.105188984,Blastocystis_sp._CJ99284_A0748_AB107966:16.19958699):16.2600982,(Blastocystis_sp._SY947_A0739_AB091249:24.32691652,((Blastocystis_sp._SY943_A0737_AB091248:8.093644651,Blastocystis_sp._SY943_A0736_AB070998:8.093644651):8.115199429,Blastocystis_sp._AFJ96H1_A0758_AY266469:16.20884408):8.118072445):8.132768668):8.072042101,Blastocystis_sp._SY947_A0738_AB070999:40.53172729):8.162061366):8.110598362,(((((Blastocystis_hominis_A0696_AB091237:14.17449695,Blastocystis_sp._QQ933_A0729_AB091243:14.17449695):14.2179646,(Blastocystis_sp._QQ933_A0728_AB070995:21.27284813,((((Blastocystis_hominis_A0695_AB091236:2.35891144,Blastocystis_sp_A0769_AY135411:2.35891144):2.367867148,(Blastocystis_hominis_A0689_AB070990:2.351616137,Blastocystis_hominis_A0697_AB091238:2.351616137):2.375162452):2.357009353,Blastocystis_sp._CK924_A0727_AB091242:7.083787942):7.093919027,Blastocystis_sp._CK924_A0726_AB070994:14.17770697):7.095141162):7.119613412):7.074776426,Blastocystis_sp._BJ99310_A0754_AB107972:35.46723797):7.124337247,(Blastocystis_hominis_A0701_AF408425:21.2556338,Blastocystis_hominis_A0702_AF408426:21.2556338):21.33594142):7.121704101,((((((Blastocystis_sp._QQ984_A0731_AB091244:7.076127042,Blastocystis_sp._QQ984_A0730_AB070996:7.076127042):7.092884804,Blastocystis_hominis_A0698_AB091239:14.16901185):7.124437979,((((Blastocystis_hominis_A0712_AY590105:4.236959874,Blastocystis_hominis_A0715_AY590106:4.236959874):4.25333699,Blastocystis_hominis_A0714_AY590109:8.490296864):4.2923817,((Blastocystis_hominis_A0713_AY590108:4.241724139,(Blastocystis_sp._QQ984_A0732_AB091245:2.117373276,Blastocystis_sp._QQ984_A0733_AB091246:2.117373276):2.124350864):4.251527248,Blastocystis_sp._QQ984_A0734_AB091247:8.493251388):4.289427177):4.23046028,Blastocystis_sp_A0770_AY135412:17.01313884):4.28031098):7.104823492,(Blastocystis_hominis_A0690_AB070991:18.90931431,(Blastocystis_hominis_A0703_AF408427:9.441817951,Blastocystis_hominis_A0716_AY590107:9.441817951):9.467496364):9.488959001):7.062446756,Blastocystis_sp._BJ99569_A0755_AB107973:35.46072007):7.126163238,(Blastocystis_sp_A0767_AY135409:21.27426606,Blastocystis_sp_A0768_AY135410:21.27426606):21.31261725):7.126396006):7.091107705):8.12015988):21.62200389,(Blastocystis_geocheloni_A0684_AY266473:43.26181,(Blastocystis_sp._AFJ96U12_A0757_AY266468:21.62591728,Blastocystis_sp._AFJ96H12_A0759_AY266470:21.62591728):21.63589272):43.28474079):21.63675677,(Proteromonas_lacertae_A1190U37108:54.06297042,(Protoopalina_japonica_A1193_AB175929:27.03318379,Protoopalina_intestinalis_A1194_AY576545:27.03318379):27.02978663):54.12033714):21.57744819,Actinosphaerium_eichhornii_A1337_AY305011:129.7607558):21.71163701,(uncultured_labyrinthulid_A0947_AY821979:75.70146341,(Cepedea_virguloidea_A1191_AF141969:37.85038208,Opalina_ranarum_A1192_AF141970:37.85038208):37.85108133):75.77092936):21.65716979,((((Lagenidium_giganteum_A0951M54939X54266:34.57628016,((((((((((((Phytophthora_tropicalis_A0960_AY742743:4.029441403,((Phytophthora_palmivora_A0970_AY744948:1.345457961,Peronophythora_litchii_A0954_AY742750:1.345457961):1.342370411,Phytophthora_palmivora_A0969_AY742745:2.687828372):1.341613031):1.348306604,Phytophthora_capsici_A0963_AY742748:5.377748007):1.366525147,(Pseudoperonospora_cubensis_A0956_AY742760:4.472259542,(Phytophthora_tropicalis_A0961_AY742747:2.234926115,Phytophthora_capsici_A0962_AY742746:2.234926115):2.237333427):2.272013611):1.3400565,(Phytophthora_megasperma_A0966X54265:4.031136531,Phytophthora_sojae_A0971_AY742749:4.031136531):4.053193123):1.357877087,(((Phytophthora_infestans_A0964_AY742744:1.567215478,Phytophthora_infestans_A0965_AY742761:1.567215478):1.566058002,uncultured_Phytophthora_like_oomycete_stramenopile_A0999_AY821974:3.13327348):3.136871242,Phytophthora_insolita_A0959_AY742751:6.270144721):3.17206202):3.140109734,(Phytophthora_nicotianae_A0967_AY744947:6.270244305,Phytophthora_nicotianae_A0968_AY742753:6.270244305):6.31207217):3.121011756,Plasmopara_viticola_A0955_AY742754:15.70332823):3.14654058,Hyaloperonospora_parasitica_A0957_AY742752:18.84986881):3.141747446,uncultured_oomycete_A0997_AY821976:21.99161626):3.185227317,(((Pythium_A0972_AY129550uncultured:6.279953743,Pythium_monospermum_A0978_AJ238653:6.279953743):6.285346926,uncultured_oomycete_A0996_AB074662:12.56530067):6.318238899,(Pythium_splendens_A0976_AY742756:9.396029566,Pythium_splendens_A0977_AY742757:9.396029566):9.487510001):6.293304006):3.132495517,((Pythium_vexans_A0973_AY742758:9.415180723,Pythium_vexans_A0974_AY742759:9.415180723):9.46488672,uncultured_oomycete_A0998_AY821969:18.88006744):9.429271649):3.159282259,(Phytophthora_undulata_A0958_AJ238654:15.71278664,(Pythium_aphanidermatum_A0975_AY742755:7.839832562,((Pythium_insidiosum_A0979_AF442497:2.610534207,Pythium_insidiosum_A0980_AF289981:2.610534207):2.615725766,Pythium_insidiosum_A0981_AY486144:5.226259972):2.61357259):7.872954077):15.75583471):3.10765881):34.67331259,(Apodachlya_brachynema_A0952_AJ238663:34.57526585,(((((Pythiopsis_cymosa_A0982_AJ238657:5.747218876,(((Saprolegnia_ferax_A0992_AJ238655:1.435820377,Saprolegnia_parasitica_A0994_AB086898:1.435820377):1.435710774,Saprolegnia_parasitica_A0995_AB086899:2.87153115):1.437123029,Saprolegnia_parasitica_A0993_AB175931:4.30865418):1.438564696):5.785452478,(Achlya_apiculata_A0989_AJ238656:7.669602642,(Aplanopsis_terrestris_A0983_AJ238658:3.829792747,Achlya_bisexualis_A0988M32705:3.829792747):3.839809895):3.863068713):5.737936671,Leptolegnia_sp_A0987_AJ238662:17.27060803):5.800512004,(Leptolegnia_caudata_A0984_AJ238659:11.52522341,(Leptolegnia_chapmanii_A0985_AJ238660:5.756270329,Leptolegnia_chapmanii_A0986_AJ238661:5.756270329):5.76895308):11.54589662):5.770578969,(Aphanomyces_sp841240_A0990_AF396683:14.3982992,Aphanomyces_invadans_A0991_AF396684:14.3982992):14.4433998):5.733566847):34.67432691):34.61009809,(((uncultured_stramenopile_A1282_AF372762:25.94267228,uncultured_stramenopile_A1283_AF372763:25.94267228):25.96551142,uncultured_stramenopile_A1298_AY180031:51.9081837):25.95004617,uncultured_marine_eukaryote_A1330_AY381206:77.85822987):26.00146097):34.58286229,Eurychasma_dicksonii_A0953_AY032607:138.4425531):34.68700943):21.60946215,(Rhizidiomyces_apophysatus_A1261_AF163295:97.351695,(Hyphochytrium_catenoides_A1262_AF163294:48.64602859,Hyphochytrium_catenoides_A1263X80344:48.64602859):48.70566641):97.38732971):21.68182102,((((Pirsonia_diadema_A1315_AJ561114:43.22803621,Pirsonia_guinardiae_A1313_AJ561112:43.22803621):43.34030447,((Pirsonia_formosa_A1311_AJ561110:21.64289628,Pirsonia_formosa_A1312_AJ561111:21.64289628):21.57816305,Pirsonia_formosa_A1310_AJ561109:43.22105934):43.34728134):43.21116972,Pirsonia_verrucosa_A1314_AJ561113:129.7795104):43.23038696,Pirsonia_punctigera_A1316_AJ561115:173.0098974):43.41094838):21.65376193):9.471391696,((Uncultured_marine_stramenopile_DH144EKD10_A1260_AF290063:82.46158575,uncultured_stramenopile_A1299_AY295431:82.46158575):82.504263,uncultured_stramenopile_A1281_AF372760:164.9658487):82.58015061):9.39617671,Uncultured_marine_stramenopile_DH1485EKD53_A1259_AF290083:256.9421761):9.614597265,(Developayella_elegans_A1264U37107:133.2959553,(uncultured_stramenopile_OLI51105_A1269_AF167414:66.61737301,(((((uncultured_stramenopile_A1273_AF372752:11.0774491,uncultured_stramenopile_A1274_AF372753:11.0774491):11.12572684,(uncultured_stramenopile_A1271_AF372750:14.7881297,(uncultured_stramenopile_A1272_AF372751:7.394414568,(uncultured_stramenopile_A1275_AF372754:3.678645766,uncultured_stramenopile_A1276_AF372755:3.678645766):3.715768802):7.39371513):7.415046237):11.11120006,(uncultured_stramenopile_A1277_AF372756:16.64548506,uncultured_stramenopile_A1280_AF372759:16.64548506):16.66889094):11.07253389,uncultured_stramenopile_A1278_AF372757:44.38690989):11.12415297,uncultured_stramenopile_A1279_AF372758:55.51106286):11.10631014):66.67858228):133.260818):9.593006026,(((((((((((Labyrinthuloides_haliotidis_A0901U21338:20.41722212,Thraustochytriidae_sp._M4103_A0932_AB073307:20.41722212):20.48215612,((((Schizochytrium_aggregatum_A0911_AB022106:8.166229072,Thraustochytrium_kinnei_A0916L34668:8.166229072):8.19114224,Thraustochytriidae_sp._F31_A0931_AB073304:16.35737131):8.175071586,(Ulkenia_profunda_A0922_AB022114:12.24830389,Ulkenia_radiata_A0924_AB022115:12.24830389):12.28413901):8.160026741,Thraustochytrium_aureum_A0917_AB022110:32.69246964):8.206908602):20.46253461,(((Japonochytrium_sp._ATCC28207_A0902_AB022104:15.32521658,Ulkenia_visurgensis_A0925_AB022116:15.32521658):15.3398979,Ulkenia_profunda_A0923L34054:30.66511449):15.29979616,Thraustochytrium_striatum_A0919_AB022112:45.96491065):15.3970022):20.45649226,(((Schizochytrium_sp._KH105_A0913_AB052555:20.42110682,((Thraustochytriidae_sp._MBIC11075_A0942_AB183658:7.659138974,Thraustochytriidae_sp._MBIC11070_A0939_AB183656:7.659138974):7.667202772,((Thraustochytriidae_sp._MBIC11067_A0938_AB183655:5.08863001,Thraustochytriidae_sp._MBIC11084_A0940_AB183660:5.08863001):5.126064848,Thraustochytriidae_sp._MBIC11086_A0941_AB183661:10.21469486):5.111646889):5.094765071):20.48038322,(Thraustochytrium_sp._CHN1_A0921_AB126669:20.42783956,((Thraustochytriidae_sp._N127_A0933_AB073308:6.788995326,Thraustochytriidae_sp._FJN10_A0944_AY773276:6.788995326):6.817816002,Thraustochytriidae_sp._MBIC11093_A0943_AB183664:13.60681133):6.821028229):20.47365048):20.45924231,(Schizochytrium_sp._FJU512_A0914_AY758384:30.64587909,(Schizochytrium_limacinum_A0915_AB022107:15.30282885,Thraustochytriidae_sp._A520_A0930_AB073303:15.30282885):15.34305024):30.71485327):20.45767276):20.44877867,((Thraustochytriidae_sp._BS1_A0926_AF257314:34.06774725,Thraustochytriidae_sp._BS2_A0927_AF257315:34.06774725):34.09319663,((Thraustochytriidae_sp._MBIC11060_A0935_AB183653:22.69584102,(Thraustochytriidae_sp._MBIC11063_A0936_AB183654:11.32737234,Thraustochytriidae_sp._MBIC11077_A0937_AB183659:11.32737234):11.36846868):22.73644223,Thraustochytriidae_sp._Fng1_A0945_AY870336:45.43228325):22.72866063):34.10623991):20.44261838,(Thraustochytrium_aggregatum_A0918_AB022109:61.32161827,((Thraustochytrium_pachydermum_A0920_AB022113:20.44671606,Thraustochytriidae_sp._C9G_A0934_AF474172:20.44671606):20.4497534,(labyrinthulid_quahog_parasite_QPX_A0948_AF155209:20.42657562,(labyrinthulid_quahog_parasite_QPX_A0949_AY052644:10.19893368,labyrinthulid_quahog_parasite_QPX_A0950_AF261664:10.19893368):10.22764194):20.46989384):20.42514881):61.3881839):20.38866563,uncultured_marine_eukaryote_A1332_AY381210:143.0984678):20.53704365,(Schizochytrium_minutum_A0912_AB022108:81.76759273,(Thraustochytriidae_sp._75_A0928_AF257316:40.87758476,Thraustochytriidae_sp._87_A0929_AF257317:40.87758476):40.89000797):81.86791873):20.45334291,(((((Labyrinthula_sp._Nakagiri_A0897_AB022105:30.64954868,Labyrinthula_sp._L59_A0899_AB095092:30.64954868):30.65602116,uncultured_stramenopile_A1300_AY835688:61.30556984):30.68553371,uncultured_labyrinthulid_A0946_AY821970:91.99110355):30.69426264,Labyrinthula_sp._fSap161_A0898_AF348522:122.6853662):30.70010417,((((((Labyrinthuloides_minuta_A0900L27634:21.87545615,((Aplanochytrium_sp._PR123_A0905_AF348517:7.281016802,(Aplanochytrium_sp._PR241_A0907_AF348519:3.630653154,Aplanochytrium_sp._SC241_A0909_AF348521:3.630653154):3.650363649):7.304298081,Aplanochytrium_sp._PR151_A0906_AF348518:14.58531488):7.290141268):21.91373875,Aplanochytrium_sp._PR11_A0904_AF348516:43.7891949):21.92321269,Aplanochytrium_stocchinoi_A0910_AJ519935:65.7124076):21.89764664,Aplanochytrium_sp._SC11_A0908_AF348520:87.61005424):21.90999452,Aplanochytrium_kerguelense_A0903_AB022103:109.5200488):21.90386887,uncultured_marine_eukaryote_A1334_AY381216:131.4239176):21.96155273):30.70338401):30.54706192,uncultured_marine_eukaryote_A1323_AY381171:214.6359163):30.86091743,(((Uncultured_marine_labyrinthulid_DH147EKD10_A1258_AF290070:61.34953858,(Pseudopirsonia_mucosa_A1309_AJ561116:30.65697284,uncultured_marine_eukaryote_A1336_AY426835:30.65697284):30.69256574):61.34570364,(uncultured_marine_eukaryote_A1327_AY381196:61.31474126,uncultured_marine_eukaryote_A1335_AY381217:61.31474126):61.38050096):61.36425959,((uncultured_marine_eukaryote_A1324_AY381181:61.32508054,uncultured_marine_eukaryote_A1325_AY381186:61.32508054):61.37657406,(uncultured_marine_eukaryote_A1326_AY381191:61.37370728,(uncultured_marine_eukaryote_A1331_AY381207:30.62867258,uncultured_marine_eukaryote_A1333_AY381211:30.62867258):30.74503471):61.32794731):61.35784721):61.43733191):30.65294564):9.488918176,((uncultured_marine_eukaryote_A1322_AY381157:95.15417545,uncultured_marine_eukaryote_A1329_AY381204:95.15417545):95.18019273,uncultured_marine_eukaryote_A1328_AY381200:190.3343682):95.30432935):9.369096507,Placidia_cafeteriopsis_A1268_AB061218:295.007794):9.700753395,((((Siluania_monomastiga_A0660_AF072883:60.89072415,uncultured_bicosoecid_A0663_AY821966:60.89072415):60.92547552,Adriamonas_peritocrescens_A0661_AF243501:121.8161997):60.89015732,uncultured_bicosoecid_A0664_AY821965:182.706357):60.91679687,uncultured_bicosoecid_A0662_AY821964:243.6231539):61.08539356):9.450837518,(Halocafeteria_seosinensis_A0673_DQ269470:157.0258954,Halocafeteria_sp._EHF0502_A0674_DQ269469:157.0258954):157.1334896):9.591012793,(((Caecitellus_parvulus_A0665_AY827848:80.88021561,Caecitellus_parvulus_A0668_AY827847:80.88021561):80.95263729,(Caecitellus_parvulus_A0666_AF174367:80.89395094,Caecitellus_parvulus_A0667_AF174368:80.89395094):80.93890196):80.93555208,(Symbiomonas_scintillans_A1306_AF185052:121.3350297,Symbiomonas_scintillans_A1307_AF185053:121.3350297):121.4333752):80.98199276):9.514970931):333.1650585):333.5695728)Eukaryotes;");
	}

	// default viewing options (can be changed with buttons when running)
	var polytype = 3; // the way polytomies are expressed (should be 0,1,2 or 3)
	var viewtype = 2; // the default viewtype (should be 1,2,3,4 or 5)
	var colourtype = 3; // the default colour mode - note: if doing further editing of colour palette's below this may become irrelevant
	// colourtype = 3 is only suited for redlist data
	var leaftype = 2; // leaf shape circular or natural - this cannpt be changed with buttons it is recommended you leave it
	
	var fonttype = 'Helvetica'; // change the text font to match the rest of your article and journal style // 'sans-serif' // is good too
	var intnodetextcolor = 'rgb(255,255,255)' // for interior node text colour where there is a name to be put
	// note there are more advanced options later to change th interior node text
	var backgroundcolor = 'rgb(255,255,200)' //background color 'null' if no background is wanted
	var outlineboxcolor = 'rgb(0,0,0)' // outline box colour
	
	// colour codes for redlist
	function redlistcolor(codein)
	{
		switch(codein)
		{
			case "EX":
			return ('rgb(0,0,180)');
			case "EW":
			return ('rgb(60,50,135)');
			case "CR":
			return ('rgb(220,0,0)');
			case "EN":
			return ('rgb(125,30,00)');
			case "VU":
			return ('rgb(85,85,30)');
			case "NT":
			return ('rgb(65,120,0)');
			case "LC":
			return ('rgb(0,220,0)');
			case "DD":
			return ('rgb(80,80,80)');
			case "NE":
			return ('rgb(0,0,0)');
			default:
			return ('rgb(0,0,0)');
		}
	}
	
	// definition of geological periods 
	function gpmapper(datein)
	{
		if (datein > 253.8)
		{
			return("pre Triassic");
		}
		else
		{
			if (datein > 203.6)
			{
				return("Triassic");
			}
			else
			{
				if (datein > 150.8)
				{
					return("Jurassic");
				}
				else
				{
					if (datein > 70.6)
					{
						return("Cretaceous");
					}
					else
					{
						if (datein > 28.4)
						{
							return("Paleogene");
						}
						else
						{
							if (datein > 3.6)
							{
								return("Neogene");
							}
							else
							{
								return("Quaternary");
							}	
						}	
					}	
				}	
			}
		}
		
	}
	
	midnode.prototype.leafcolor1 = function() 
	{
		// for the leaf fill
		if ((this.redlist)&&(colourtype == 3))
		{
			return(redlistcolor(this.redlist));
		}
		else
		{
			if (colourtype == 3)
			{
				return (this.branchcolor());
			}
			else
			{
				return ('rgb(0,100,0)');
			}
		}
	}
	
	
	midnode.prototype.leafcolor2 = function() 
	{
		// for the leaf outline
		if ((this.redlist)&&(colourtype == 3))
		{
			return(redlistcolor(this.redlist));
		}
		else
		{
			if (colourtype == 3)
			{
				return (this.branchcolor());
			}
			else
			{
				return ('rgb(0,100,0)');
			}
		}
	}
	
	midnode.prototype.leafcolor3 = function() 
	{
		return ('rgb(255,255,255)'); // for the leaf text 
	}
	
	midnode.prototype.hitstextcolor = function() 
	{
		// for text showing number of hits in each interior node (for search function)
		if ((this.npolyt)||(polytype == 3))
		{
			return ('rgb(255,255,255)');
		}
		else
		{
			return this.branchcolor(); 
		} 
	}
	
	midnode.prototype.branchcolor = function() // branch colour logic
	{
		// this script sets the colours of the branches
		var colortoreturn = 'rgb(100,75,50)';
		if (colourtype == 2) // there are two different color schemes in this version described by the colourtype variable
		{
			// this.lengthbr is the date of the node
			// timelim is the cut of date beyond which the tree is not drawn (when using growth animation functions
			if ((this.lengthbr<150.8)&&(timelim<150.8)) 
			{
				colortoreturn =  'rgb(180,50,25)';
			}
			if ((this.lengthbr<70.6)&&(timelim<70.6))
			{
				colortoreturn =  'rgb(50,25,50)';
			}
		}
		else
		{
			
			var conservation = (4*(this.num_CR) + 3*(this.num_EN) + 2*(this.num_VU) + this.num_NT);
			var num_surveyed = (this.num_CR + this.num_EN + this.num_VU + this.num_NT + this.num_LC);
			if (colourtype == 3)
			{
				if (num_surveyed == 0)
				{
					if (((this.num_NE >= this.num_DD)&&(this.num_NE >= this.num_EW))&&(this.num_NE >= this.num_EX))
					{
						colortoreturn = redlistcolor("NE");
					}
					else
					{
						if ((this.num_DD >= this.num_EX)&&(this.num_DD >= this.num_EW))
						{
							colortoreturn = redlistcolor("DD");
						}
						else
						{
							if (this.num_EW >= this.num_EX)
							{
								colortoreturn = redlistcolor("EW");
							}
							else
							{
								colortoreturn = redlistcolor("EX");
							}
						}
					}
				}
				else
				{
					if ((conservation/num_surveyed)>3.5)
					{
						colortoreturn = redlistcolor("CR");
					}
					else
					{
						if ((conservation/num_surveyed)>2.5)
						{
							colortoreturn = redlistcolor("EN");
						}
						else
						{
							if ((conservation/num_surveyed)>1.5)
							{
								colortoreturn = redlistcolor("VU");
							}
							else
							{
								if ((conservation/num_surveyed)>0.5)
								{
									colortoreturn = redlistcolor("NT");
								}
								else
								{
									colortoreturn = redlistcolor("LC");
								}
							}
						}
					}
				}
			}
		}
		// the current logic uses different colorschemes for pre, post and during the Cretaceous period, if color type = 2 
		// otherwise it uses a fixed brown color for the branches
		// when the tree is growing it only allows branches to be coloured for a certain period if the tree has already growed up to that period.
		return colortoreturn;
	}
	
	midnode.prototype.barccolor = function() // branch outline colour logic
	{
		// this script sets the color for the outline of the branches
		var colortoreturn = 'rgb(50,37,25)';
		if (colourtype == 2)
		{
			if((this.lengthbr<70.6)&&(timelim<70.6))
			{
				colortoreturn = 'rgb(200,200,200)';
			}
		}
		if (colourtype == 3)
		{
			colortoreturn = 'rgb(0,0,0)';
		}
		return colortoreturn;
	}
	
	midnode.prototype.highlightcolor = function() // highlight colour logic
	{
		// this logic defines the stripe colors that indicate search results, but could be edited to indicate other features such as traits
		return 'rgb('+(Math.round(255-254*this.searchin/numhits)).toString()+','+(Math.round(255-254*this.searchin/numhits)).toString()+','+(Math.round(255-254*this.searchin/numhits)).toString()+')';
	}
	
	midnode.prototype.datetextcolor = function() // date text colour logic
	{
		var colortoreturn = 'rgb(255,120,100)';
		if (colourtype == 2)
		{
			if ((this.lengthbr<150.8)&&(this.lengthbr>70.6))
			{
				colortoreturn = 'rgb(0,0,0)';
			}
		}
		if (colourtype == 3)
		{
			colortoreturn = 'rgb(255,255,255)';
		}
		return colortoreturn;
	}
	
	midnode.prototype.richnesstextcolor = function() // richness text colour logic
	{
		var colortoreturn = 'rgb(200,200,255)';
		if (colourtype == 2)
		{
			if ((this.lengthbr<150.8)&&(this.lengthbr>70.6))
			{
				colortoreturn = 'rgb(0,0,250)';
			}
		}
		if (colourtype == 3)
		{
			colortoreturn = 'rgb(255,255,255)';
		}
		return colortoreturn;
	}
	
	// it is not advisable to edit below this point unless you are trying to sort out the display of custom trait data
	
	// *** there are three types of leaves that are drawn by the code
	// *** 1.) Fake leaf: where the tree continues but is smaller than the size threshold it is sometimes
	// *** asthetically pleasing to draw a leaf there, especially if the threshold is a few pixels wide.  If the threshold is much smaller it does not matter if the facke leaf is drawn or not.
	// *** 2.) Growth leaf: where growing animations are taking place there should be leaves on the tips of the branches
	// *** 3.) Tip leaf: these are the classic leaves in which species names are put - these are the tips of the complete tree.
	// *** all leaf classes can be defined with custom logic in the three scripts below
	
	midnode.prototype.fakeleaflogic = function(x,y,r,angle)
	{
		context.strokeStyle = this.leafcolor2();
		context.fillStyle = this.leafcolor1();	
		if (leaftype == 1)
		{
			drawleaf1(x,y,r);
		}
		else
		{
			drawleaf2(x,y,r,angle);
		}
	}
	
	midnode.prototype.growthleaflogic = function(x,y,r,angle)
	{
		context.strokeStyle = this.leafcolor2();
		context.fillStyle = this.leafcolor1();	
		if (leaftype == 1)
		{
			drawleaf1(x,y,r);
		}
		else
		{
			drawleaf2(x,y,r,angle);
		}
	}
	
	midnode.prototype.tipleaflogic = function(x,y,r,angle)
	{
		context.strokeStyle = this.leafcolor2();
		context.fillStyle = this.leafcolor1();	
		if (leaftype == 1)
		{
			drawleaf1(x,y,r);
		}
		else
		{
			drawleaf2(x,y,r,angle);
		}
	}
	
	
	// drawing the tree
	midnode.prototype.draw = function()
	{
		var x ;
		var y ;
		var r ;
		if(this.dvar)
		{
			if (this.rvar)
			{
				x = this.xvar;
				y = this.yvar;
				r = this.rvar;
			}
			if ((this.child1)&&(this.lengthbr > timelim))
			{
				if ((this.child1.richness_val) >= (this.child2.richness_val))
				{
					this.child1.draw ();
					this.child2.draw ();
				}
				else
				{
					this.child2.draw ();
					this.child1.draw ();
				}
			}
			var ing = false; // if we are in the region where graphics need to be drawn
			if((this.gvar)&&((polytype!=2)||(this.npolyt)))
			{
				
				ing = true;
				context.lineCap = "round";
				context.lineWidth = r*(this.bezr);
				context.beginPath();
				context.moveTo(x+r*(this.bezsx),y+r*this.bezsy);
				context.bezierCurveTo(x+r*(this.bezc1x),y+r*(this.bezc1y),x+r*(this.bezc2x),y+r*(this.bezc2y),x+r*(this.bezex),y+r*(this.bezey));
				context.strokeStyle = this.branchcolor();
				context.stroke();
				if ((highlight_search)&&(this.searchin > 0)) 
				{
					context.lineWidth = r*(this.bezr)/3;
					context.strokeStyle = 'rgb(255,255,255)';
					context.beginPath();
					context.moveTo(x+r*(this.bezsx),y+r*this.bezsy);
					context.bezierCurveTo(x+r*(this.bezc1x),y+r*(this.bezc1y),x+r*(this.bezc2x),y+r*(this.bezc2y),x+r*(this.bezex),y+r*(this.bezey));
					context.stroke();
					context.strokeStyle = this.highlightcolor();
					context.lineWidth = r*(this.bezr)/5.0;
					context.beginPath();
					context.moveTo(x+r*(this.bezsx),y+r*this.bezsy);
					context.bezierCurveTo(x+r*(this.bezc1x),y+r*(this.bezc1y),x+r*(this.bezc2x),y+r*(this.bezc2y),x+r*(this.bezex),y+r*(this.bezey));
					context.stroke();
				}
			}
			if (this.lengthbr > timelim)
			{
				if (((this.richness_val > 1)&&(r<=threshold))&&(timelim <= 0))
				{
					// we are drawing a fake leaf - ing is irrelevant as this is instead of drawing the children
					this.fakeleaflogic(x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*leafmult*0.75*partc,this.arca);
				}
				else
				{
					if (ing)
					{
						if (this.richness_val > 1)
						{
							if (this.lengthbr > timelim)
							{
								// interior node drawing starts here 
								// first set up the variables that decide text size
								var temp_twidth = (r*partc-r*partl2)*Twidth;
								var temp_theight = (r*partc-r*partl2)*Tsize/2.0;
								var temp_theight_2 = (r*partc-r*partl2)*Tsize/3.0;
								// this piece of logic draws the arc background if needed (no text)
								if ((highlight_search)&&(this.searchin > 0))
								{
									context.beginPath();
									context.arc(x+r*(this.arcx),y+r*this.arcy,r*this.arcr*(1-partl2/2.0),0,Math.PI*2,true);
									if ((this.npolyt)||(polytype == 3))
									{
										context.fillStyle = this.branchcolor();
									}
									else
									{
										context.fillStyle = this.highlightcolor();
									}
									context.fill();
								}
								if (((this.npolyt)||((highlight_search)&&(this.searchin > 0)))||(polytype == 3))
								{
									// we are drawing an internal circle
									context.beginPath();
									context.arc(x+r*(this.arcx),y+r*this.arcy,r*this.arcr*(1-partl2/2.0),0,Math.PI*2,true);
									context.lineWidth = r*this.arcr*partl2;
									context.strokeStyle = this.barccolor();
									context.stroke();
								}
								// internal text drawing starts here *****
								if ((this.npolyt)||(polytype == 3))
								{	
									if (datahastraits)
									{
									// drawing internal text
									if ( r > threshold*7)
									{
										// DRAW	PIECHARTS
										
										if (r > threshold*45)
										{
											
											context.fillStyle = 'rgb(255,255,255)';
											
											context.beginPath();
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/3.3,0,Math.PI*2,true);
											context.fill();
											
											if (r > threshold*250)
											{
												
												for (i = 0 ; i < 9 ; i ++)
												{
													context.beginPath();
													context.arc(x+r*this.arcx+temp_theight*i*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.05,0,Math.PI*2,true);
													context.fill();
												}
												context.fillStyle = redlistcolor("EX");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("EW");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("CR");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("EN");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("VU");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("NT");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("LC");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("DD");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = redlistcolor("NE");
												context.beginPath();
												context.arc(x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,0,Math.PI*2,true);
												context.fill();
												context.fillStyle = this.leafcolor3();
												autotext(false,"EX", x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"EW", x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"CR", x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"EN", x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"VU", x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"NT", x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"LC", x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"DD", x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,"NE", x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.09,temp_theight*0.04,temp_theight*0.04);
												autotext(false,conconvert("EX"), x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("EW"), x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("CR"), x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("EN"), x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("VU"), x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("NT"), x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("LC"), x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("DD"), x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												autotext(false,conconvert("NE"), x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.12,temp_theight*0.04,temp_theight*0.005);
												
												autotext(false,(Math.round(10000.0*(this.num_EX/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_EW/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_CR/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_EN/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_VU/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_NT/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_LC/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_DD/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												autotext(false,(Math.round(10000.0*(this.num_NE/this.richness_val))/100.0).toString() + " %", x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.045,temp_theight*0.04,temp_theight*0.008);
												
												autotext(false,(this.num_EX).toString() + " species", x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_EW).toString() + " species", x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_CR).toString() + " species", x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_EN).toString() + " species", x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_VU).toString() + " species", x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_NT).toString() + " species", x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_LC).toString() + " species", x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_DD).toString() + " species", x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												autotext(false,(this.num_NE).toString() + " species", x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.06,temp_theight*0.04,temp_theight*0.005);
												
												autotext(true,"Threatened", x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.132,temp_theight_2*0.04,temp_theight*0.005);
												autotext(true,"Threatened", x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.132,temp_theight_2*0.04,temp_theight*0.005);
												autotext(true,"Threatened", x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight_2*1.132,temp_theight_2*0.04,temp_theight*0.005);
											}
											
											var pieangle = 0;
											var newpieangle = pieangle+(this.num_LC/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}
											context.fillStyle = redlistcolor("LC")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle-0.1,newpieangle,false);
											pieangle +=(this.num_LC/this.richness_val)*Math.PI*2;
											context.fill();
											
											newpieangle = pieangle+(this.num_NT/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}
											context.fillStyle = redlistcolor("NT")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_NT/this.richness_val)*Math.PI*2;
											context.fill();
											
											newpieangle = pieangle+(this.num_VU/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}

											context.fillStyle = redlistcolor("VU")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_VU/this.richness_val)*Math.PI*2;
											context.fill();
											newpieangle = pieangle+(this.num_EN/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}

											context.fillStyle = redlistcolor("EN")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_EN/this.richness_val)*Math.PI*2;
											context.fill();
											newpieangle = pieangle+(this.num_CR/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}

											context.fillStyle = redlistcolor("CR")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_CR/this.richness_val)*Math.PI*2;
											context.fill();
											newpieangle = pieangle+(this.num_EW/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}

											context.fillStyle = redlistcolor("EW")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_EW/this.richness_val)*Math.PI*2;
											context.fill();
											newpieangle = pieangle+(this.num_EX/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}

											context.fillStyle = redlistcolor("EX")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_EX/this.richness_val)*Math.PI*2;
											context.fill();
											newpieangle = pieangle+(this.num_DD/this.richness_val)*Math.PI*2 +0.1;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}

											context.fillStyle = redlistcolor("DD")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_DD/this.richness_val)*Math.PI*2;
											context.fill();
											newpieangle = pieangle+(this.num_NE/this.richness_val)*Math.PI*2;
											if (newpieangle > Math.PI*2)
											{
												newpieangle = Math.PI*2;
											}

											context.fillStyle = redlistcolor("NE")
											context.beginPath();
											context.moveTo(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7);
											context.arc(x+r*this.arcx,y+r*this.arcy+temp_theight_2*1.7,temp_theight/4,pieangle,newpieangle,false);
											pieangle +=(this.num_NE/this.richness_val)*Math.PI*2;
											context.fill();
											
											context.fillStyle = intnodetextcolor;
											autotext(false,"conservation status" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.9,temp_twidth*0.5,temp_theight_2/5.0);
											
																						
										}
										
										// DO THE TEXT
									
										if ((this.child1)&&(this.lengthbr))
										{
											context.fillStyle = this.datetextcolor();
											if (this.lengthbr >10)
											{
												autotext(false,(Math.round((this.lengthbr)*10)/10.0).toString() + " Mya", x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.32,temp_twidth,temp_theight_2/1.5);
												autotext(false,gpmapper(this.lengthbr) + " Period", x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.82,temp_twidth,temp_theight_2/5.0);
											}
											else
											{
												if (this.lengthbr >1)
												{
													autotext(false,(Math.round((this.lengthbr)*100)/100.0).toString()  + " Mya", x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.32,temp_twidth,temp_theight_2/1.5);
													autotext(false,gpmapper(this.lengthbr) + " Period", x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.82,temp_twidth,temp_theight_2/5.0);
												}
												else
												{
													autotext(false,(Math.round((this.lengthbr)*10000)/10.0).toString()  + " Kya", x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.32,temp_twidth,temp_theight_2/1.5);
													autotext(false,gpmapper(this.lengthbr) + " Period", x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.82,temp_twidth,temp_theight_2/5.0);
												}
											}
										}
										
										var num_threatened = (this.num_CR + this.num_EN + this.num_VU);

										if ((this.inlabel == true)&&((this.name2) != null))
										{
											context.fillStyle = intnodetextcolor;
											autotext(true,this.name2 , x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.17,temp_twidth*1.35,temp_theight_2/1.5);
											
											context.fillStyle = this.richnesstextcolor();
											//*
											if (num_threatened > 0)
											{
												autotext(false,(this.richness_val).toString() + " species , " + (num_threatened).toString() + " threatened ( " + (Math.round((num_threatened)/(this.richness_val)*1000.0)/10.0).toString() + "% )" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.5,temp_twidth*1.2,temp_theight_2/4.3);
											}
											else
											{
												autotext(false,(this.richness_val).toString() + " species, none threatened" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.5,temp_twidth,temp_theight_2/4.3);
											}
											if(this.phylogenetic_diversity>1000.0) 
											{
												autotext(false,(Math.round(this.phylogenetic_diversity/100)/10.0).toString() + " billion years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.72,temp_twidth,temp_theight_2/5.0);
											}
											else
											{
												autotext(false,(Math.round(this.phylogenetic_diversity)).toString() + " million years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.72,temp_twidth,temp_theight_2/5.0);
											}
											
											var linkpos = 0;
											
											if ((this.npolyt)||(polytype != 2))
											{
												if ((highlight_search)&&(this.searchin > 0))
												{
													context.fillStyle = this.hitstextcolor();
													if (this.searchin > 1)
													{
														autotext(false,(this.searchin).toString() + " hits" ,  x+r*this.arcx-temp_theight_2*0.3,y+r*this.arcy-temp_theight_2*1.95,temp_twidth*0.5,temp_theight_2*0.2);
													}
													else
													{
														autotext(false,"1 hit" ,  x+r*this.arcx-temp_theight_2*0.3,y+r*this.arcy-temp_theight_2*1.95,temp_theight_2*0.6,temp_theight_2*0.2);
													}
													linkpos = temp_theight_2*0.45;
												}
											}
											if ( r > threshold*100)
											{
												if ((this.linkclick)&&((!this.child1.linkclick)&&(!this.child2.linkclick)))
												{
													context.fillStyle = 'rgb(0,0,0)';
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.12,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = 'rgb(255,255,255)';
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.1,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = intnodetextcolor;
													context.fillStyle = 'rgb(0,0,0)';
													
													autotext(true,"Wikipedia", x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.17,temp_theight_2/10.0);
												}
												else
												{
													context.fillStyle = 'rgb(255,255,255)';
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.12,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = this.branchcolor();
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.1,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = intnodetextcolor;
													context.fillStyle = 'rgb(255,255,255)';
													
													autotext(true,"Wikipedia", x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.17,temp_theight_2/10.0);
												}
											}
										}
										else
										{
											
											context.fillStyle = this.richnesstextcolor();
											autotext(false,(this.richness_val).toString() + " species",  x+r*this.arcx,y+r*this.arcy+temp_theight_2*-0.17,temp_twidth*1.35,temp_theight_2/1.5);
											
											if (num_threatened > 0)
											{
												if (num_threatened > 1)
												{
													autotext(false,(num_threatened).toString() + " of " + (this.richness_val).toString() + " species are threatened ( " + (Math.round((num_threatened)/(this.richness_val)*1000.0)/10.0).toString() + "% )" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.45,temp_twidth,temp_theight_2/5.0);
												}
												else
												{
													autotext(false,(num_threatened).toString() + " of " + (this.richness_val).toString() + " species is threatened ( " + (Math.round((num_threatened)/(this.richness_val)*1000.0)/10.0).toString() + "% )" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.45,temp_twidth,temp_theight_2/5.0);
												}
											}
											else
											{
												autotext(false,"no threatened species" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.45,temp_twidth*0.75,temp_theight_2/5.0);
											}
											if(this.phylogenetic_diversity>1000.0) 
											{
												autotext(false,(Math.round(this.phylogenetic_diversity/100)/10.0).toString() + " billion years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.65,temp_twidth,temp_theight_2/5.0);
											}
											else
											{
												autotext(false,(Math.round(this.phylogenetic_diversity)).toString() + " million years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.65,temp_twidth,temp_theight_2/5.0);
											}
											
											if ((this.npolyt)||(polytype != 2))
											{
												if ((highlight_search)&&(this.searchin > 0))
												{
													context.fillStyle = this.hitstextcolor();
													if (this.searchin > 1)
													{
														autotext(false,(this.searchin).toString() + " hits" ,  x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.85,temp_twidth*0.5,temp_theight_2*0.2);
													}
													else
													{
														autotext(false,"1 hit" ,  x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.85,temp_twidth*0.5,temp_theight_2*0.2);
													}
													
												}
											}
											
										}
									}
									}
									else
									{
									if ((this.child1)&&(this.lengthbr))
										{
											context.fillStyle = this.datetextcolor();
											if (this.lengthbr >10)
											{
												autotext(false,(Math.round((this.lengthbr)*10)/10.0).toString() + " Mya", x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.32,temp_twidth,temp_theight_2/1.5);
												autotext(false,gpmapper(this.lengthbr) + " Period", x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.82,temp_twidth,temp_theight_2/5.0);
											}
											else
											{
												if (this.lengthbr >1)
												{
													autotext(false,(Math.round((this.lengthbr)*100)/100.0).toString()  + " Mya", x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.32,temp_twidth,temp_theight_2/1.5);
													autotext(false,gpmapper(this.lengthbr) + " Period", x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.82,temp_twidth,temp_theight_2/5.0);
												}
												else
												{
													autotext(false,(Math.round((this.lengthbr)*10000)/10.0).toString()  + " Kya", x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.32,temp_twidth,temp_theight_2/1.5);
													autotext(false,gpmapper(this.lengthbr) + " Period", x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.82,temp_twidth,temp_theight_2/5.0);
												}
											}
										}
										if ((this.inlabel == true)&&((this.name2) != null))
										{
											context.fillStyle = intnodetextcolor;
											autotext(true,this.name2 , x+r*this.arcx,y+r*this.arcy-temp_theight_2*0.17,temp_twidth*1.35,temp_theight_2/1.5);
											
											context.fillStyle = this.richnesstextcolor();
											//*
											autotext(false,(this.richness_val).toString() + " species" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.5,temp_twidth*1.2,temp_theight_2/4.3);
											
											if(this.phylogenetic_diversity>1000.0) 
											{
												autotext(false,(Math.round(this.phylogenetic_diversity/100)/10.0).toString() + " billion years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.72,temp_twidth,temp_theight_2/5.0);
											}
											else
											{
												autotext(false,(Math.round(this.phylogenetic_diversity)).toString() + " million years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.72,temp_twidth,temp_theight_2/5.0);
											}
											
											var linkpos = 0;
											
											if ((this.npolyt)||(polytype != 2))
											{
												if ((highlight_search)&&(this.searchin > 0))
												{
													context.fillStyle = this.hitstextcolor();
													if (this.searchin > 1)
													{
														autotext(false,(this.searchin).toString() + " hits" ,  x+r*this.arcx-temp_theight_2*0.3,y+r*this.arcy-temp_theight_2*1.95,temp_twidth*0.5,temp_theight_2*0.2);
													}
													else
													{
														autotext(false,"1 hit" ,  x+r*this.arcx-temp_theight_2*0.3,y+r*this.arcy-temp_theight_2*1.95,temp_theight_2*0.6,temp_theight_2*0.2);
													}
													linkpos = temp_theight_2*0.45;
												}
											}
											if ( r > threshold*100)
											{
												if ((this.linkclick)&&((!this.child1.linkclick)&&(!this.child2.linkclick)))
												{
													context.fillStyle = 'rgb(0,0,0)';
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.12,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = 'rgb(255,255,255)';
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.1,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = intnodetextcolor;
													context.fillStyle = 'rgb(0,0,0)';
													
													autotext(true,"Wikipedia", x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.17,temp_theight_2/10.0);
												}
												else
												{
													context.fillStyle = 'rgb(255,255,255)';
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.12,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = this.branchcolor();
													context.beginPath();
													context.arc(x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.1,0,Math.PI*2,true);
													context.fill();
													context.fillStyle = intnodetextcolor;
													context.fillStyle = 'rgb(255,255,255)';
													
													autotext(true,"Wikipedia", x+r*this.arcx+linkpos,y+r*this.arcy-temp_theight_2*1.95,temp_theight*0.17,temp_theight_2/10.0);
												}
											}
										}
										else
										{
											
											context.fillStyle = this.richnesstextcolor();
											autotext(false,(this.richness_val).toString() + " species",  x+r*this.arcx,y+r*this.arcy+temp_theight_2*-0.17,temp_twidth*1.35,temp_theight_2/1.5);
				
											if(this.phylogenetic_diversity>1000.0) 
											{
												autotext(false,(Math.round(this.phylogenetic_diversity/100)/10.0).toString() + " billion years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.65,temp_twidth,temp_theight_2/5.0);
											}
											else
											{
												autotext(false,(Math.round(this.phylogenetic_diversity)).toString() + " million years total phylogenetic diversity" ,  x+r*this.arcx,y+r*this.arcy+temp_theight_2*0.65,temp_twidth,temp_theight_2/5.0);
											}
											
											if ((this.npolyt)||(polytype != 2))
											{
												if ((highlight_search)&&(this.searchin > 0))
												{
													context.fillStyle = this.hitstextcolor();
													if (this.searchin > 1)
													{
														autotext(false,(this.searchin).toString() + " hits" ,  x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.85,temp_twidth*0.5,temp_theight_2*0.2);
													}
													else
													{
														autotext(false,"1 hit" ,  x+r*this.arcx,y+r*this.arcy-temp_theight_2*1.85,temp_twidth*0.5,temp_theight_2*0.2);
													}
													
												}
											}
											
										}
									}
								}
								else
								{
									// polytomy node filling
									if (polytype ==1)
									{
										context.beginPath();
										context.arc(x+r*(this.arcx),y+r*this.arcy,r*this.arcr,0,Math.PI*2,true);
										context.fillStyle = this.barccolor();
										context.fill();
									}
								}
								// draw number of hits / number threatened
							}
						}
						else
						{
							// we are drawing a leaf
							this.tipleaflogic(x+((r)*this.arcx),y+(r)*this.arcy,r*this.arcr,this.arca);
							if ( (r*leafmult) > threshold*10)
							{
								this.leafdetail(x,y,r,leafmult,partc,partl2,Twidth,Tsize);
							}	
						}
					}
				}
			}
			if (this.lengthbr <= timelim)
			{
				if (this.richness_val > 1)
				{
					this.growthleaflogic(x+((r)*(this.arcx)),y+(r)*(this.arcy),r*leafmult*0.5*partc,this.arca);
				}
				else
				{
					this.tipleaflogic(x+((r)*this.arcx),y+(r)*this.arcy,r*this.arcr,this.arca);
					if ( (r*leafmult) > threshold*10)
					{
						this.leafdetail(x,y,r,leafmult,partc,partl2,Twidth,Tsize);
					}	
				}
			}
		}
	}
	
	midnode.prototype.leafdetail = function(x,y,r,leafmult,partc,partl2,Twidth,Tsize)
	{
		if ( r > threshold*6)
		{
			var temp_twidth = (r*leafmult*partc-r*leafmult*partl2)*Twidth;
			var temp_theight = ((r*leafmult*partc-r*leafmult*partl2)*Tsize/3.0);
			
			if (temp_theight*0.2 > threshold/2.5)
			{
				if (this.linkclick)
				{
					context.fillStyle = 'rgb(0,0,0)';
					context.beginPath();
					context.arc(x+r*this.arcx,y+r*this.arcy-temp_theight*1.75,temp_theight*0.2,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = 'rgb(255,255,255)';
					context.beginPath();
					context.arc(x+r*this.arcx,y+r*this.arcy-temp_theight*1.75,temp_theight*0.15,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = 'rgb(0,0,0)';
					autotext(true,"Wikipedia", x+r*this.arcx,y+r*this.arcy-temp_theight*1.75,temp_twidth*0.1,temp_theight*0.5);
				}
				else
				{
					context.fillStyle = 'rgb(255,255,255)';
					context.beginPath();
					context.arc(x+r*this.arcx,y+r*this.arcy-temp_theight*1.75,temp_theight*0.2,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = this.leafcolor2();
					context.beginPath();
					context.arc(x+r*this.arcx,y+r*this.arcy-temp_theight*1.75,temp_theight*0.15,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = this.leafcolor3();
					autotext(true,"Wikipedia", x+r*this.arcx,y+r*this.arcy-temp_theight*1.75,temp_twidth*0.1,temp_theight*0.5);
				}
			}
			
			context.fillStyle = this.leafcolor3();
			
			if (datahastraits)
			{
				if (this.cname)
				{
					if (this.hasname2)
					{
						autotext(true,this.name2 + " " + this.name1, x+r*this.arcx,y+r*this.arcy-temp_theight*1.2,temp_twidth*1,temp_theight*0.5);
					}
					else
					{
						autotext(true,this.name1, x+r*this.arcx,y+r*this.arcy-temp_theight*1.2,temp_twidth*1,temp_theight*0.5);
					}
					autotext2(false,this.cname,x+r*this.arcx,y+r*this.arcy,temp_twidth*1.6,temp_theight*0.75);
				}
				else
				{
					autotext(false,"No common name", x+r*this.arcx,y+r*this.arcy-temp_theight*1.2,temp_twidth*1,temp_theight*0.5);
					if (this.hasname2)
					{
						autotext2(true,this.name2 + " " + this.name1,x+r*this.arcx,y+r*this.arcy,temp_twidth*1.6,temp_theight*0.75);
					}
					else
					{
						autotext2(true,this.name1,x+r*this.arcx,y+r*this.arcy,temp_twidth*1.6,temp_theight*0.75);
					}
				}
				autotext(false,"Conservation status: " + this.redlist + " , " + "population " + this.poptxt() , x+r*this.arcx,y+r*this.arcy+temp_theight*1.6,temp_twidth*1.2,temp_theight*0.15);
				autotext(false,this.extxt() , x+r*this.arcx,y+r*this.arcy+temp_theight*1.2,temp_twidth*1.4,temp_theight*0.5);
				
				if (temp_theight*0.05 > threshold*1.5)
				{
					context.fillStyle = this.leafcolor3();
					
					for (i = 0 ; i < 9 ; i ++)
					{
						context.beginPath();
						context.arc(x+r*this.arcx+temp_theight*i*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.05,0,Math.PI*2,true);
						context.fill();
					}
					
					context.fillStyle = redlistcolor("EX");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("EW");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("CR");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("EN");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("VU");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("NT");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("LC");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("DD");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = redlistcolor("NE");
					context.beginPath();
					context.arc(x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,0,Math.PI*2,true);
					context.fill();
					context.fillStyle = this.leafcolor3();
					autotext(false,"EX", x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"EW", x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"CR", x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"EN", x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"VU", x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"NT", x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"LC", x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"DD", x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,"NE", x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.9,temp_theight*0.04,temp_theight*0.04);
					autotext(false,conconvert("EX"), x+r*this.arcx+temp_theight*0*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("EW"), x+r*this.arcx+temp_theight*1*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("CR"), x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("EN"), x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("VU"), x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("NT"), x+r*this.arcx+temp_theight*5*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("LC"), x+r*this.arcx+temp_theight*6*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("DD"), x+r*this.arcx+temp_theight*7*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(false,conconvert("NE"), x+r*this.arcx+temp_theight*8*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.921,temp_theight*0.04,temp_theight*0.005);
					autotext(true,"Threatened", x+r*this.arcx+temp_theight*2*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.879,temp_theight*0.04,temp_theight*0.005);
					autotext(true,"Threatened", x+r*this.arcx+temp_theight*3*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.879,temp_theight*0.04,temp_theight*0.005);
					autotext(true,"Threatened", x+r*this.arcx+temp_theight*4*0.15-4*0.15*temp_theight,y+r*this.arcy+temp_theight*1.879,temp_theight*0.04,temp_theight*0.005);
				}
			}
			else
			{
				if (this.hasname2)
				{
					autotext2(true,this.name2 + " " + this.name1,x+r*this.arcx,y+r*this.arcy,temp_twidth*1.6,temp_theight*0.75);
				}
				else
				{
					autotext2(true,this.name1,x+r*this.arcx,y+r*this.arcy,temp_twidth*1.6,temp_theight*0.75);
				}
			}
		}
	}
	
	function performsearch2(toclear)
	{
		var changedvar = false;
		var stringin = document.forms["myform"]["tosearchfor"].value;
		
		stringin = stringin.replace("extinct in the wild", "EW");
		stringin = stringin.replace("extinct", "EX");
		stringin = stringin.replace("critically endangered", "CR");
		stringin = stringin.replace("endangered", "EN");
		stringin = stringin.replace("vulnerable", "VU");
		stringin = stringin.replace("near threatened", "NT");
		stringin = stringin.replace("least concern", "LC");
		stringin = stringin.replace("data deficient", "DD");
		stringin = stringin.replace("not evaluated", "NE");
		
		var searchinpartsnew = stringin.split(" ");
		
		if (searchinpartsnew.length == searchinparts.length)
		{
			for (i = 0 ; i < searchinpartsnew.length ; i ++)
			{
				if (searchinpartsnew[i] != searchinparts[i])
				{
					changedvar = true;
				}
			}
		}
		else
		{
			changedvar = true;
		}
		
		if (latin_search != (document.forms["myform"]["latinsearch"].checked))
		{
			changedvar = true;
			latin_search = (document.forms["myform"]["latinsearch"].checked)
		}
		if (common_search != (document.forms["myform"]["commonsearch"].checked))
		{
			changedvar = true;
			common_search = (document.forms["myform"]["commonsearch"].checked)
		}
		if (trait_search != (document.forms["myform"]["traitsearch"].checked))
		{
			changedvar = true;
			trait_search = (document.forms["myform"]["traitsearch"].checked)
		}
		
		if (!changedvar)
		{
			if (toclear)
			{
				fulltree.semiclearsearch();
			}
			changedvar = false;
		}
		else
		{
			fulltree.clearsearch();
			searchinparts = searchinpartsnew;
			numhits = fulltree.search();
			changedvar = true;
		}
		return changedvar;
	}
	
	midnode.prototype.searchone = function(stringin,leafonly)
	{
		var foundstr = 0;
		
		if (document.forms["myform"]["traitsearch"].checked)
		{
			if ((((stringin == "EX")||(stringin == "EW"))||(((stringin == "EN")||(stringin == "CR"))||((stringin == "VU")||(stringin == "NT"))))||(((stringin == "DD")||(stringin == "LC"))||(stringin == "NE")))
			{
				if (!(this.child1))
				{
					if ((this.redlist)&&(this.redlist == stringin))
					{
						foundstr +=this.richness_val;
					}
				}
			}
			else
			{
				if (((stringin.toLowerCase() == "increasing")&&(this.popstab))&&(this.popstab == "I"))
				{
					foundstr +=this.richness_val;
				}
				else
				{
					if (((stringin.toLowerCase() == "decreasing")&&(this.popstab))&&(this.popstab == "D"))
					{
						foundstr +=this.richness_val;
					}
					else
					{
						if (((stringin.toLowerCase() == "stable")&&(this.popstab))&&(this.popstab == "S"))
						{
							foundstr +=this.richness_val;
						}
						else
						{
							if ((stringin.toLowerCase() == "threatened")&&((this.redlist)&&(((this.redlist == "CR")||(this.redlist == "EN"))||(this.redlist == "VU"))))
							{
								foundstr +=this.richness_val;
							}
						}
					}
				}
			}
		}
		if (foundstr == 0 && (document.forms["myform"]["latinsearch"].checked))
		{
			
			if ((stringin.toLowerCase()) == stringin)
			{
				if (!((leafonly)&&(this.child1)))
				{
					if ((this.hasname1)&&((this.name1.toLowerCase()).search(stringin) != -1))
					{
						foundstr += this.richness_val;
					}
					else
					{
						if ((this.name2)&&((this.name2.toLowerCase()).search(stringin) != -1))
						{
							foundstr +=this.richness_val;
						}
						
					}
				}
			}
			else
			{
				if (!((leafonly)&&(this.child1)))
				{
					if ((this.hasname1)&&((this.name1).search(stringin) != -1))
					{
						foundstr += this.richness_val;
					}
					else
					{
						if ((this.name2)&&((this.name2).search(stringin) != -1))
						{
							foundstr +=this.richness_val;
						}
						
					}
				}
			}
			
		}
		
		if (foundstr == 0 && (document.forms["myform"]["commonsearch"].checked))
		{
			
			if ((stringin.toLowerCase()) == stringin)
			{
				if ((this.cname)&&((this.cname.toLowerCase()).search(stringin) != -1))
				{
					foundstr +=this.richness_val;
				}
			}
			else
			{
				if ((this.cname)&&((this.cname).search(stringin) != -1))
				{
					foundstr +=this.richness_val;
				}
			}
		}	
		return foundstr;
	}
	
	function midnode (x)
	{
		// all the graphics parameters referenced from the reference point and reference scale which are set once and changed only when the fractal form is changed
		
		// for bezier curve (basic graphics element 1 of 2)
		var bezsx; // start x position
		var bezsy; // start y position
		var bezex; // end x position
		var bezey; // end y position
		var bezc1x; // control point 1 x position
		var bezc1y; // control point 2 y position
		var bezc2x; // control point 2 x position
		var bezc2y; // control point 2 y position
		var bezr; // line width
		
		// for the circle (basic graphics element 2 of 2)
		var arcx; // centre x position
		var arcy; // centre y position
		var arcr; // radius
		var arca; // angle of the arc
		
		// for the horizon (the region within which all graphics elements of this node and all its child nodes are contained)
		var hxmin; // min x value
		var hxmax; // max x value
		var hymin; // min y value
		var hymax; // max y value
		
		// for the graphics box (the region within which all graphics elements of this node alone (excluding its children) are contained
		var gxmin; // min x value
		var gxmax; // max x value
		var gymin; // min y value
		var gymax; // max y value
		
		// for the flight box (frames the region that defines a nice flight to the target after a search)
		var fxmin; // min x value
		var fxmax; // max x value
		var fymin; // min y value
		var fymax; // max y value
		
		// for the reference points of the two children
		var nextx1; // x refernece point for both children
		var nexty1; // y reference point for both children
		var nextx2; // x refernece point for both children
		var nexty2; // y reference point for both children
		var nextr1; // r (scale) reference for child 1
		var nextr2; // r (scale) reference for child 2
		
		// stores the refernce point and reference scale which get updated with each redraw of the page
		var xvar; // x
		var yvar; // y 
		var rvar; // the value of r for the current view (null means nothign to draw)
		
		// variables indicating if drawing is needed for this node or its children updated with each redraw of the page
		var dvar; // true if this or its children need to be drawn
		var gvar; // true if graphics elements in this node itself need to be drawn
		
		// flight and search data
		var searchin = 0;
		var startscore = 0; // gives this node a score for being the starting node
		var onroute = false;
		var targeted = false;
		var searchinpast = 0;
		var flysofarA = false;
		var flysofarB = false;
		
		// other data
		var npolyt = true; // true if node is NOT a polytomy
		var graphref = false; // true for one path of nodes through the tree, the IFIG is anchored on the node at the end of that path 
		this.inlabel = false; // tells if the node has primary and secondary labels to be plotted 
		this.insublabel = false; 
		this.linkclick = false; // tells if a link has been clicked

		this.phylogenetic_diversity = 0.0;
		
		// This part of the code initialises the mode from newick format
		var bracketscount = 0;
		var cut;
		var end;
		
		if (x.charAt(x.length-1) == ';')
		{
			x = x.substr(0,x.length-1);
		}
		
		if (x.charAt(0) == '(')
		{
			for (i = 0; i < x.length ; i++)
			{
				if (x.charAt(i) == '(')
				{
					bracketscount ++;
				}
				if (x.charAt(i) == ')')
				{
					bracketscount --;
				}
				if (x.charAt(i) == ',')
				{
					if (bracketscount == 1)
					{
						cut = i;
					}
				}
				if (bracketscount == 0)
				{
					end = i;
					i = x.length +1;
				}
			}
			
			var cut1 = x.substr(1,cut-1);
			var cut2 = x.substr(cut+1,end-cut-1);
			var cutname = x.substr(end+1,x.length-end);
			// this is an interior node with name 'cutname'
			// the two children are given by cut1 ad cut2
			
			var lengthcut = -1;
			for (i = 0; i < cutname.length ; i++)
			{
				if (cutname.charAt(i) == ':')
				{
					lengthcut = i;
				}
			}
			if (lengthcut == -1)
			{
				this.lengthbr = null;
			}
			else
			{
				this.lengthbr = parseFloat(cutname.substr(lengthcut+1,(cutname.length)-lengthcut));
				cutname = cutname.substr(0,lengthcut);
			}
			
			// at this stage cutname does not have the length data associated with it
			
			if ((cutname.length > 0)&&(cutname!=((parseFloat(cutname)).toString())))			
			{
				this.hasname2 = false;
				this.hasname1 = true;
				this.name2 = null;
				this.name1 = cutname;
			}
			else
			{
				this.hasname2 = false;
				this.hasname1 = false;
				this.name2 = null;
				this.name1 = null;
				this.cname = null;
			}
			
			// initialise children
			this.child1 = new midnode(cut1,this);
			this.child2 = new midnode(cut2,this);
			// initialise interior node variables
			this.richness_val = 0;
		}
		else
		{
			this.child1 = null;
			this.child2 = null;
			this.richness_val =0; // these richness values are sorted out later
			
			var lengthcut = -1;
			for (i = 0; i < x.length ; i++)
			{
				if (x.charAt(i) == ':')
				{
					lengthcut = i;
				}
			}
			if (lengthcut == -1)
			{
				this.lengthbr = null;
			}
			else
			{
				this.lengthbr = parseFloat(x.substr(lengthcut+1,(x.length)-lengthcut));
				x = x.substr(0,lengthcut);
			}
			
			if (x.length > 0)
			{
				lengthcut = -1;
				for (i = 0; i < x.length ; i++)
				{
					if (x.charAt(i) == '{')
					{
						lengthcut = i;
						i = x.length;
					}
				}
				if (lengthcut == -1)
				{
					// no metadata
					datahastraits = false;
				}
				else
				{
					// metadata

					/// ***** LEAF NODE SORT START

					this.cname = x.substr(lengthcut+1,(x.length)-lengthcut-2)
					x = x.substr(0,lengthcut);
					
					//*
					lengthcut = -1;
					for (i = 0; i < this.cname.length ; i++)
					{
						if (this.cname.charAt(i) == '_')
						{
							lengthcut = i;
							i = this.cname.length;
						}
					}
					if (lengthcut == -1)
					{
						// no conservationdata
						this.popstab = "U";
						this.redlist = "NE";
					}
					else
					{	
						this.redlist = this.cname.substr(lengthcut+1,(this.cname.length)-lengthcut-3);
						this.popstab = this.cname.substr((this.cname.length)-1,1);
						this.cname = this.cname.substr(0,lengthcut);
					}			
				}
				
				
				lengthcut = -1;
				for (i = 0; i < x.length ; i++)
				{
					if (x.charAt(i) == '_')
					{
						lengthcut = i;
						i = x.length;
					}
				}
				if (lengthcut == -1)
				{
					this.hasname2 = false;
					this.hasname1 = true;
					this.name2 = null;
					this.name1 = x;
				}
				else
				{
					this.hasname2 = true;
					this.hasname1 = true;
					this.name1 = x.substr(lengthcut+1,(x.length)-lengthcut-1);
					this.name2 =  x.substr(0,lengthcut);
				}
			}
			else
			{
				this.hasname2 = false;
				this.hasname1 = false;
				this.name2 = null;
				this.name1 = null;
				datahastraits = false;
			}
		}
	}

	midnode.prototype.extxt = function() // returns text for redlist status
	{
		if (this.redlist)
		{
			return conconvert(this.redlist);
		}
		else
		{
			return ("Not Evaluated");
		}
	}

	midnode.prototype.poptxt = function() // returns text for redlist status
	{
		if (this.popstab)
		{
			switch(this.popstab)
			{
				case "D":
				return ("decreasing");
				case "I":
				return ("increasing");
				case "S":
				return ("stable");
				case "U":
				{
					if ((this.redlist == "EX")||(this.redlist == "EW"))
					{
						return ("extinct");	
					}
					else
					{
						return ("stability unknown");
					}
				}
				default:
				if ((this.redlist == "EX")||(this.redlist == "EW"))
				{
					return ("extinct");	
				}
				else
				{
					return ("stability unknown");
				}
			}
			
		}
		else
		{
			if ((this.redlist == "EX")||(this.redlist == "EW"))
			{
				return ("extinct");	
			}
			else
			{
				return ("stability unknown");
			}
		}
	}
	
	function conconvert(casein)
	{
		switch(casein)
		{
			case "EX":
			return ("Extinct");
			case "EW":
			return ("Extinct in the Wild");
			case "CR":
			return ("Critically Endangered");
			case "EN":
			return ("Endangered");
			case "VU":
			return ("Vulnerable");
			case "NT":
			return ("Near Threatened");
			case "LC":
			return ("Least Concern");
			case "DD":
			return ("Data Deficient");
			case "NE":
			return ("Not Evaluated");
			default:
			return ("Not Evaluated");
		}
	}
	
	function conconvert2(casein)
	{
		switch(casein)
		{
			case "EX":
			return (0);
			case "EW":
			return (1);
			case "CR":
			return (2);
			case "EN":
			return (3);
			case "VU":
			return (4);
			case "NT":
			return (5);
			case "LC":
			return (6);
			case "DD":
			return (7);
			case "NE":
			return (8);
			default:
			return (9);
		}
	}
	
	// *****************************************************************************************
	// *****************************************************************************************
	// ******** there are no functions below this point that are designed to be edited *********
	// *****************************************************************************************
	// *****************************************************************************************

	// this is the logic that draws the leaves and could be edited or added to with additional functions
	
	function drawleaf1(x,y,r)
	{
		context.beginPath();
		context.arc(x,y,r*(1-partl2*1.5),0,Math.PI*2,true);
		context.lineWidth = r*(partl2*3);
		context.stroke();
		context.fill();
	}
	
	function drawleaf2(x,y,r,angle)
	{
		var tempsinpre = Math.sin(angle);
		var tempcospre = Math.cos(angle);
		var tempsin90pre = Math.sin(angle + Math.PI/2.0);
		var tempcos90pre = Math.cos(angle + Math.PI/2.0);
		
		var startx = x-r*(1-partl2*1)*tempcospre;
		var endx = x+r*(1-partl2*1)*tempcospre;
		var starty = y-r*(1-partl2*1)*tempsinpre;
		var endy = y+r*(1-partl2*1)*tempsinpre;
		var midy = (endy-starty)/3;
		var midx = (endx-startx)/3;
		
		context.beginPath();
		context.moveTo(startx,starty);
		context.bezierCurveTo(startx+midx+2*r/2.4*tempcos90pre,starty+midy+2*r/2.4*tempsin90pre,startx+2*midx+2*r/2.4*tempcos90pre,starty+2*midy+2*r/2.4*tempsin90pre,endx,endy);
		context.bezierCurveTo(startx+2*midx-2*r/2.4*tempcos90pre,starty+2*midy-2*r/2.4*tempsin90pre,startx+midx-2*r/2.4*tempcos90pre,starty+midy-2*r/2.4*tempsin90pre,startx,starty);
		context.lineWidth = r*(partl2*3);
		context.stroke();
		context.fill();
	}
	
	// SECTION 2: GLOBAL VARIABLE DECLARIATION
	
	// display size variables - there are defaults but these values are automatically changed later
	var widthres = 1000;
	var heightres = 600;
	var xmin = 0;
	var xmax = widthres;
	var ymin = 0;
	var ymax = heightres;
	
	var widthofcontrols = 920; 
	var widthofcontrols2 = 750; 
	var growthtimetot = 30; 
	var widthofinfobar = 620;

	var buttonoptions = 0;
	// data and graphics variables
	var context; // the graphics element
	var myCanvas; // the canvas
	var fulltree; // the full tree
	var datahastraits = false; // if data has traits

	// zoom and pan position variables
	var ws = 1; // current zoom
	var xp = widthres/2; // current x position
	var yp = heightres;  // current y position
	var wsinit; // used for comparison with ws to obtain zoom level
	var calculating = false; // if in the process of calculating for zoom
	
	// variables for mouse use
	var mousehold = false;
	var buttonhold = false;
	var popupbox = false;
	var tutorialmode = false;
	var mouseX;
	var mouseY; 
	var oldyp; // old y position for moving
	var oldxp; // old x position for moving
	
	// growth functions
	var timelim = -1; // used as a global variable by the growth function to store the current time limit
	var timeinc; // used as a global variable by the growth function to store the time scaling factor
	var t2; // second timing object for growth function
	var growing = false; // if in the process of growth
	var growingpause = false;
	
	// flight functons
	var flying = false; // if in the process of flying
	var countdownB = 0;
	var t; // timing object for flying
	
	// search functions
	var numhits;
	var searchinparts = [];
	var highlight_search = false;
	var latin_search = false;
	var common_search = true;
	var trait_search = true;	
	
	// variables indicating current preferences 
	var infotype = 0; // for the info bar
	var sensitivity = 0.8; // for mouse sensitivity
	var threshold =2; // for the detail threshold
	
	var mywindow;
	
	// INITIALISERS
	
	// this initialises the whole IFIG	
	function init()
	{
		myCanvas = document.getElementById("myCanvas");
		clearbuttons();
		buttonoptions = 0;
		
		context= myCanvas.getContext('2d'); // sort out the canvas element
		Resize_only();
		draw_loading();
		myCanvas.onmousedown = holdon;
		myCanvas.onmouseup = holdoff;
		myCanvas.onmouseout = holdoff;
		myCanvas.onmousemove = movemouse;
		if (myCanvas.addEventListener) 
		{
			myCanvas.addEventListener ("mousewheel", mousewheel, false);
			myCanvas.addEventListener ("DOMMouseScroll", mousewheel, false);
		}
		else 
		{
			if (myCanvas.attachEvent) 
			{
				myCanvas.attachEvent ("onmousewheel", mousewheel);
			}
		}
		setTimeout('init2()',10);
	}
	
	function init2()
	{
		// sort out event listeners for zoom and pan
		readintree(); // read in the tree and do all the necessary precalculations
		Reset(); // set the canvas size and draw the IFIG initial view
	}
	
	// read in the tree data
	function readintree()
	{
		datahastraits = true;
		// read in information from text input
		var stringin = document.forms["myform"]["datain"].value;
		fulltree = null;
		if (stringin)
		{
			// if there is data inputed use this as the tree
			fulltree = new midnode(stringin);
		}
		else
		{
			// otherwise use embedded data set at top of file
			userdata();
		}
		if (!datahastraits)
		{
			colourtype = 2;
		}
		// calculate species richness at all nodes
		fulltree.richness_calc();
		if (datahastraits)
		{
		fulltree.concalc();
		}
		// check all names and find monophyletic genera groups
		fulltree.name_calc();
		// calculate ages
		fulltree.phylogeneticdiv_calc();
		fulltree.age_calc();
		// calculate labels
		fulltree.inlabel_calc();
		fulltree.insublabel_calc(1);
		// update fractal form and do all precalculations
		update_form();	
		// resize canvas to fit
		Resize();
		// centre view on IFIG 
		fulltree.setxyr3r(40,widthres-40,40,heightres-40);
		// store initial zoom level
		wsinit = ws;
	}
	
	// resize the canvas to fit the space
	function Resize_only()
	{
		widthres = 1024; // default
		heightres = 660; // default
		if (document.body && document.body.offsetWidth) {
			widthres = document.body.offsetWidth;
			winH = document.body.offsetHeight;
		}
		if (document.compatMode=='CSS1Compat' &&
			document.documentElement &&
			document.documentElement.offsetWidth ) {
			widthres = document.documentElement.offsetWidth;
			heightres = document.documentElement.offsetHeight;
		}
		if (window.innerWidth && window.innerHeight) {
			widthres = window.innerWidth;
			heightres = window.innerHeight;
		}
		// need to allow for space for buttons and border etc.
		heightres = heightres - 60;
		widthres = widthres - 30;
		if (buttonoptions != 0)
		{
			heightres = heightres - 40;
			if (widthres < widthofcontrols)
			{
				heightres = heightres - 27; // add space for two rows of buttons
				if (widthres < widthofcontrols/2)
				{
					heightres = heightres - 27; // add space for three rows of buttons
					if (widthres < widthofcontrols/3)
					{
						heightres = heightres - 27; // add space for four rows of buttons
					}
				}
			}
		}
		if (((infotype != 0 || growing || growingpause) && (buttonoptions ==0) ))
		{
			heightres -= 42 // add space for infobar if needed
			if (widthres < widthofinfobar)
			{
				heightres -= 42
			}
		}
		
		if (widthres < widthofcontrols2)
			{
				heightres = heightres - 27; // add space for two rows of buttons
				if (widthres < widthofcontrols2/2)
				{
					heightres = heightres - 27; // add space for three rows of buttons
					if (widthres < widthofcontrols2/3)
					{
						heightres = heightres - 27; // add space for four rows of buttons
					}
				}
			}
		// change size of canvas
		var myCanvas = document.getElementById("myCanvas");
		myCanvas.width = widthres;
		myCanvas.height = heightres;
		// redraw canvas
	}
	
	function Resize()
	{
		Resize_only();
		draw2();
	}
	
	// reset the search and view to its start position
	function Reset()
	{		
		growthtimetot = 30;
		threshold =2;
		if ((growing)||(growingpause))
		{
			clearTimeout(t2);
			draw2();
			timelim = -1;
			Resize();
			growing = false;
			growingpause = false;
			Resize();
		}
		tutorialmode = false;
		popupbox = false;
		calculating = false;
		clearTimeout(t);
		flying = false;
		clearTimeout(t2);
		performclear();
		timelim = -1;
		fulltree.deanchor();
		fulltree.graphref = true;
		fulltree.clearsearch();
		fulltree.clearlinks();
		fulltree.clearonroute();
		fulltree.setxyr3r(40,widthres-40,40,heightres-40);
		wsinit = ws;
		Resize();
	}
	
	// MOUSE CONTROL, PAN AND ZOOM
	
	// if holding down left mouse button - prepare to pan
	function holdon(event)
	{
		popupbox = false;
		clearTimeout(t);
		flying = false;
		mouseY = event.clientY-myCanvas.offsetTop;
		mouseX = event.clientX-myCanvas.offsetLeft;
		fulltree.clearlinks();
		fulltree.links();
		if (fulltree.linkclick)
		{
			mousehold = false;
			buttonhold = true;
			calculating = true;
			draw2();
			calculating = false;
		}
		else
		{
			mousehold = true;
			oldyp = yp;
			oldxp = xp;
		}
	}
	
	// if releasing left mouse button
	function holdoff()
	{
		if (fulltree.linkclick)
		{
			// link out
			fulltree.wikilink();
		}
		fulltree.clearlinks();
		if (!popupbox)
		{
			draw2();
		}
		buttonhold = false;
		mousehold = false;
		calculating = false;
	}
	
	// mouse move, so if left button held redraw
	function movemouse(event)
	{
		if (mousehold)
		{
			yp = oldyp + (-mouseY+event.clientY -myCanvas.offsetTop);
			xp = oldxp + (-mouseX+event.clientX -myCanvas.offsetLeft);
			draw2();
		}
		else
		{
			if (!popupbox)
			{
				mouseY = event.clientY -myCanvas.offsetTop;
				mouseX = event.clientX -myCanvas.offsetLeft;
				calculating = true;
				fulltree.clearlinks();
				fulltree.links();
				draw2();
				calculating = false;
			}
		}
		
	}	
	
	// need to zoom in or out
	function mousewheel(event)
	{
		popupbox = false;
		if (!calculating)
		{
			clearTimeout(t);
			flying = false;
			if (!mousehold)
			{
				var delta = 0;
				if ('wheelDelta' in event) 
				{
					delta = event.wheelDelta;
				}
				else 
				{
					delta = -event.detail / 2;
				}
				
				mouseY = event.clientY -35;
				mouseX = event.clientX -10;
				
				if ((parseFloat(delta)) > 0.0)
				{
					calculating = true;
					zoomin(event)
				}
				else
				{
					calculating = true;
					zoomout(event)
				}
			}
			setTimeout('calcfalse()',1);
			// there is a tiny delay here to force redraw in all browsers when zooming a lot
		}
	}
	
	// handles the calculating flag
	function calcfalse()
	{
		calculating = false;
	}
	
	// zoom in function
	function zoomin(event)
	{
		clearTimeout(t);
		mouseY = event.clientY -myCanvas.offsetTop;
		mouseX = event.clientX -myCanvas.offsetLeft;
		flying = false;
		ws = ws/sensitivity;
		xp = mouseX + (xp-mouseX)/sensitivity;
		yp = mouseY + (yp-mouseY)/sensitivity;
		context.clearRect(0,0, widthres,heightres);
		draw2();
	}
	
	// zoom out function
	function zoomout(event)
	{
		mouseY = event.clientY -myCanvas.offsetTop;
		mouseX = event.clientX -myCanvas.offsetLeft;
		clearTimeout(t);
		flying = false;
		ws = ws*sensitivity;
		xp = mouseX + (xp-mouseX)*sensitivity;
		yp = mouseY + (yp-mouseY)*sensitivity;
		context.clearRect(0,0, widthres,heightres);
		draw2();		
	}
	
	// BUTTON CONTROL 
	
	function clearbuttons()
	{
		document.getElementById("growtxt").style.display = 'none';
		document.getElementById("viewtxt").style.display = 'none';
		document.getElementById("viewtxt2").style.display = 'none';
		document.getElementById("searchtxt").style.display = 'none';
	
		document.getElementById("detailincbutton").style.display = 'none';
		document.getElementById("detaildecbutton").style.display = 'none';
		document.getElementById("info button").style.display = 'none';
		document.getElementById("formbutton").style.display = 'none';
		document.getElementById("colourbutton").style.display = 'none';
		document.getElementById("polybutton").style.display = 'none';
		
		document.getElementById("revgbutton").style.display = 'none';
		document.getElementById("pausegbutton").style.display = 'none';
		document.getElementById("fastergbutton").style.display = 'none';
		document.getElementById("slowergbutton").style.display = 'none';
		document.getElementById("playgbutton").style.display = 'none';
		document.getElementById("startgbutton").style.display = 'none';
		document.getElementById("endgbutton").style.display = 'none';
		
		document.getElementById("searchtf").style.display = 'none';
		document.getElementById("searchbutton").style.display = 'none';
		document.getElementById("searchbutton2").style.display = 'none';
		document.getElementById("leapbutton").style.display = 'none';
		document.getElementById("flybutton").style.display = 'none';
		document.getElementById("latincheckbox").style.display = 'none';
		document.getElementById("latintxt").style.display = 'none';
		document.getElementById("commoncheckbox").style.display = 'none';
		document.getElementById("commontxt").style.display = 'none';
		document.getElementById("traitcheckbox").style.display = 'none';
		document.getElementById("traittxt").style.display = 'none';
		
		document.getElementById("datatxt").style.display = 'none';
		document.getElementById("datatxtin").style.display = 'none';
		document.getElementById("databutton").style.display = 'none';
		
	}
	
	function searchoptions()
	{
		clearbuttons();
		if (buttonoptions == 1)
		{
			buttonoptions = 0;
		}
		else
		{
			buttonoptions = 1;
			document.getElementById("searchtxt").style.display = '';
			document.getElementById("searchtf").style.display = '';
			document.getElementById("searchbutton").style.display = '';
			document.getElementById("searchbutton2").style.display = '';
			document.getElementById("leapbutton").style.display = '';
			document.getElementById("flybutton").style.display = '';
			document.getElementById("latincheckbox").style.display = '';
			document.getElementById("latintxt").style.display = '';
			if (datahastraits)
			{
				document.getElementById("commoncheckbox").style.display = '';
				document.getElementById("commontxt").style.display = '';
				document.getElementById("traitcheckbox").style.display = '';
			document.getElementById("traittxt").style.display = '';
			}
		}
		Resize();
	}
	
	function growoptions()
	{
		clearbuttons();
		if (buttonoptions == 2)
		{
			buttonoptions = 0;
		}
		else
		{
			buttonoptions = 2;
			document.getElementById("growtxt").style.display = '';
			document.getElementById("revgbutton").style.display = '';
			document.getElementById("pausegbutton").style.display = '';
			document.getElementById("fastergbutton").style.display = '';
			document.getElementById("slowergbutton").style.display = '';
			document.getElementById("playgbutton").style.display = '';
			document.getElementById("startgbutton").style.display = '';
			document.getElementById("endgbutton").style.display = '';
			if ((!growingpause) && (!growing))
			{
				growplay();
			}
		}
		Resize();
	}
	
	function viewoptions()
	{
		clearbuttons();
		if (buttonoptions == 3)
		{
			buttonoptions = 0;
		}
		else
		{
			buttonoptions = 3;
			document.getElementById("viewtxt").style.display = '';
			document.getElementById("detailincbutton").style.display = '';
			document.getElementById("detaildecbutton").style.display = '';
			document.getElementById("info button").style.display = '';
			document.getElementById("formbutton").style.display = '';
			document.getElementById("colourbutton").style.display = '';
			document.getElementById("polybutton").style.display = '';
			if (infotype != 0)
			{
				document.getElementById("viewtxt2").style.display = '';
			}
		}
		Resize();
	}
	
	function dataoptions()
	{
		clearbuttons();
		if (buttonoptions == 4)
		{
			buttonoptions = 0;
		}
		else
		{
			document.getElementById("datatxt").style.display = '';
			document.getElementById("datatxtin").style.display = '';
			document.getElementById("databutton").style.display = '';
			buttonoptions = 4;
		}
		Resize();
	}
	
	// change use of info display
	function toggledisplay()
	{
		if (infotype == 0)
		{
			widthofcontrols += 100;
			infotype = 3
			document.getElementById("viewtxt2").style.display = '';
		}
		else
		{
			if (infotype == 3)
			{
				infotype = 4
				document.getElementById("viewtxt2").style.display = '';
			}
			else
			{
				infotype = 0
				document.getElementById("viewtxt2").style.display = 'none';
				widthofcontrols -= 100;
			}	
		}
		Resize();
	}	
	
	// change level of detail in display
	function detailup()
	{
		if (threshold > 0.2)
		{
			threshold = threshold / 2.0;
		}
		draw2();
	}
	
	function detaildown()
	{
		if (threshold < 10.0)
		{
			threshold = threshold*2.0;
		}
		draw2();
	}

	// change fractal form of display
	function form_change()
	{
		clearTimeout(t);
		flying = false;
		if (viewtype == 1)
		{
			viewtype = 2;
		}
		else
		{
			if (viewtype == 2)
			{
				viewtype = 3;
			}
			else
			{
				viewtype = 1;
			}
		}
		draw_loading();
		setTimeout('form_change2()',1);
	}
	
	function form_change2()
	{
		update_form();
		Resize();
	}
	
	// change the way polytomies are displayed
	function polyt_change()
	{
		if (polytype == 0)
		{
			polytype = 1;
		}
		else
		{
			if (polytype == 1)
			{
				polytype = 2;
			}
			else
			{
				if (polytype == 2)
				{
					polytype = 3;
				}
				else
				{
					polytype = 0;
				}
			}
		}
		draw2();
	}
	
	// change colour scheme
	function colour_change()
	{
		if (colourtype == 1)
		{
			colourtype = 2;
		}
		else
		{
			if (colourtype == 2)
			{
				if (datahastraits)
				{
					colourtype = 3;
				}
				else
				{
					colourtype = 1;
				}
			}
			else
			{
				colourtype = 1;
			}
		}
		draw2();
	}
	
	// TEXT DRAWING TOOLS
	
	// text tool
	function autotext(initalic,texttodisp,textx,texty,textw,defpt)
	{
		if (defpt > 1.5)
		{
			// draws text within a bounding width but only if possible with font size > 1
			// if possible uses the defpt font size and centres the text in the box
			// otherwise fills the box
			context.textBaseline = 'middle';
			context.textAlign = 'left';
			if (initalic)
			{
				context.font = 'italic ' + (defpt).toString() + 'px '+fonttype;
			}
			else
			{
				context.font = (defpt).toString() + 'px '+ fonttype;
			}
			var testw = context.measureText(texttodisp).width;
			if (testw > textw)
			{
				if ((defpt*textw/testw) > 1.5)
				{
					if (initalic)
					{
						context.font = 'italic ' + (defpt*textw/testw).toString() + 'px '+fonttype;
					}
					else
					{
						context.font = (defpt*textw/testw).toString() + 'px '+fonttype;
					}
					context.fillText  (texttodisp , textx - textw/2.0,texty);
				}
			}
			else
			{
				context.fillText  (texttodisp , textx - (testw)/2.0,texty);
			}
		}
	}
	
	
	function autotext2(initalic,texttodisp,textx,texty,textw,defpt)
	{
		// x and y are the centres
		if (defpt >1.5)
		{
			// draws text within a bounding width but only if possible with font size > 1
			// if possible uses the defpt font size and centres the text in the box
			// otherwise fills the box
			context.textBaseline = 'middle';
			context.textAlign = 'center';
			if (initalic)
			{
				context.font = 'italic ' + (defpt).toString() + 'px '+fonttype;
			}
			else
			{
				context.font = (defpt).toString() + 'px '+ fonttype;
			}
						
			var centerpoint = (texttodisp.length)/2;
			var splitstr = texttodisp.split(" ");
			var print1 = " ";
			var print2 = " ";
			
			if (splitstr.length == 1)
			{
				context.fillText  (texttodisp , textx ,texty);
			}
			else
			{
				if (splitstr.length == 2)
				{
					print1  = (splitstr[0]);
					print2  = (splitstr[1]);
				}
				else
				{
					for (i = (splitstr.length -1) ; i >= 0 ; i--)
					{
						if ((print2.length)>centerpoint)
						{
							print1  = (" " + splitstr[i] + print1);
						}
						else
						{
							print2 = (" " + splitstr[i] + print2);
						}
					}
				}
				var testw = context.measureText(print2).width;
				if (testw < (context.measureText(print1).width))
				{
					testw = context.measureText(print1).width
				}
				if (testw > textw)
				{
					if ((defpt*textw/testw) > 1.5)
					{
						
						if (initalic)
						{
							context.font = 'italic ' + (defpt*textw/testw).toString() + 'px '+fonttype;
						}
						else
						{
							context.font = (defpt*textw/testw).toString() + 'px '+fonttype;
						}
						
						context.fillText  (print1 , textx ,texty-defpt*textw/testw/1.7);
						context.fillText  (print2 , textx ,texty+defpt*textw/testw/1.7);
					}
				}
				else
				{
					context.fillText  (print1 , textx ,texty-defpt/1.7);
					context.fillText  (print2 , textx ,texty+defpt/1.7);
				}
			}
		}
	}
	
	// POPUP BOX DRAWING
		
	function AboutOZ()
	{
		if (!popupbox)
		{
			
			if (tutorialmode)
			{
				tutorialmode = false;
				draw2();
				tutorialmode = true;
			}
			else
			{
				draw2();
			}
			popupbox = true;
			context.beginPath();
			context.lineWidth = 1;
			context.lineTo( myCanvas.width /6 , myCanvas.height *4/5 );
			context.lineTo( myCanvas.width /6, myCanvas.height /5);
			context.lineTo( myCanvas.width *5/6, myCanvas.height /5 );
			context.lineTo( myCanvas.width *5/6 , myCanvas.height *4/5 );
			context.fillStyle = 'rgba(0,0,0,0.85)';
			context.fill();
			context.fillStyle = 'rgb(255,255,255)';
			autotext(false,"OneZoom (TM) V1.0.360 (2012)" , myCanvas.width /2 , myCanvas.height *0.32 , myCanvas.width *0.6 , 20);
			autotext(false,"Please read the associated manuscript" , myCanvas.width /2 , myCanvas.height *0.37 , myCanvas.width *0.6 , 15);
			autotext(false,"\"OneZoom: A Fractal Explorer for the Tree of Life \"" , myCanvas.width /2 , myCanvas.height *0.42 , myCanvas.width *0.6 , 15);
			autotext(false,"written by J. Rosindell and L. J. Harmon" , myCanvas.width /2 , myCanvas.height *0.47 , myCanvas.width *0.6 , 15);
			autotext(false,"Concept and software by J. Rosindell, development by J. Rosindell and L. J. Harmon" , myCanvas.width /2 , myCanvas.height *0.56 , myCanvas.width *0.6 , 10);
			autotext(false,"Special thanks to Jonathan Eastman, James Foster, Custis Lisle, Ian Owens, William Pearse, Albert Phillimore and Andy Purvis" , myCanvas.width /2 , myCanvas.height *0.6 , myCanvas.width *0.6 , 10);
			autotext(false,"Data: The IUCN Red List of Threatened Species. Version 2012.1. <http://www.iucnredlist.org> and" , myCanvas.width /2 , myCanvas.height *0.64 , myCanvas.width *0.6 , 10);
			autotext(false,"\"The delayed rise of present-day mammals\" O.R.P. Bininda-Emonds  et.al. (2007) Nature 446, p.507" , myCanvas.width /2 , myCanvas.height *0.68 , myCanvas.width *0.6 , 10);
			autotext(false,"J. Rosindell is grateful to NERC for funding his research" , myCanvas.width /2 , myCanvas.height *0.72 , myCanvas.width *0.6 , 10);
		}
		else
		{
			popupbox = false;
			draw2();
		}
	}
	
	function LicenseOZ()
	{
		if (!popupbox)
		{
			if (tutorialmode)
			{
				tutorialmode = false;
				draw2();
				tutorialmode = true;
			}
			else
			{
				draw2();
			}
			popupbox = true;
			context.beginPath();
			context.lineWidth = 1;
			context.lineTo( myCanvas.width /6 , myCanvas.height *4/5 );
			context.lineTo( myCanvas.width /6, myCanvas.height /5);
			context.lineTo( myCanvas.width *5/6, myCanvas.height /5 );
			context.lineTo( myCanvas.width *5/6 , myCanvas.height *4/5 );
			context.fillStyle = 'rgba(0,0,0,0.85)';
			context.fill();
			context.fillStyle = 'rgb(255,255,255)';
			
			autotext(false,"OneZoom version 1.0.360 (2012)" , myCanvas.width /2 , myCanvas.height *0.25 , myCanvas.width *0.6 , 15);
			autotext(false,"Copyright (c) 2012 owned by James Rosindell and Imperial College, London" , myCanvas.width /2 , myCanvas.height *0.35 , myCanvas.width *0.6 , 10);
			autotext(false,"URL: www.onezoom.org - please refer to website for updates" , myCanvas.width /2 , myCanvas.height *0.39 , myCanvas.width *0.6 , 10);
			autotext(false,"Citation: \"OneZoom: A Fractal Explorer for the Tree of Life\" PLoS Biology (2012) Rosindell, J. and Harmon, L. J." , myCanvas.width /2 , myCanvas.height *0.43 , myCanvas.width *0.6 , 10);
			autotext(false,"All rights reserved. By using OneZoom, you agree to cite the associated paper in any resulting publications." , myCanvas.width /2 , myCanvas.height *0.47 , myCanvas.width *0.6 , 10);
			autotext(false,"Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\")," , myCanvas.width /2 , myCanvas.height *0.51 , myCanvas.width *0.6 , 10);
			autotext(false,"to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense," , myCanvas.width /2 , myCanvas.height *0.55 , myCanvas.width *0.6 , 10);
			autotext(false,"and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:" , myCanvas.width /2 , myCanvas.height *0.59 , myCanvas.width *0.6 , 10);
			autotext(false,"The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software." , myCanvas.width /2 , myCanvas.height *0.63 , myCanvas.width *0.6 , 10);
			autotext(false,"THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY," , myCanvas.width /2 , myCanvas.height *0.67 , myCanvas.width *0.6 , 10);
			autotext(false,"FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY," , myCanvas.width /2 , myCanvas.height *0.71 , myCanvas.width *0.6 , 10);
			autotext(false,"WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE." , myCanvas.width /2 , myCanvas.height *0.75 , myCanvas.width *0.6 , 10);
		}
		else
		{
			popupbox = false;
			draw2();
		}
	}
	
	function tutorialstart()
	{
		if (tutorialmode)
		{
			tutorialmode = false;
			draw2();
		}
		else
		{
			tutorialmode = true;
			draw2();
		}
	}
	
	// DRAWING ROUTINES

	function infobar()
	{
		document.getElementById("textout").innerHTML = '';
		if (growing || growingpause || (infotype != 0)|| buttonoptions != 0)
		{
			document.getElementById("textout").style.display = '';
		}
		else
		{
			document.getElementById("textout").style.display = 'none';
		}
		
		var toalter = "textout";
		if (buttonoptions ==3)
		{
			toalter = "viewtxt2";
		}
		
		
		if (buttonoptions == 3 || buttonoptions == 0)
		{
		if (infotype == 3)
		{
			var multret = ws/wsinit/fulltree.mult();
			//multret = Math.log(multret)/Math.log(10);
			
			if (multret<2500)
			{
				document.getElementById(toalter).innerHTML= ('<FONT COLOR="FFFFFF" >Current zoom level is ' + (Math.round(multret*10.0)/10.0).toString() + ' times magnification </FONT> ');
			}
			else
			{
				if (multret<1500000)
				{
					document.getElementById(toalter).innerHTML= ('<FONT COLOR="FFFFFF" >Current zoom level is ' + (Math.round(multret/1000.0)).toString() + ' thousand times magnification </FONT> ');
				}
				else
				{
					document.getElementById(toalter).innerHTML= ('<FONT COLOR="FFFFFF" >Current zoom level is ' + (Math.round(multret/100000.0)/10.0).toString() + ' million times magnification </FONT> ');
				}
				
			}
			
		}
		else
		{
			if (infotype == 4)
			{
				var multret = ws/wsinit/fulltree.mult();
				var mret = multret*widthres/8661.4;
				if (mret<1.5)
				{
					document.getElementById(toalter).innerHTML= ('<FONT COLOR="FFFFFF" >The complete image now measures at least ' + (Math.round(mret*1000.0)/10.0).toString() + ' Centimeters across </FONT>');
				}
				else
				{
					if (mret>1500)
					{
						document.getElementById(toalter).innerHTML= ('<FONT COLOR="FFFFFF" >The complete image now measures at least ' + (Math.round(mret/100)/10.0).toString() + ' Kilometers across </FONT>');
					}
					else
					{
						document.getElementById(toalter).innerHTML= ('<FONT COLOR="FFFFFF" >The complete image now measures at least ' + (Math.round(mret*10.0))/10.0.toString() + ' Meters across </FONT>');
					}
					
				}
				
			}
			else
			{

				document.getElementById("viewtxt2").style.display = 'none';
			}
		}
		}
		
			toalter = "growtxt";
		if (buttonoptions != 2)
		{
			toalter = "textout";
		}
		
		if (buttonoptions == 2 || buttonoptions == 0)
		{
			if ((growingpause || growing))
			{
			if (timelim >= 0 )
			{
				if (timelim >10)
				{
					document.getElementById(toalter).innerHTML = '<FONT COLOR="FFFFFF" >' + (Math.round(timelim*10)/10.0).toString() + ' Million years ago - ' + gpmapper(timelim) + ' Period </FONT>';
				}
				else
				{
					if (timelim >1)
					{
						document.getElementById(toalter).innerHTML =  '<FONT COLOR="FFFFFF" >' + (Math.round(timelim*100)/100.0).toString() + ' Million years ago - ' + gpmapper(timelim) + ' Period </FONT>';
					}
					else
					{
						document.getElementById(toalter).innerHTML =  '<FONT COLOR="FFFFFF" >' + (Math.round(timelim*10000)/10.0).toString() + ' Thousand years ago - ' + gpmapper(timelim) + ' Period </FONT>';
					}
				}
				if (growingpause)
				{
					document.getElementById(toalter).innerHTML += '<FONT COLOR="FFFFFF" >  (paused) </FONT>';
				}
		
			}
			}
			else
			{
				if (buttonoptions == 2 )
				{
					document.getElementById("growtxt").innerHTML = '<FONT COLOR="FFFFFF" > Present day </FONT>';
				}
			}
		}
	}
	
	function draw2()
	{
		fulltree.drawreg(xp,yp,220*ws);
		if ((((ws > 100)||(ws < 0.01))&&(!mousehold))) // possibly change these values
		{
			fulltree.reanchor();
			fulltree.drawreg(xp,yp,220*ws);
		}
		if (backgroundcolor)
		{
			context.fillStyle = backgroundcolor;
			context.fillRect(0,0,widthres,heightres);
		}
		else
		{
			context.clearRect(0,0,widthres,heightres);
		}
		fulltree.draw();
		context.beginPath();
		context.lineWidth = 1;
		context.strokeStyle = outlineboxcolor;
		context.moveTo( 0 , 0 );
		var myCanvas = document.getElementById("myCanvas");
		context.lineTo( myCanvas.width , 0 );
		context.lineTo( myCanvas.width , myCanvas.height );
		context.lineTo( 0 , myCanvas.height );
		context.lineTo( 0 , 0 );
		context.stroke();
		infobar();
		if (tutorialmode)
		{
			context.beginPath();
			context.lineWidth = 1;
			context.lineTo( myCanvas.width /6 , myCanvas.height *4/5 );
			context.lineTo( myCanvas.width /6, myCanvas.height /5);
			context.lineTo( myCanvas.width *5/6, myCanvas.height /5 );
			context.lineTo( myCanvas.width *5/6 , myCanvas.height *4/5 );
			context.fillStyle = 'rgba(0,0,0,0.85)';
			context.fill();
			context.fillStyle = 'rgb(255,255,255)';
			autotext(false,"OneZoom Tutorial" , myCanvas.width /2 , myCanvas.height *0.25 , myCanvas.width *0.6 , 22);
			autotext(false,"To exit the tutorial mode, press the 'Tutorial' button again, or press the 'Reset' button" , myCanvas.width /2 , myCanvas.height *0.35 , myCanvas.width *0.6 , 15);
			autotext(false,"To zoom in scroll up, to zoom out scroll down" , myCanvas.width /2 , myCanvas.height *0.39 , myCanvas.width *0.6 , 15);
			autotext(false,"To move, press and hold the left mouse button, then move the mouse" , myCanvas.width /2 , myCanvas.height *0.43 , myCanvas.width *0.6 , 15);
			autotext(false,"If you get lost and want to go back to the base of the tree press the 'Reset' button" , myCanvas.width /2 , myCanvas.height *0.47 , myCanvas.width *0.6 , 15);
			autotext(false,"The 'Search' button will bring up a panel of controls to allow searching of the tree" , myCanvas.width /2 , myCanvas.height *0.51 , myCanvas.width *0.6 , 15);
			autotext(false,"The 'Grow' button will allow you to see an animation of the tree growing" , myCanvas.width /2 , myCanvas.height *0.55 , myCanvas.width *0.6 , 15);
			autotext(false,"The 'Options' button allows you to change the look and colors of the tree" , myCanvas.width /2 , myCanvas.height *0.59 , myCanvas.width *0.6 , 15);
			autotext(false,"The 'Data' button allows you input your own data" , myCanvas.width /2 , myCanvas.height *0.63 , myCanvas.width *0.6 , 15);
			autotext(false,"The 'More' button takes you to the OneZoom website for updates and more trees" , myCanvas.width /2 , myCanvas.height *0.67 , myCanvas.width *0.6 , 15);
			autotext(false,"The 'License' button explains terms of use" , myCanvas.width /2 , myCanvas.height *0.75 , myCanvas.width *0.6 , 15);
			autotext(false,"The 'About' button gives production credits and version information" , myCanvas.width /2 , myCanvas.height *0.71 , myCanvas.width *0.6 , 15);
		}	
	}
	
	function Link2OZ()
	{
		mywindow = window.open("http://www.OneZoom.org");
	}
	
	function draw_loading()
	{
	
		infobar();
		Resize_only();
		if (backgroundcolor)
		{
			context.fillStyle = backgroundcolor;
			context.fillRect(0,0,widthres,heightres);
		}
		else
		{
			context.clearRect(0,0,widthres,heightres);
		}
		context.beginPath();
		context.lineWidth = 1;
		context.strokeStyle = outlineboxcolor;
		context.moveTo( 0 , 0 );
		var myCanvas = document.getElementById("myCanvas");
		context.lineTo( myCanvas.width , 0 );
		context.lineTo( myCanvas.width , myCanvas.height );
		context.lineTo( 0 , myCanvas.height );
		context.lineTo( 0 , 0 );
		context.stroke();

		context.beginPath();
		context.textBaseline = 'middle';
		context.textAlign = 'left';
		
		context.fillStyle = 'rgb(0,0,50)';
		context.font = '50px sans-serif';
		context.textAlign = 'center';
		context.fillText  ('Loading', widthres/2,heightres/2, widthres/2);

		return true;

	}
	
	// SORTING OUT THE LINKS TO OUTSIDE THE PAGE
	
	midnode.prototype.links = function()
	{
		var x ;
		var y ;
		var r ;
		if(this.dvar)
		{
			if (this.rvar)
			{
				var x = this.xvar;
				var y = this.yvar;
				var r = this.rvar;
			}
			if ((this.child1)&&(this.lengthbr > timelim))
			{
				if ((this.child1.links())||(this.child2.links()))
				{

						this.linkclick = true;
				}
			}
			
			var temp_twidth = (r*partc-r*partl2)*Twidth;
			var temp_theight = (r*partc-r*partl2)*Tsize/2.0;
			var temp_theight_2 = (r*partc-r*partl2)*Tsize/3.0;
			
			
			if (this.lengthbr > timelim)
			{
				if (this.gvar)
				{
					if (!(this.richness_val > 1))
					{
						// we are checking a leaf
						if ( (r*leafmult) > threshold*10)
						{
							if (this.leaflink(x,y,r,leafmult,partc,partl2,Twidth,Tsize))
							{

									this.linkclick = true;

							}
						}	
					}
					else
					{
						if ((this.npolyt)||(polytype == 3))
						{								
							if ( r > threshold*7)
							{
								if ((this.inlabel == true)&&((this.name2) != null))
								{
									var linkpos = 0;
									if ((this.npolyt)||(polytype != 2))
									{
										if ((highlight_search)&&(this.searchin > 0))
										{
											linkpos = temp_theight_2*0.45;
										}
									}
									if ( r > threshold*100)
									{
										if ((      ((mouseX-(x+r*this.arcx+linkpos))*(mouseX-(x+r*this.arcx+linkpos)))+  ((mouseY-(y+r*this.arcy-temp_theight_2*1.95))*(mouseY-(y+r*this.arcy-temp_theight_2*1.95)))    ) <= ((temp_theight*0.12)*(temp_theight*0.12)))
										{
											this.linkclick = true;
										}
									}
								}
							}
						}
					}
				}
			}
			if (this.lengthbr <= timelim)
			{
				if (!(this.richness_val > 1))
				{
					if ( (r*leafmult) > threshold*10)
					{
						if(this.leaflink(x,y,r,leafmult,partc,partl2,Twidth,Tsize))
						{

								this.linkclick = true;

						}
					}	
				}
			}
		}

		return this.linkclick;

	}

	midnode.prototype.leaflink = function(x,y,r,leafmult,partc,partl2,Twidth,Tsize)
	{
		if ( r > threshold*6)
		{
			var temp_twidth = (r*leafmult*partc-r*leafmult*partl2)*Twidth;
			var temp_theight = ((r*leafmult*partc-r*leafmult*partl2)*Tsize/3.0);
			if (temp_theight*0.2 > threshold/2.5)
			{
				if (((mouseX-(x+r*this.arcx))*(mouseX-(x+r*this.arcx)))+((mouseY-(y+r*this.arcy-temp_theight*1.75))*(mouseY-(y+r*this.arcy-temp_theight*1.75))) <= ((temp_theight*0.2)*(temp_theight*0.2)))
				{
					this.linkclick = true;
				}
			}
		}
		return this.linkclick;
	}
	
	midnode.prototype.clearlinks = function()
	{
		this.linkclick = false;
		if (this.child1)
		{
			this.child1.clearlinks();
			this.child2.clearlinks();	
		}
	}
	
	midnode.prototype.wikilink = function()
	{
		if (this.linkclick)
		{
			if (this.child1)
			{
				if (this.child1.linkclick)
				{
					this.child1.wikilink();
				}
				else
				{
					if (this.child2.linkclick)
					{
						this.child2.wikilink();	
					}
					else
					{
						mywindow = window.open("http://en.wikipedia.org/wiki/" + this.name2.toLowerCase());
					}
				}
			}
			else
			{
				mywindow = window.open("http://en.wikipedia.org/wiki/" + this.name2 + "_" + this.name1);
			}
		}
	}

	// FRACTAL FORM ALGORITHMS AND PRECALCULATIONS
	
	// variables that were used for all fractal forms
	var partc = 0.4;
	var partcint = 0.165;
	var partl1 = 0.55; // size of line
	var partl2 = 0.1;
	var ratio1 = 0.77; // size of larger branch
	var ratio2 = 0.47; // size of smaller branch
	var Tsize = 1.1;
	var Twidth = 1;
	var Psize = 0.70
	var leafmult = 3.2;
	var posmult = leafmult -2;
	
	midnode.prototype.precalc = function(x,y,r,angle)
	{
		this.arca = angle;
		var tempsinpre = Math.sin(angle);
		var tempcospre = Math.cos(angle);
		var tempsin90pre = Math.sin(angle + Math.PI/2.0);
		var tempcos90pre = Math.cos(angle + Math.PI/2.0);
		var atanpre;
		var atanpowpre;
		
		if (this.child1)
		{
			atanpre = Math.atan2((this.child1).richness_val,(this.child2).richness_val);
			atanpowpre = Math.atan2(Math.pow((this.child1).richness_val,0.5),Math.pow(((this.child2).richness_val),0.5));
		}
		
		var thisangleleft = 0.46;
		var thisangleright = 0.22;
		var thisratio1 = 1/1.3;;
		var thisratio2 = 1/2.25;
		
		var tempsin2 = Math.sin(angle + Math.PI*thisangleright);
		var tempcos2 = Math.cos(angle + Math.PI*thisangleright);
		var tempsin3 = Math.sin(angle - Math.PI*thisangleleft);
		var tempcos3 = Math.cos(angle - Math.PI*thisangleleft);
		
		if (this.child1)
		{
			
			if ((this.child1.richness_val) >= (this.child2.richness_val))
			{
				
				this.nextr1 = thisratio1; // r (scale) reference for child 1
				this.nextr2 = thisratio2; // r (scale) reference for child 2
				
				(this.child1).bezsx = -(0.3)*(tempcospre)/thisratio1;
				(this.child1).bezsy = -(0.3)*(tempsinpre)/thisratio1;
				(this.child1).bezex = tempcos2;
				(this.child1).bezey = tempsin2;
				(this.child1).bezc1x = -0.3*(tempcospre)/thisratio1;
				(this.child1).bezc1y = -0.3*(tempsinpre)/thisratio1;
				(this.child1).bezc2x = 0.15*(tempcospre)/thisratio1;
				(this.child1).bezc2y = 0.15*(tempsinpre)/thisratio1;
				(this.child1).bezr = partl1;
				
				(this.child2).bezsx = -(0.3)*(tempcospre)/thisratio2;
				(this.child2).bezsy = -(0.3)*(tempsinpre)/thisratio2;
				(this.child2).bezex = tempcos3;
				(this.child2).bezey = tempsin3;
				(this.child2).bezc1x = 0.1*(tempcospre)/thisratio2;
				(this.child2).bezc1y = 0.1*(tempsinpre)/thisratio2;
				(this.child2).bezc2x = 0.9*tempcos3;
				(this.child2).bezc2y = 0.9*tempsin3;
				(this.child2).bezr = partl1;
				
				this.nextx1 = (1.3*Math.cos(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty1 = (1.3*Math.sin(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempsin90pre; // y reference point for both children
				this.nextx2 = (1.3*Math.cos(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty2 = (1.3*Math.sin(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempsin90pre; // y reference point for both children
			}
			else
			{
				this.nextr2 = thisratio1; // r (scale) reference for child 1
				this.nextr1 = thisratio2; // r (scale) reference for child 2
				
				(this.child2).bezsx = -(0.3)*(tempcospre)/thisratio1;
				(this.child2).bezsy = -(0.3)*(tempsinpre)/thisratio1;
				(this.child2).bezex = tempcos2;
				(this.child2).bezey = tempsin2;
				(this.child2).bezc1x = -0.2*(tempcospre)/thisratio1;
				(this.child2).bezc1y = -0.2*(tempsinpre)/thisratio1;
				(this.child2).bezc2x = 0.15*(tempcospre)/thisratio1;
				(this.child2).bezc2y = 0.15*(tempsinpre)/thisratio1;
				(this.child2).bezr = partl1;
				
				(this.child1).bezsx = -(0.3)*(tempcospre)/thisratio2;
				(this.child1).bezsy = -(0.3)*(tempsinpre)/thisratio2;
				(this.child1).bezex = tempcos3;
				(this.child1).bezey = tempsin3;
				(this.child1).bezc1x = 0.1*(tempcospre)/thisratio2;
				(this.child1).bezc1y = 0.1*(tempsinpre)/thisratio2;
				(this.child1).bezc2x = 0.9*tempcos3;
				(this.child1).bezc2y = 0.9*tempsin3;
				(this.child1).bezr = partl1;
				
				this.nextx2 = (1.3*Math.cos(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty2 = (1.3*Math.sin(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempsin90pre; // y reference point for both children
				this.nextx1 = (1.3*Math.cos(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty1 = (1.3*Math.sin(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempsin90pre; // y reference point for both children
			}
			
			this.arcx = this.bezex;
			this.arcy = this.bezey;
			this.arcr = (this.bezr)/2;
			
			if (this.child1)
			{
				if ((this.child1.richness_val) >= (this.child2.richness_val))
				{
					this.child1.precalc (x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*thisratio1,angle + Math.PI*thisangleright);
					this.child2.precalc (x+((r)*(this.nextx2)),y+(r)*(this.nexty2),r*thisratio2,angle - Math.PI*thisangleleft);
				}
				else
				{
					this.child2.precalc (x+((r)*(this.nextx2)),y+(r)*(this.nexty2),r*thisratio1,angle + Math.PI*thisangleright);
					this.child1.precalc (x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*thisratio2,angle - Math.PI*thisangleleft);
				}
			}
		}
		else
		{
			this.arcx = this.bezex+posmult*(tempcospre);
			this.arcy = this.bezey+posmult*(tempsinpre);
			this.arcr = leafmult*partc;
		}
		
	}
	
	
	midnode.prototype.precalc2 = function(x,y,r,angle)
	{
		this.arca = angle;
		var tempsinpre = Math.sin(angle);
		var tempcospre = Math.cos(angle);
		var tempsin90pre = Math.sin(angle + Math.PI/2.0);
		var tempcos90pre = Math.cos(angle + Math.PI/2.0);
		var atanpre;
		var atanpowpre;
		
		if (this.child1)
		{
			atanpre = Math.atan2((this.child1).richness_val,(this.child2).richness_val);
			atanpowpre = Math.atan2(Math.pow((this.child1).richness_val,0.5),Math.pow(((this.child2).richness_val),0.5));
		}
		
		var thisangleleft = 0.5;
		var thisangleright = 0.2;
		var thisratio1 = ratio1;
		var thisratio2 = ratio2;
		var thislinewidth1;
		var thislinewidth2;
		if ((this.richness_val > 1)&&((this.child1)&&(this.child2)))
		{
			if ((this.child1.richness_val) >= (this.child2.richness_val))
			{
				thisangleright = 0.45-(atanpre)/Math.PI/0.5*0.449;
				thisangleleft = 0.45-(0.5-(atanpre)/Math.PI)/0.5*0.449;
				thisratio1 = 0.3+(atanpowpre)/Math.PI/0.5*0.5;
				thisratio2 = 0.3+(0.5-(atanpowpre)/Math.PI)/0.5*0.5;
			}
			else
			{
				thisangleleft = 0.45-(atanpre)/Math.PI/0.5*0.449;
				thisangleright = 0.45-(0.5-(atanpre)/Math.PI)/0.5*0.449;
				thisratio2 = 0.3+(atanpowpre)/Math.PI/0.5*0.5;
				thisratio1 = 0.3+(0.5-(atanpowpre)/Math.PI)/0.5*0.5;
			}
		}
		
		if (this.child1)
		{
			thislinewidth1 = (this.child1.richness_val)/((this.child1.richness_val)+(this.child2.richness_val));
			thislinewidth2 = (this.child2.richness_val)/((this.child1.richness_val)+(this.child2.richness_val));
		}
		
		var tempsin2 = Math.sin(angle + Math.PI*thisangleright);
		var tempcos2 = Math.cos(angle + Math.PI*thisangleright);
		var tempsin3 = Math.sin(angle - Math.PI*thisangleleft);
		var tempcos3 = Math.cos(angle - Math.PI*thisangleleft);
		
		if (this.child1)
		{
			if ((this.child1.richness_val) >= (this.child2.richness_val))
			{
				this.nextr1 = thisratio1; // r (scale) reference for child 1
				this.nextr2 = thisratio2; // r (scale) reference for child 2
				
				(this.child1).bezsx = -(0.3)*(tempcospre)/thisratio1;
				(this.child1).bezsy = -(0.3)*(tempsinpre)/thisratio1;
				(this.child1).bezex = tempcos2;
				(this.child1).bezey = tempsin2;
				(this.child1).bezc1x = 0;
				(this.child1).bezc1y = 0;
				(this.child1).bezc2x = 0.9*tempcos2;
				(this.child1).bezc2y = 0.9*tempsin2;
				(this.child1).bezr = partl1;
				
				(this.child2).bezsx = -(0.3)*(tempcospre)/thisratio2;
				(this.child2).bezsy = -(0.3)*(tempsinpre)/thisratio2;
				(this.child2).bezex = tempcos3;
				(this.child2).bezey = tempsin3;
				(this.child2).bezc1x = 0;
				(this.child2).bezc1y = 0;
				(this.child2).bezc2x = 0.3*tempcos3;
				(this.child2).bezc2y = 0.3*tempsin3;
				(this.child2).bezr = partl1;
				
				this.nextx1 = (1.3*Math.cos(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty1 = (1.3*Math.sin(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempsin90pre; // y reference point for both children
				this.nextx2 = (1.3*Math.cos(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty2 = (1.3*Math.sin(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempsin90pre; // y reference point for both children
			}
			else
			{
				this.nextr2 = thisratio1; // r (scale) reference for child 1
				this.nextr1 = thisratio2; // r (scale) reference for child 2
				
				(this.child2).bezsx = -(0.3)*(tempcospre)/thisratio1;
				(this.child2).bezsy = -(0.3)*(tempsinpre)/thisratio1;
				(this.child2).bezex = tempcos2;
				(this.child2).bezey = tempsin2;
				(this.child2).bezc1x = 0;
				(this.child2).bezc1y = 0;
				(this.child2).bezc2x = 0.9*tempcos2;
				(this.child2).bezc2y = 0.9*tempsin2;
				(this.child2).bezr = partl1;
				
				(this.child1).bezsx = -(0.3)*(tempcospre)/thisratio2;
				(this.child1).bezsy = -(0.3)*(tempsinpre)/thisratio2;
				(this.child1).bezex = tempcos3;
				(this.child1).bezey = tempsin3;
				(this.child1).bezc1x = 0;
				(this.child1).bezc1y = 0;
				(this.child1).bezc2x = 0.9*tempcos3;
				(this.child1).bezc2y = 0.9*tempsin3;
				(this.child1).bezr = partl1;
				
				this.nextx2 = (1.3*Math.cos(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty2 = (1.3*Math.sin(angle))+(((this.bezr)-(partl1*thisratio1))/2.0)*tempsin90pre; // y reference point for both children
				this.nextx1 = (1.3*Math.cos(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty1 = (1.3*Math.sin(angle))-(((this.bezr)-(partl1*thisratio2))/2.0)*tempsin90pre; // y reference point for both children
			}
			
			this.arcx = this.bezex;
			this.arcy = this.bezey;
			this.arcr = (this.bezr)/2;
			
			if (this.child1)
			{
				if ((this.child1.richness_val) >= (this.child2.richness_val))
				{
					this.child1.precalc2 (x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*thisratio1,angle + Math.PI*thisangleright);
					this.child2.precalc2 (x+((r)*(this.nextx2)),y+(r)*(this.nexty2),r*thisratio2,angle - Math.PI*thisangleleft);
				}
				else
				{
					this.child2.precalc2 (x+((r)*(this.nextx2)),y+(r)*(this.nexty2),r*thisratio1,angle + Math.PI*thisangleright);
					this.child1.precalc2 (x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*thisratio2,angle - Math.PI*thisangleleft);
				}
			}
		}
		else
		{
			this.arcx = this.bezex+posmult*(tempcospre);
			this.arcy = this.bezey+posmult*(tempsinpre);
			this.arcr = leafmult*partc;
		}
		
	}
	
	midnode.prototype.precalc3 = function(x,y,r,angle,dir)
	{
		this.arca = angle;
		var tempsinpre = Math.sin(angle);
		var tempcospre = Math.cos(angle);
		var tempsin90pre = Math.sin(angle + Math.PI/2.0);
		var tempcos90pre = Math.cos(angle + Math.PI/2.0);
		var atanpre;
		var atanpowpre;
		
		var thisangleleft = 0.2;
		var thisangleright = 0.1;
		var thisratio1 = 0.85;
		var thisratio2 = 0.42;
		var child1right = false;
		
		if (!dir)
		{
			var thisangleleft = 0.1;
			var thisangleright = 0.2;
			var thisratio1 = 0.42;
			var thisratio2 = 0.85;
			if (this.child1)
			{
				if ((this.child1.richness_val) < (this.child2.richness_val))
				{
					child1right = true;
				}
			}
		}
		else
		{
			if (this.child1)
			{
				if ((this.child1.richness_val) >= (this.child2.richness_val))
				{
					child1right = true;
				}
			}
		}
		
		var partl1a = partl1;
		var partl1b = partl1;
		var tempsin2 = Math.sin(angle + Math.PI*thisangleright);
		var tempcos2 = Math.cos(angle + Math.PI*thisangleright);
		var tempsin3 = Math.sin(angle - Math.PI*thisangleleft);
		var tempcos3 = Math.cos(angle - Math.PI*thisangleleft);
		
		if (this.child1)
		{
			
			if (child1right)
			{
				
				this.nextr1 = thisratio1; // r (scale) reference for child 1
				this.nextr2 = thisratio2; // r (scale) reference for child 2
				
				(this.child1).bezsx = -(0.3)*(tempcospre)/thisratio1;
				(this.child1).bezsy = -(0.3)*(tempsinpre)/thisratio1;
				(this.child1).bezex = tempcos2;
				(this.child1).bezey = tempsin2;
				(this.child1).bezc1x = -0.3*(tempcospre)/thisratio1;
				(this.child1).bezc1y = -0.3*(tempsinpre)/thisratio1;
				(this.child1).bezc2x = 0.15*(tempcospre)/thisratio1;
				(this.child1).bezc2y = 0.15*(tempsinpre)/thisratio1;
				(this.child1).bezr = partl1;
				
				(this.child2).bezsx = -(0.3)*(tempcospre)/thisratio2;
				(this.child2).bezsy = -(0.3)*(tempsinpre)/thisratio2;
				(this.child2).bezex = tempcos3;
				(this.child2).bezey = tempsin3;
				(this.child2).bezc1x = 0.1*(tempcospre)/thisratio2;
				(this.child2).bezc1y = 0.1*(tempsinpre)/thisratio2;
				(this.child2).bezc2x = 0.9*tempcos3;
				(this.child2).bezc2y = 0.9*tempsin3;
				(this.child2).bezr = partl1;
				
				this.nextx1 = (1.3*Math.cos(angle))+(((this.bezr)-(partl1a*thisratio1))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty1 = (1.3*Math.sin(angle))+(((this.bezr)-(partl1a*thisratio1))/2.0)*tempsin90pre; // y reference point for both children
				this.nextx2 = (1.3*Math.cos(angle))-(((this.bezr)-(partl1b*thisratio2))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty2 = (1.3*Math.sin(angle))-(((this.bezr)-(partl1b*thisratio2))/2.0)*tempsin90pre; // y reference point for both children
			}
			else
			{
				this.nextr2 = thisratio1; // r (scale) reference for child 1
				this.nextr1 = thisratio2; // r (scale) reference for child 2
				
				(this.child2).bezsx = -(0.3)*(tempcospre)/thisratio1;
				(this.child2).bezsy = -(0.3)*(tempsinpre)/thisratio1;
				(this.child2).bezex = tempcos2;
				(this.child2).bezey = tempsin2;
				(this.child2).bezc1x = -0.2*(tempcospre)/thisratio1;
				(this.child2).bezc1y = -0.2*(tempsinpre)/thisratio1;
				(this.child2).bezc2x = 0.15*(tempcospre)/thisratio1;
				(this.child2).bezc2y = 0.15*(tempsinpre)/thisratio1;
				(this.child2).bezr = partl1;
				
				(this.child1).bezsx = -(0.3)*(tempcospre)/thisratio2;
				(this.child1).bezsy = -(0.3)*(tempsinpre)/thisratio2;
				(this.child1).bezex = tempcos3;
				(this.child1).bezey = tempsin3;
				(this.child1).bezc1x = 0.1*(tempcospre)/thisratio2;
				(this.child1).bezc1y = 0.1*(tempsinpre)/thisratio2;
				(this.child1).bezc2x = 0.9*tempcos3;
				(this.child1).bezc2y = 0.9*tempsin3;
				(this.child1).bezr = partl1;
				
				this.nextx2 = (1.3*Math.cos(angle))+(((this.bezr)-(partl1a*thisratio1))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty2 = (1.3*Math.sin(angle))+(((this.bezr)-(partl1a*thisratio1))/2.0)*tempsin90pre; // y reference point for both children
				this.nextx1 = (1.3*Math.cos(angle))-(((this.bezr)-(partl1b*thisratio2))/2.0)*tempcos90pre; // x refernece point for both children
				this.nexty1 = (1.3*Math.sin(angle))-(((this.bezr)-(partl1b*thisratio2))/2.0)*tempsin90pre; // y reference point for both children
			}
			
			this.arcx = this.bezex;
			this.arcy = this.bezey;
			this.arcr = (this.bezr)/2;
			
			if (this.child1)
			{
				if (child1right)
				{
					this.child1.precalc3 (x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*thisratio1,angle + Math.PI*thisangleright,!dir);
					this.child2.precalc3 (x+((r)*(this.nextx2)),y+(r)*(this.nexty2),r*thisratio2,angle - Math.PI*thisangleleft,!dir);
				}
				else
				{
					this.child2.precalc3 (x+((r)*(this.nextx2)),y+(r)*(this.nexty2),r*thisratio1,angle + Math.PI*thisangleright,!dir);
					this.child1.precalc3 (x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*thisratio2,angle - Math.PI*thisangleleft,!dir);
				}
			}
		}
		else
		{
			this.arcx = this.bezex+posmult*0.9*(tempcospre);
			this.arcy = this.bezey+posmult*0.9*(tempsinpre);
			this.arcr = leafmult*partc*0.9;
		}
	}
	
	function update_form()	
	{
		// updates the view and all variables to match the current viewtype
		//fulltree.clearroute();
		fulltree.drawreg(xp,yp,220*ws);
		fulltree.move2();
		
		fulltree.bezsx = 0; // start x position
		fulltree.bezsy = 0; // start y position
		fulltree.bezex = 0; // end x position
		fulltree.bezey = -1; // end y position
		fulltree.bezc1x = 0; // control point 1 x position
		fulltree.bezc1y = -0.05; // control point 2 y position
		fulltree.bezc2x = 0; // control point 2 x position
		fulltree.bezc2y = -0.95; // control point 2 y position
		fulltree.bezr = partl1; // line width
		
		if (viewtype == 2)
		{
			fulltree.precalc2(xp,yp,220*ws,Math.PI*3/2);
		}
		else
		{
			if (viewtype == 3)
			{
				fulltree.bezsx = -Math.sin(Math.PI*0.05); // start x position
				fulltree.bezsy = 0; // start y position
				fulltree.bezex = -Math.sin(Math.PI*0.05); // end x position
				fulltree.bezey = -Math.cos(Math.PI*0.05); // end y position
				fulltree.bezc1x = -Math.sin(Math.PI*0.05); // control point 1 x position
				fulltree.bezc1y = -0.05; // control point 2 y position
				fulltree.bezc2x = -Math.sin(Math.PI*0.05); // control point 2 x position
				fulltree.bezc2y = -0.95; // control point 2 y position
				fulltree.bezr = partl1; // line width
				fulltree.precalc3(xp,yp,220*ws,Math.PI*(3/2-0.05),true,true);
			}
			else
			{
				fulltree.precalc(xp,yp,220*ws,Math.PI*3/2);
			}
		}
		fulltree.calchorizon();
		fulltree.graphref = true;
		fulltree.reref();
		//fulltree.clearsearch();
		Resize_only();
		fulltree.deanchor();
		fulltree.reref();
		fulltree.move3(40,widthres-40,40,heightres-40);		
		draw2();
	}
	
	// NODE OBJECT BASIC CALCULATIONS
	
	midnode.prototype.richness_calc = function()
	{
		if (this.child1)
		{
			this.richness_val =  (((this.child1).richness_calc())+((this.child2).richness_calc()));
		}
		else
		{
			if (this.richness_val <= 0)
			{
				this.richness_val = 1;
			}
		}
		return (this.richness_val);
	}
	
	midnode.prototype.concalc = function()
	{
		this.num_EX = 0;
		this.num_EW = 0;
		this.num_CR = 0;
		this.num_EN = 0;
		this.num_VU = 0;
		this.num_NT = 0;
		this.num_LC = 0;
		this.num_DD = 0;
		this.num_NE = 0;
		
		this.num_I = 0;
		this.num_D = 0;
		this.num_S = 0;
		this.num_U = 0;
		
		if (this.child1)
		{
			(this.child1).concalc();
			(this.child2).concalc();
			
			
			this.num_EX = ((this.child1).num_EX) + ((this.child2).num_EX);
			this.num_EW = ((this.child1).num_EW) + ((this.child2).num_EW);
			this.num_CR = ((this.child1).num_CR) + ((this.child2).num_CR);
			this.num_EN = ((this.child1).num_EN) + ((this.child2).num_EN);
			this.num_VU = ((this.child1).num_VU) + ((this.child2).num_VU);
			this.num_NT = ((this.child1).num_NT) + ((this.child2).num_NT);
			this.num_LC = ((this.child1).num_LC) + ((this.child2).num_LC);
			this.num_DD = ((this.child1).num_DD) + ((this.child2).num_DD);
			this.num_NE = ((this.child1).num_NE) + ((this.child2).num_NE);
			
			this.num_I = ((this.child1).num_I) + ((this.child2).num_I);
			this.num_D = ((this.child1).num_D) + ((this.child2).num_D);
			this.num_S = ((this.child1).num_S) + ((this.child2).num_S);
			this.num_U = ((this.child1).num_U) + ((this.child2).num_U);
			
		}
		else
		{
			this.num_EX = 0;
			this.num_EW = 0;
			this.num_CR = 0;
			this.num_EN = 0;
			this.num_VU = 0;
			this.num_NT = 0;
			this.num_LC = 0;
			this.num_DD = 0;
			this.num_NE = 0;
		
			this.num_I = 0;
			this.num_D = 0;
			this.num_S = 0;
			this.num_U = 0;
			
			if (this.redlist)
			{
				switch(this.redlist)
				{
					case "EX":
					{
						this.num_EX = 1;
						break;
					}
					case "EW":
					{
						this.num_EW = 1;
						break;
					}
					case "CR":
					{
						this.num_CR = 1;
						break;
					}
					case "EN":
					{
						this.num_EN = 1;
						break;
					}
					case "VU":
					{
						this.num_VU = 1;
						break;
					}
					case "NT":
					{
						this.num_NT = 1;
						break;
					}
					case "LC":
					{
						this.num_LC = 1;
						break;
					}
					case "DD":
					{
						this.num_DD = 1;
						break;
					}
					case "NE":
					{
						this.num_NE = 1;
						break;
					}
					default:
					{
						this.num_NE = 1;	
						break;
					}
				}
			}
			else
			{
				this.num_NE = 1;
			}
			
			if (this.popstab)
			{
				switch(this.popstab)
				{
					case "I":
					{
						this.num_I = 1;
						break;
					}
					case "S":
					{
						this.num_S = 1;
						break;
					}
					case "D":
					{
						this.num_D = 1;
						break;
					}
					case "U":
					{
						this.num_U = 1;
						break;
					}
					default:
					{
						this.num_U = 1;	
						break;
					}
				}
			}
			else
			{
				this.num_U = 1;
			}
			
		}
	}
	
	midnode.prototype.name_calc = function()
	{
		if (this.child1)
		{
			if (((this.child1).name_calc())==((this.child2).name_calc()))
			{
				this.name2 = ((this.child1).name2);
				this.hasname2 = true;
			}
		}
		return (this.name2);
	}
	
	midnode.prototype.phylogeneticdiv_calc = function()
	{
		this.phylogenetic_diversity = 0;
		if (this.child1)
		{
			this.phylogenetic_diversity += (this.child2).phylogeneticdiv_calc();
			this.phylogenetic_diversity += (this.child1).phylogeneticdiv_calc();
		}
		return (this.phylogenetic_diversity + this.lengthbr);
	}
	
	midnode.prototype.age_calc = function()
	{
		if ((this.lengthbr == 0)&&(this.child1))
		{
			this.npolyt = false;
		}
		else
		{
			this.npolyt = true;
		}
		var length_temp;
		length_temp = (this.lengthbr);
		if (this.child1)
		{
			(this.lengthbr) = (this.child2).age_calc();
			(this.lengthbr) = (this.child1).age_calc();
			return ((length_temp)+(this.lengthbr));
		}
		else
		{
			(this.lengthbr) = 0;
			return (length_temp);
		}	
	}
	
	midnode.prototype.inlabel_calc = function()
	{
		if (this.child1)
		{
			if (!(this.name2))
			{
				if (this.child1.name2)
				{
					this.child1.inlabel = true;
				}
				else
				{
					this.child1.inlabel_calc();
				}
				if (this.child2.name2)
				{
					this.child2.inlabel = true;
				}
				else
				{
					this.child2.inlabel_calc();
				}
			}
			if (this.hasname1)
			{
				this.inlabel = true;
				this.name2 = this.name1;
				this.hasname2 = true;
			}
		}
		
	}
	
	midnode.prototype.insublabel_calc = function(num_since)
	{
		if ((this.richness_val >= 10)&&(this.child1))
		{
			if (this.inlabel)
			{
				this.child1.insublabel_calc(0);
				this.child2.insublabel_calc(0);
			}
			else
			{
				if (num_since >=1)
				{
					this.insublabel = true;
					this.child1.insublabel_calc(0);
					this.child2.insublabel_calc(0);
				}
				else
				{
					this.child1.insublabel_calc(num_since+1);
					this.child2.insublabel_calc(num_since+1);
				}
			}
		}
		else
		{
			if (this.richness_val >= 1)
			{
				if (this.hasname2)
				{
					this.inlabel = true;
				}
				else
				{
					this.insublabel = true;
				}
			}
		}
	}
	
	// DEEP ZOOM REREFERENCING METHODS (COMPLEX)
	
	// returns the product of all scaling factors so as to find out the total scaling difference
	midnode.prototype.mult = function ()
	{
		var multreturn;
		if (this.child1)
		{
			if (this.child1.graphref)
			{
				multreturn = (this.nextr1)*(this.child1.mult());
			}
			else
			{
				if (this.child2.graphref)
				{
					multreturn = (this.nextr2)*(this.child2.mult());
				}
				else
				{
					multreturn = 1;
				}
			}
		}
		else
		{
			multreturn = 1;
		}
		return multreturn;
	}
	
	midnode.prototype.reref = function()
	{
		if (this.onroute)
		{
			this.graphref = true;
			if (this.child1)
			{
				if (this.child1.onroute)
				{
					this.child1.reref();
				}
				else
				{
					this.child1.graphref = false;
				}
				if (this.child2.onroute)
				{
					this.child2.reref();
				}
				else
				{
					this.child2.graphref = false;
				}	
			}
		}
	}
	
	midnode.prototype.calchorizon = function()
	{
		// find the bounding box for the bezier curve
		this.hxmax = this.bezsx;
		this.hxmin = this.bezsx;
		this.hymax = this.bezsy;
		this.hymin = this.bezsy;
		if (this.hxmax < this.bezc1x) { this.hxmax = this.bezc1x; }
		if (this.hxmin > this.bezc1x) { this.hxmin = this.bezc1x; }
		if (this.hymax < this.bezc1y) { this.hymax = this.bezc1y; }
		if (this.hymin > this.bezc1y) { this.hymin = this.bezc1y; }
		if (this.hxmax < this.bezc2x) { this.hxmax = this.bezc2x; }
		if (this.hxmin > this.bezc2x) { this.hxmin = this.bezc2x; }
		if (this.hymax < this.bezc2y) { this.hymax = this.bezc2y; }
		if (this.hymin > this.bezc2y) { this.hymin = this.bezc2y; }
		if (this.hxmax < this.bezex) { this.hxmax = this.bezex; }
		if (this.hxmin > this.bezex) { this.hxmin = this.bezex; }
		if (this.hymax < this.bezey) { this.hymax = this.bezey; }
		if (this.hymin > this.bezey) { this.hymin = this.bezey; }
		this.hxmax += this.bezr/2;
		this.hxmin -= this.bezr/2;
		this.hymax += this.bezr/2;
		this.hymin -= this.bezr/2;
		
		//expand the bounding box to include the arc if necessary
		if (this.hxmax < (this.arcx+this.arcr)) { this.hxmax = (this.arcx+this.arcr); }
		if (this.hxmin > (this.arcx-this.arcr)) { this.hxmin = (this.arcx-this.arcr); }
		if (this.hymax < (this.arcy+this.arcr)) { this.hymax = (this.arcy+this.arcr); }
		if (this.hymin > (this.arcy-this.arcr)) { this.hymin = (this.arcy-this.arcr); }
		// set the graphics bounding box before the horizon is expanded for children
		this.gxmax = this.hxmax;
		this.gxmin = this.hxmin;
		this.gymax = this.hymax;
		this.gymin = this.hymin;
		
		// check for children
		if(this.child1)
		{
			// if children calculate their horizons
			this.child1.calchorizon ();
			this.child2.calchorizon ();
			// and expand the bounding box if necessary
			if (this.hxmax < (this.nextx1+this.nextr1*this.child1.hxmax)) { this.hxmax = (this.nextx1+this.nextr1*this.child1.hxmax); }
			if (this.hxmin > (this.nextx1+this.nextr1*this.child1.hxmin)) { this.hxmin = (this.nextx1+this.nextr1*this.child1.hxmin); }
			if (this.hymax < (this.nexty1+this.nextr1*this.child1.hymax)) { this.hymax = (this.nexty1+this.nextr1*this.child1.hymax); }
			if (this.hymin > (this.nexty1+this.nextr1*this.child1.hymin)) { this.hymin = (this.nexty1+this.nextr1*this.child1.hymin); }
			if (this.hxmax < (this.nextx2+this.nextr2*this.child2.hxmax)) { this.hxmax = (this.nextx2+this.nextr2*this.child2.hxmax); }
			if (this.hxmin > (this.nextx2+this.nextr2*this.child2.hxmin)) { this.hxmin = (this.nextx2+this.nextr2*this.child2.hxmin); }
			if (this.hymax < (this.nexty2+this.nextr2*this.child2.hymax)) { this.hymax = (this.nexty2+this.nextr2*this.child2.hymax); }
			if (this.hymin > (this.nexty2+this.nextr2*this.child2.hymin)) { this.hymin = (this.nexty2+this.nextr2*this.child2.hymin); }
		}
	}
		
	midnode.prototype.reanchor = function ()
	{
		if (this.dvar)
		{
			this.graphref = true;
			if (((this.gvar)||(!(this.child1)))||((this.rvar/220>0.01)&&(this.rvar/220<100)))
			{
				// reanchor here
				xp = this.xvar;
				yp = this.yvar;
				ws = this.rvar/220;
				if (this.child1)
				{
					this.child2.deanchor();
					this.child1.deanchor();
				}
			}
			else
			{
				// reanchor somewhere down the line
				if (this.child1.dvar)
				{
					this.child1.reanchor();
					this.child2.deanchor();
					
				}
				else
				{
					this.child2.reanchor();
					this.child1.deanchor();
				}
			}
		}
		// else not possible to reanchor
	}
	
	midnode.prototype.deanchor = function ()
	{
		if (this.graphref)
		{
			if (this.child1)
			{
				this.child1.deanchor();
				this.child2.deanchor();
			}
			this.graphref = false;
		}
	}
	
	midnode.prototype.drawreg = function(x,y,r)
	{
		// we assume that only those for whom graphref is true will call this routine
		if (this.child1)
		{
			// we are not a leaf and we are referencing - check children
			if (this.child1.graphref)
			{
				// child 1 leads to (or is) the referencing node
				this.child1.drawreg(x,y,r);
				this.rvar = this.child1.rvar/this.nextr1;
				this.xvar = this.child1.xvar-this.rvar*this.nextx1;
				this.yvar = this.child1.yvar-this.rvar*this.nexty1;
				this.dvar = false;
				this.child2.gvar = false;
				this.child2.dvar = false; 
				
				if(((!((((this.xvar+(this.rvar*this.hxmax))<0)||((this.xvar+(this.rvar*this.hxmin))>widthres))||(((this.yvar+(this.rvar*this.hymax))<0)||((this.yvar+(this.rvar*this.hymin))>heightres))))))
				{
					if (this.rvar > threshold)
					{
						
						this.child2.drawreg2 (this.xvar+((this.rvar)*(this.nextx2)),this.yvar+(this.rvar)*(this.nexty2),this.rvar*this.nextr2);
					}
					
					if(((((this.xvar+(this.rvar*this.gxmax))<0)||((this.xvar+(this.rvar*this.gxmin))>widthres))||(((this.yvar+(this.rvar*this.gymax))<0)||((this.yvar+(this.rvar*this.gymin))>heightres))))
					{
						this.gvar = false;
					}
					else
					{
						this.gvar = true;
						this.dvar = true;
					}
					if (this.rvar <= threshold)
					{
						this.child1.gvar = false;
						this.child2.gvar = false;
						this.child1.dvar = false;
						this.child2.dvar = false;
					}
				}
				else
				{
					this.gvar = false;
				}
				
				if ((this.child1.dvar)||(this.child2.dvar))
				{
					this.dvar = true;
				}
				
			}
			else
			{
				if (this.child2.graphref)
				{
					// child 2 leads to (or is) the referencing node
					this.child2.drawreg(x,y,r);
					this.rvar = this.child2.rvar/this.nextr2;
					this.xvar = this.child2.xvar-this.rvar*this.nextx2;
					this.yvar = this.child2.yvar-this.rvar*this.nexty2;
					this.dvar = false;
					this.child1.gvar = false;
					this.child1.dvar = false; 
					
					if(((!((((this.xvar+(this.rvar*this.hxmax))<0)||((this.xvar+(this.rvar*this.hxmin))>widthres))||(((this.yvar+(this.rvar*this.hymax))<0)||((this.yvar+(this.rvar*this.hymin))>heightres))))))
					{
						if (this.rvar > threshold)
						{
							this.child1.drawreg2 (this.xvar+((this.rvar)*(this.nextx1)),this.yvar+(this.rvar)*(this.nexty1),this.rvar*this.nextr1);	
						}
						
						if(((((this.xvar+(this.rvar*this.gxmax))<0)||((this.xvar+(this.rvar*this.gxmin))>widthres))||(((this.yvar+(this.rvar*this.gymax))<0)||((this.yvar+(this.rvar*this.gymin))>heightres))))
						{
							this.gvar = false;
						}
						else
						{
							this.gvar = true;
							
							this.dvar = true;
						}
						
						if (this.rvar <= threshold)
						{
							this.child1.gvar = false;
							this.child2.gvar = false;
							this.child1.dvar = false;
							this.child2.dvar = false;
						}
					}
					else
					{
						this.gvar = false;
					}
					
					if ((this.child1.dvar)||(this.child2.dvar))
					{
						this.dvar = true;
					}
				}
				else
				{
					// we are the referencing node so call drawreg2
					this.drawreg2(x,y,r);
				}
			}
		}
		else
		{
			// we are a leaf and we are referencing - we are the referencing node so record x,y,r
			this.drawreg2(x,y,r); //does all we need and will automatically skip any child commands
		}
	}
	
	midnode.prototype.drawreg2 = function(x,y,r)
	{
		this.xvar = x;
		this.yvar = y;
		this.rvar = r;
		this.dvar = false;	
		if(((!((((x+(r*this.hxmax))<0)||((x+(r*this.hxmin))>widthres))||(((y+(r*this.hymax))<0)||((y+(r*this.hymin))>heightres))))))
		{
			if (this.child1)
			{
				if (r > threshold)
				{
					this.child1.drawreg2 (x+((r)*(this.nextx1)),y+(r)*(this.nexty1),r*this.nextr1);
					this.child2.drawreg2 (x+((r)*(this.nextx2)),y+(r)*(this.nexty2),r*this.nextr2);
				}
				else
				{
					this.child1.gvar = false;
					this.child1.dvar = false; 
					this.child2.gavr = false;
					this.child2.dvar = false; 
				}
				
				if ((this.child1.dvar)||(this.child2.dvar))
				{
					this.dvar = true;
				}
			}
			if(((((x+(r*this.gxmax))<0)||((x+(r*this.gxmin))>widthres))||(((y+(r*this.gymax))<0)||((y+(r*this.gymin))>heightres))))
			{
				this.gvar = false;
			}
			else
			{
				this.gvar = true;
				this.dvar = true;

			}
		}
		else
		{
			this.gvar = false;
		}
	}
	
	// SEARCH UTILITIES
	
	midnode.prototype.search = function()
	{
		
		// initialize the search variables to the default (wipe previous searches)
		this.startscore = 0;
		this.targeted = false;
		this.searchinpast = 0; 
		this.flysofarA = false;
		this.flysofarB = false;
		var temphitsa = 0;
	
		var thishit = true;
		for (i = 0 ; i < searchinparts.length ; i ++)
		{
			if (!(this.searchone(searchinparts[i],false)))
			{
				thishit = false;
			}
		}
		if (thishit)
		{
			temphitsa += this.richness_val;
		}
		else
		{
			if (this.child1)
			{
				temphitsa += (this.child1).search();
				temphitsa += (this.child2).search();
			}
		}
		
		
		this.searchin = temphitsa;
		return temphitsa;
	}
	
	
	midnode.prototype.searchtarget = function()
	{
		// go down richerside and then use density as decider
		// keep going until density reaches threshold
		var searchresult = -1;
		if ((this.searchin-this.searchinpast)>0)
		{
			if (((this.searchin-this.searchinpast) / (this.richness_val))>0.7)
			{
				this.targeted = true;
				if ((this.child1)&&(((this.child1).searchin > 0)||((this.child2).searchin > 0)))
				{
					if ((((this.child1).searchin)-((this.child1).searchinpast)) <= 0)
					{
						var returned = (this.child2).searchtarget();
						
						searchresult = returned;
					}
					else
					{
						if ((((this.child2).searchin)-((this.child2).searchinpast)) <= 0)
						{
							var returned = (this.child1).searchtarget();
							
							searchresult = returned;
						}
						else
						{
							searchresult = this.searchin;
						}
					}
				}
				else
				{
					searchresult = this.searchin;
				}
			}
			else
			{
				if (this.child1)
				{
					var searchresult1 = this.child1.searchtarget();
					var searchresult2 = this.child2.searchtarget();
				}
				if (searchresult1 > searchresult2)
				{
					this.child1.targeted = true;
					this.child2.targeted = false;
					searchresult = searchresult1;
				}
				else
				{
					this.child2.targeted = true;
					this.child1.targeted = false;
					searchresult = searchresult2;
				}
			}	
		}
		return (searchresult);
	}
	
	midnode.prototype.searchtargetmark = function()
	{
		var searchresult = -1;
		if (this.targeted)
		{
			searchresult = this.searchin;
			if (this.child1)
			{
				if (this.child1.targeted)
				{
					searchresult = this.child1.searchtargetmark();
				}
				else
				{
					if (this.child2.targeted)
					{
						searchresult = this.child2.searchtargetmark();
					}
				}
			}
			this.searchinpast += searchresult;
		}
		return (searchresult);
	}
	
	midnode.prototype.clearsearch = function ()
	{
		(this.searchin) = 0;
		this.targeted = false;
		this.searchinpast = 0;
		this.flysofarA = false;
		this.flysofarB = false;
		if (this.child1)
		{
			(this.child1).clearsearch();
			(this.child2).clearsearch();
		}		
	}
	
	midnode.prototype.clearroute = function ()
	{
		this.onroute = false;
		if (this.child1)
		{
			(this.child1).clearroute();
			(this.child2).clearroute();
		}		
	}
	
	midnode.prototype.semiclearsearch = function ()
	{
		this.targeted = false;
		this.flysofarA = false;
		this.flysofarB = false;
		if (this.child1)
		{
			(this.child1).semiclearsearch();
			(this.child2).semiclearsearch();
		}		
	}
	
	midnode.prototype.setxyr = function(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,movement,propmove)
	{
		var vxmax;
		var vxmin;
		var vymax;
		var vymin;
		if (this.child1)
		{
			if (movement != 2)
			{
				vxmax = x+r*this.nextx1 + r*this.nextr1*this.child1.hxmax; 
				
				vxmin = x+r*this.nextx1 + r*this.nextr1*this.child1.hxmin; 
				
				vymax = y+r*this.nexty1 + r*this.nextr1*this.child1.hymax; 
				
				vymin = y+r*this.nexty1 + r*this.nextr1*this.child1.hymin; 
				if (movement != 1)
				{
					
					if (vxmax < (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmax)) 
					{ 
						vxmax = (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmax); 
					}
					if (vxmin > (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmin)) 
					{ 
						vxmin = (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmin); 
					}
					if (vymax < (y+r*this.nexty2 + r*this.nextr2*this.child2.hymax)) 
					{ 
						vymax = (y+r*this.nexty2 + r*this.nextr2*this.child2.hymax); 
					}
					if (vymin > (y+r*this.nexty2 + r*this.nextr2*this.child2.hymin)) 
					{ 
						vymin = (y+r*this.nexty2 + r*this.nextr2*this.child2.hymin); 
					}
				}
			}
			else
			{
				vxmax = x+r*this.nextx2 + r*this.nextr2*this.child2.hxmax; 
				vxmin = x+r*this.nextx2 + r*this.nextr2*this.child2.hxmin; 
				vymax = y+r*this.nexty2 + r*this.nextr2*this.child2.hymax; 
				vymin = y+r*this.nexty2 + r*this.nextr2*this.child2.hymin; 
			}
		}
		else
		{
			vxmax = (x+r*(this.arcx+this.arcr));
			vxmin = (x+r*(this.arcx-this.arcr));
			vymax = (y+r*(this.arcy+this.arcr));
			vymin = (y+r*(this.arcy-this.arcr));
		}
		
		if (vxmax < (x+r*(this.bezsx+this.bezex)/2)) { vxmax = (x+r*(this.bezsx+this.bezex)/2); }
		if (vxmin > (x+r*(this.bezsx+this.bezex)/2)) { vxmin = (x+r*(this.bezsx+this.bezex)/2); }
		if (vymax < (y+r*(this.bezsy+this.bezey)/2)) { vymax = (y+r*(this.bezsy+this.bezey)/2); }
		if (vymin > (y+r*(this.bezsy+this.bezey)/2)) { vymin = (y+r*(this.bezsy+this.bezey)/2); }
		
		var ywsmult = ((ytargmax-ytargmin)/(vymax-vymin));//propmove;
		// the number we need to multply ws by to get the right size for a vertical fit
		var xwsmult = ((xtargmax-xtargmin)/(vxmax-vxmin));//propmove;
		// the number we need to multply ws by to get the right size for a horizontal fit
		var wsmult;
		if (ywsmult > xwsmult)
		{
			// we use xwsmult - the smaller
			wsmult = xwsmult;
		}
		else
		{
			// we use ywsmult - the smaller
			wsmult = ywsmult;
		}
		xp += (((xtargmax+xtargmin)/2.0)-((vxmax+vxmin)/2.0));
		yp += (((ytargmax+ytargmin)/2.0)-((vymax+vymin)/2.0));
		ws = ws*wsmult;
		xp = widthres/2 + (xp-widthres/2)*wsmult;
		yp = heightres/2 + (yp-heightres/2)*wsmult;
	}
	
	midnode.prototype.setxyr3r = function(xtargmin,xtargmax,ytargmin,ytargmax)
	{
		
		ws = 1; 
		xp = widthres/2; 
		yp = heightres; 
		var x = xp;
		var y = yp;
		var r = 220*ws;
		
		var vxmax;
		var vxmin;
		var vymax;
		var vymin;
		
		if (this.child1)
		{
			vxmax = x+r*this.nextx1 + r*this.nextr1*this.child1.hxmax; 
			vxmin = x+r*this.nextx1 + r*this.nextr1*this.child1.hxmin; 
			vymax = y+r*this.nexty1 + r*this.nextr1*this.child1.hymax; 
			vymin = y+r*this.nexty1 + r*this.nextr1*this.child1.hymin; 
			if (vxmax < (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmax)) 
			{ 
				vxmax = (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmax); 
			}
			if (vxmin > (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmin)) 
			{ 
				vxmin = (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmin); 
			}
			if (vymax < (y+r*this.nexty2 + r*this.nextr2*this.child2.hymax)) 
			{ 
				vymax = (y+r*this.nexty2 + r*this.nextr2*this.child2.hymax); 
			}
			if (vymin > (y+r*this.nexty2 + r*this.nextr2*this.child2.hymin)) 
			{ 
				vymin = (y+r*this.nexty2 + r*this.nextr2*this.child2.hymin); 
			}
		}
		else
		{
			vxmax = (x+r*(this.arcx+this.arcr));
			vxmin = (x+r*(this.arcx-this.arcr));
			vymax = (y+r*(this.arcy+this.arcr));
			vymin = (y+r*(this.arcy-this.arcr));
		}
		if (vxmax < (x+r*(this.bezsx+this.bezex)/2)) { vxmax = (x+r*(this.bezsx+this.bezex)/2); }
		if (vxmin > (x+r*(this.bezsx+this.bezex)/2)) { vxmin = (x+r*(this.bezsx+this.bezex)/2); }
		if (vymax < (y+r*(this.bezsy+this.bezey)/2)) { vymax = (y+r*(this.bezsy+this.bezey)/2); }
		if (vymin > (y+r*(this.bezsy+this.bezey)/2)) { vymin = (y+r*(this.bezsy+this.bezey)/2); }
		
		var ywsmult = ((ytargmax-ytargmin)/(vymax-vymin));//propmove;
		// the number we need to multply ws by to get the right size for a vertical fit
		var xwsmult = ((xtargmax-xtargmin)/(vxmax-vxmin));//propmove;
		// the number we need to multply ws by to get the right size for a horizontal fit
		var wsmult;
		if (ywsmult > xwsmult)
		{
			// we use xwsmult - the smaller
			wsmult = xwsmult;
		}
		else
		{
			// we use ywsmult - the smaller
			wsmult = ywsmult;
		}
		
		xp += (((xtargmax+xtargmin)/2.0)-((vxmax+vxmin)/2.0));//*((1-(1/wsmult))/(1-(Math.pow((1/wsmult),propmove))));
		yp += (((ytargmax+ytargmin)/2.0)-((vymax+vymin)/2.0));//*((1-(1/wsmult))/(1-(Math.pow((1/wsmult),propmove))));
		
		ws = ws*wsmult;
		xp = widthres/2 + (xp-widthres/2)*wsmult;
		yp = heightres/2 + (yp-heightres/2)*wsmult;
	}
	
	midnode.prototype.setxyr2 = function(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,movement,propmove,flynum)
	{
		var vxmax;
		var vxmin;
		var vymax;
		var vymin;
		if (movement != 3)
		{
			vxmax = (x+r*(this.fxmax));//(x+r*(this.arcx+this.arcr));
			vxmin = (x+r*(this.fxmin));
			vymax = (y+r*(this.fymax));
			vymin = (y+r*(this.fymin));
		}
		else
		{
			if (this.child1)
			{
				vxmax = x+r*this.nextx1 + r*this.nextr1*this.child1.hxmax; 
				vxmin = x+r*this.nextx1 + r*this.nextr1*this.child1.hxmin; 
				vymax = y+r*this.nexty1 + r*this.nextr1*this.child1.hymax; 
				vymin = y+r*this.nexty1 + r*this.nextr1*this.child1.hymin; 
				if (vxmax < (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmax)) 
				{ 
					vxmax = (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmax); 
				}
				if (vxmin > (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmin)) 
				{ 
					vxmin = (x+r*this.nextx2 + r*this.nextr2*this.child2.hxmin); 
				}
				if (vymax < (y+r*this.nexty2 + r*this.nextr2*this.child2.hymax)) 
				{ 
					vymax = (y+r*this.nexty2 + r*this.nextr2*this.child2.hymax); 
				}
				if (vymin > (y+r*this.nexty2 + r*this.nextr2*this.child2.hymin)) 
				{ 
					vymin = (y+r*this.nexty2 + r*this.nextr2*this.child2.hymin); 
				}
			}
			else
			{
				vxmax = (x+r*(this.arcx+this.arcr));
				vxmin = (x+r*(this.arcx-this.arcr));
				vymax = (y+r*(this.arcy+this.arcr));
				vymin = (y+r*(this.arcy-this.arcr));
			}
			if (vxmax < (x+r*(this.bezsx+this.bezex)/2)) { vxmax = (x+r*(this.bezsx+this.bezex)/2); }
			if (vxmin > (x+r*(this.bezsx+this.bezex)/2)) { vxmin = (x+r*(this.bezsx+this.bezex)/2); }
			if (vymax < (y+r*(this.bezsy+this.bezey)/2)) { vymax = (y+r*(this.bezsy+this.bezey)/2); }
			if (vymin > (y+r*(this.bezsy+this.bezey)/2)) { vymin = (y+r*(this.bezsy+this.bezey)/2); }
		}
		
		var ywsmult = ((ytargmax-ytargmin)/(vymax-vymin));//propmove;
		// the number we need to multply ws by to get the right size for a vertical fit
		var xwsmult = ((xtargmax-xtargmin)/(vxmax-vxmin));//propmove;
		// the number we need to multply ws by to get the right size for a horizontal fit
		var wsmult;
		if (ywsmult > xwsmult)
		{
			// we use xwsmult - the smaller
			wsmult = xwsmult;
		}
		else
		{
			// we use ywsmult - the smaller
			wsmult = ywsmult;
		}
		
		wsmult =Math.pow(wsmult,(1.0/propmove));
		var xpadd;
		var ypadd;
		
		if (Math.abs(wsmult-1) < 0.000001)
		{
			xpadd = (((xtargmax+xtargmin)/2.0)-((vxmax+vxmin)/2.0));//*((1-(1/wsmult))/(1-(Math.pow((1/wsmult),propmove))));
			ypadd = (((ytargmax+ytargmin)/2.0)-((vymax+vymin)/2.0));//*((1-(1/wsmult))/(1-(Math.pow((1/wsmult),propmove))));
		}
		else
		{
			xpadd = (((xtargmax+xtargmin)/2.0)-((vxmax+vxmin)/2.0))*((1-(1/wsmult))/(1-(Math.pow((1/wsmult),propmove))));
			ypadd = (((ytargmax+ytargmin)/2.0)-((vymax+vymin)/2.0))*((1-(1/wsmult))/(1-(Math.pow((1/wsmult),propmove))));
		}
		xp+= xpadd;
		yp+= ypadd;
		ws = ws*wsmult;
		xp = widthres/2 + (xp-widthres/2)*wsmult;
		yp = heightres/2 + (yp-heightres/2)*wsmult;
	}
	
	midnode.prototype.move = function(xtargmin,xtargmax,ytargmin,ytargmax)
	{
		if (this.targeted)
		{
			this.graphref = true;
			if (this.child1)
			{
				if (this.child1.targeted)
				{
					this.child1.move(xtargmin,xtargmax,ytargmin,ytargmax);
				}
				else
				{
					if (this.child2.targeted)
					{
						this.child2.move(xtargmin,xtargmax,ytargmin,ytargmax);
					}
					else
					{
						this.setxyr3r(40,widthres-40,40,heightres-40);
						this.setxyr3r(40,widthres-40,40,heightres-40);
					}
				}
			}
			else
			{
				this.setxyr3r(40,widthres-40,40,heightres-40);
				this.setxyr3r(40,widthres-40,40,heightres-40);
			}
		}
	}	
	
	midnode.prototype.move3 = function(xtargmin,xtargmax,ytargmin,ytargmax)
	{
		if (this.onroute)
		{
			if (this.child1)
			{
				if (this.child1.onroute)
				{
					this.child1.move3(xtargmin,xtargmax,ytargmin,ytargmax);
				}
				else
				{
					if (this.child2.onroute)
					{
						this.child2.move3(xtargmin,xtargmax,ytargmin,ytargmax);
					}
					else
					{
						this.setxyr3r(40,widthres-40,40,heightres-40);
						this.setxyr3r(40,widthres-40,40,heightres-40);
					}
				}
			}
			else
			{
				this.setxyr3r(40,widthres-40,40,heightres-40);
				this.setxyr3r(40,widthres-40,40,heightres-40);
			}
		}
	}	
	
	midnode.prototype.move2 = function()
	{
		if (this.dvar)
		{
			this.onroute = true;
			if ((!(this.gvar))&&(this.child1))
			{
				if (!((this.child1.dvar)&&(this.child2.dvar)))
				{
					if (this.child1.dvar)
					{
						this.child1.move2();
					}
					else
					{
						if (this.child2.dvar)
						{
							this.child2.move2();
						}
					}
				}
			}
		}
	}
	
	midnode.prototype.clearonroute = function()
	{
		this.onroute = false;
		if (this.child1)
		{
			(this.child1).clearonroute();
			(this.child2).clearonroute();
		}
	}
	
	midnode.prototype.flyFB = function(xtargmin,xtargmax,ytargmin,ytargmax)
	{
		var x = this.xvar;
		var y = this.yvar;
		var r = this.rvar;
		if (this.targeted)
		{	
			if (this.flysofarB)
			{
				if (this.child1)
				{
					if (this.child1.targeted)
					{
						this.child1.flyFB(xtargmin,xtargmax,ytargmin,ytargmax);
					}
					else
					{
						if (this.child2.targeted)
						{
							this.child2.flyFB(xtargmin,xtargmax,ytargmin,ytargmax);
						}
						else
						{
							if (this.flysofarB )
							{
								if (flying)
								{
									clearTimeout(t);
									fulltree.searchtargetmark();
									flying = false;
								}
							}
							else
							{
								this.setxyr2(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,3,countdownB,2);
								if (countdownB <= 1)
								{
									this.flysofarB = true;
									
									countdownB = 6;
									
								}
								else
								{
									countdownB --;
								}
							}
						}
					}
				}
				else
				{
					if (this.flysofarB )
					{
						if (flying)
						{
							clearTimeout(t);
							fulltree.searchtargetmark();
							flying = false;
						}
					}
					else
					{
						this.setxyr2(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,3,countdownB,2);
						if (countdownB <= 1)
						{
							this.flysofarB = true;
							
							countdownB = 6;
							
						}
						else
						{
							countdownB --;
						}
					}
				}
			}
			else
			{
				if (this.child1)
				{
					if (this.child1.targeted)
					{
						this.setxyr2(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,1,countdownB,2);
						if (countdownB <= 1)
						{
							this.flysofarB = true;
							countdownB = 6;
							
						}
						else
						{
							countdownB --;
						}
					}
					else
					{
						if (this.child2.targeted)
						{
							this.setxyr2(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,2,countdownB,2);
							if (countdownB <= 1)
							{
								this.flysofarB = true;
								
								countdownB = 6;
								
							}
							else
							{
								countdownB --;
							}
						}
						else
						{
						
							if (this.flysofarB )
							{
								if (flying)
								{
									clearTimeout(t);
									fulltree.searchtargetmark();
									flying = false;
								}
							}
							else
							{
								this.setxyr2(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,3,countdownB,2);
								if (countdownB <= 1)
								{
									this.flysofarB = true;
									
									countdownB = 6;
									
								}
								else
								{
									countdownB --;
								}
							}
						}
					}
				}
				else
				{
					if (this.flysofarB )
					{
						if (flying)
						{
							clearTimeout(t);
							fulltree.searchtargetmark();
							flying = false;
						}
					}
					else
					{
						this.setxyr2(x,y,r,xtargmin,xtargmax,ytargmin,ytargmax,3,countdownB,2);
						if (countdownB <= 1)
						{
							this.flysofarB = true;
							
							countdownB = 6;
							
						}
						else
						{
							countdownB --;
						}
					}
				}
			}
		}
	}	
	
	midnode.prototype.prepfly = function(x,y,r)
	{
		if (this.targeted)
		{
			this.fxmax = this.gxmax;
			this.fxmin = this.gxmin;
			this.fymax = this.gymax;
			this.fymin = this.gymin;	
			
			// nothing to do otherwise
			if (this.child1)
			{
				if (this.child1.targeted)
				{
					this.child1.prepfly(x+r*this.nextx1,y+r*this.nexty1,r*this.nextr1);
					if (this.fxmax < (this.nextx1+this.nextr1*this.child1.fxmax)) { this.fxmax = (this.nextx1+this.nextr1*this.child1.fxmax) }
					if (this.fxmin > (this.nextx1+this.nextr1*this.child1.fxmin)) { this.fxmin = (this.nextx1+this.nextr1*this.child1.fxmin) }
					if (this.fymax < (this.nexty1+this.nextr1*this.child1.fymax)) { this.fymax = (this.nexty1+this.nextr1*this.child1.fymax) }
					if (this.fymin > (this.nexty1+this.nextr1*this.child1.fymin)) { this.fymin = (this.nexty1+this.nextr1*this.child1.fymin) }
					
				}
				else
				{
					if (this.child2.targeted)
					{
						this.child2.prepfly(x+r*this.nextx2,y+r*this.nexty2,r*this.nextr2);
						if (this.fxmax < (this.nextx2+this.nextr2*this.child2.fxmax)) { this.fxmax = (this.nextx2+this.nextr2*this.child2.fxmax) }
						if (this.fxmin > (this.nextx2+this.nextr2*this.child2.fxmin)) { this.fxmin = (this.nextx2+this.nextr2*this.child2.fxmin) }
						if (this.fymax < (this.nexty2+this.nextr2*this.child2.fymax)) { this.fymax = (this.nexty2+this.nextr2*this.child2.fymax) }
						if (this.fymin > (this.nexty2+this.nextr2*this.child2.fymin)) { this.fymin = (this.nexty2+this.nextr2*this.child2.fymin) }
						
					}
					else
					{
						this.fxmax = this.hxmax;
						this.fxmin = this.hxmin;
						this.fymax = this.hymax;
						this.fymin = this.hymin;	
					}
				}
			}
			else
			{
				this.fxmax = this.hxmax;
				this.fxmin = this.hxmin;
				this.fymax = this.hymax;
				this.fymin = this.hymin;	
			}
		}
	}	
	
	function marksearch()
	{
		performsearch2(false);
		highlight_search = true;
		draw2();
	}
	
	function unmarksearch()
	{
		highlight_search = false;
		draw2();
	}
	
	function performclear()
	{
		highlight_search = false;
		searchinparts = [];
		context.clearRect(0,0, widthres,heightres);
		draw2();
	}
	
	function performfly()
	{
		if (!flying)
		{
			fulltree.deanchor();
			fulltree.graphref = true;
			fulltree.setxyr(xp,yp,220*ws,20,widthres-2,20,heightres,0,1);
			fulltree.setxyr(xp,yp,220*ws,20,widthres-2,20,heightres,0,1);
			wsinit = ws;
			draw2();
			fulltree.semiclearsearch();
		
			flying = true;

			
			performsearch2(false);
			
			if (fulltree.searchtarget() == -1)
			{
				searchinparts = [];
				performsearch2(false);
				fulltree.searchtarget()
			}
			fulltree.targeted = true;
			//fulltree.searchtargetmark();
			countdownB = 12;
			fulltree.flysofarB = true;
			if (fulltree.child1)
			{
				if (fulltree.child1.targeted)
				{
					if (((fulltree.child1).child1)&&((fulltree.child1).child1.targeted||(fulltree.child1).child2.targeted))
					{
						fulltree.child1.flysofarB = true;
					}
				}
				if (fulltree.child2.targeted)
				{
					if (((fulltree.child2).child1)&&((fulltree.child2).child1.targeted||(fulltree.child2).child2.targeted))
					{
						fulltree.child2.flysofarB = true;
					}
				}
			}
			fulltree.prepfly(xp,yp,220*ws,5);
			performfly2();
		}
	}
	
	function performfly2()
	{
		fulltree.drawreg(xp,yp,220*ws);
		fulltree.flyFB(40,widthres-40,40,heightres-40);
		draw2();
		if (flying)
		{
			t = setTimeout('performfly2()',100);
		}
	}
	
	function performleap()
	{
		clearTimeout(t);
		flying = false;
		performsearch2(false);
		if (fulltree.searchtarget() == -1)
		{
			searchinparts = [];
			performsearch2(true);
			fulltree.searchtarget()
		}		
		fulltree.targeted = true;
		fulltree.searchtargetmark();
		fulltree.deanchor();		
		fulltree.move(40,widthres-40,40,heightres-40);
		draw2();
	}
	
	// GROW OPTIONS
	
	midnode.prototype.oldest = function()
	{
		var oldestreturn = 0.0;
		if(this.dvar)
		{
			if(this.gvar)
			{
				if (this.lengthbr)
				{
					if ( this.lengthbr > oldestreturn )
					{
						oldestreturn = this.lengthbr;
					}
				}
			}
			if (this.child1)
			{
				var oldestc1 = this.child1.oldest ();
				var oldestc2 = this.child2.oldest ();
				if (oldestc1 > oldestreturn)
				{
					oldestreturn = oldestc1;
				}
				if (oldestc2 > oldestreturn)
				{
					oldestreturn = oldestc2;
				}
			}
		}
		return oldestreturn;
	}
		
	function growstart()	
	{
		timelim = fulltree.oldest();
		clearTimeout(t2);
		growingpause = true;
		growing = false;
		Resize();
	}
	
	function growrev()			
	{
		if (timelim >= fulltree.oldest())
		{
			timelim = -0.001;
		}
		clearTimeout(t2);
		growingpause = false;
		growing = true;
		Resize();
		timeinc = fulltree.oldest()/(growthtimetot*10);
		grow3();
	}
	
	function growpause()
	{
		clearTimeout(t2);
		growingpause = true;
		growing = false;
		Resize();
	}
	
	function growplay()
	{
		if (timelim <= 0)
		{
			timelim = fulltree.oldest();
		}
		clearTimeout(t2);
		growingpause = false;
		growing = true;
		Resize();
		timeinc = fulltree.oldest()/(growthtimetot*10);
		grow2();
	}
	
	function growend()		
	{
		clearTimeout(t2);
		timelim = -1;
		clearTimeout(t2);
		growingpause = false;
		growing = false;
		Resize();
	}
	
	function growfaster()
	{
		
		growthtimetot = growthtimetot/1.25;
		timeinc = fulltree.oldest()/(growthtimetot*10);
	}
	
	function growslower()
	{
		growthtimetot = growthtimetot*1.25;
		timeinc = fulltree.oldest()/(growthtimetot*10);
	}
	
	function grow2()
	{
		if (timelim >= 0)
		{
			timelim -= timeinc;
			draw2();
			t2 = setTimeout('grow2()',100);
		}
		else
		{
			clearTimeout(t2);
			draw2();
			t2 = setTimeout('Resize()',500);
			growing = false;
			growingpause = false;
		}
	}
	
	function grow3()
	{
		if (timelim <= fulltree.oldest())
		{
			timelim += timeinc;
			draw2();
			t2 = setTimeout('grow3()',100);
		}
		else
		{
			clearTimeout(t2);
			draw2();
			t2 = setTimeout('Resize()',500);
			growing = false;
			growingpause = true;
		}
	}
	
	</script>
	
<title>  OneZoom - Everything on one page, all you have to do is zoom</title>

<body id = "wholebody" onLoad="init();" style="background-color:  rgb(0, 0, 0) " onresize="(Resize())">

	<center>
		 <a href="http://www.OneZoom.org" target="_blank"><FONT COLOR="FFFFFF">OneZoom</FONT></a><FONT COLOR="FFFFFF"> - Tree of Life &nbsp;</FONT>
		<button style = "cursor:pointer" type="button" id = "hbutton1" onclick="searchoptions();">Search</button> 
		<button style = "cursor:pointer" type="button" id = "hbutton2" onclick="growoptions();">Grow</button> 
		<button style = "cursor:pointer" type="button" id = "hbutton3" onclick="viewoptions();">Options</button>
		<button style = "cursor:pointer" type="button" id = "hbutton9" onclick="dataoptions();">Data</button>
		<button style = "cursor:pointer" type="button" id = "hbutton4" onclick="Reset();">Reset</button>
		<button style = "cursor:pointer" type="button" id = "hbutton5" onclick="tutorialstart();">Tutorial</button>
		<button style = "cursor:pointer" type="button" id = "hbutton6" onclick="Link2OZ();">More</button>
		<button style = "cursor:pointer" type="button" id = "hbutton7" onclick="AboutOZ();">About</button>
		<button style = "cursor:pointer" type="button" id = "hbutton8" onclick="LicenseOZ();">License</button>
	</center>
	
	<p </p>
	<center>
		<canvas id="myCanvas" ></canvas>
	</center>
	<p id="textout"></p>
	
	<form name="myform">
			
			<FONT COLOR="FFFFFF" id = "viewtxt"> Look and Feel </FONT> 
			<button style = "cursor:pointer"id = "detailincbutton" type="button" onclick="detaildown();">Detail -</button> 
			<button style = "cursor:pointer"id = "detaildecbutton" type="button" onclick="detailup();">Detail +</button> 
			<button style = "cursor:pointer"id = "info button" type="button" onclick="toggledisplay();">Zoom Level</button> 
			<button style = "cursor:pointer"id = "formbutton" type="button" onclick="form_change();">View Type</button> 
			<button style = "cursor:pointer"id = "colourbutton" type="button" onclick="colour_change();">Colour Scheme</button> 
			<button style = "cursor:pointer"id = "polybutton"type="button" onclick="polyt_change();">Show Polytomies</button> 
			
			<FONT COLOR="FFFFFF" id = "viewtxt2"> </FONT>
			  
			<button style = "cursor:pointer"id = "startgbutton" type="button" onclick="growstart();">Beginning</button>  		
			<button style = "cursor:pointer"id = "revgbutton" type="button" onclick="growrev();">Reverse</button>  		
			<button style = "cursor:pointer"id = "pausegbutton" type="button" onclick="growpause();">Pause</button>  
			<button style = "cursor:pointer"id = "playgbutton" type="button" onclick="growplay();">Play</button> 
			<button style = "cursor:pointer"id = "endgbutton" type="button" onclick="growend();">End</button>  	
			<button style = "cursor:pointer"id = "fastergbutton" type="button" onclick="growfaster();">Faster</button>  
			<button style = "cursor:pointer"id = "slowergbutton" type="button" onclick="growslower();">Slower</button>  
			<FONT COLOR="FFFFFF" id = "growtxt"> </FONT>
			
			<FONT COLOR="FFFFFF" id = "searchtxt"> Search </FONT> 
			<input id = "searchtf" type="text" name="tosearchfor" /> 
			<input id = "latincheckbox" type="checkbox" name="latinsearch" value="latinsearch" checked="checked" />  
			<FONT COLOR="FFFFFF" id = "latintxt"> Latin </FONT> 
			<input id = "commoncheckbox" type="checkbox" name="commonsearch" value="commonsearch" checked="checked" />  
			<FONT COLOR="FFFFFF" id = "commontxt"> Common </FONT>
			<input id = "traitcheckbox" type="checkbox" name="traitsearch" value="traitsearch" checked="checked" />  
			<FONT COLOR="FFFFFF" id = "traittxt"> Conservation </FONT>
			<button style = "cursor:pointer"id = "searchbutton" type="button" id= "markbutton" onclick="marksearch();">Mark Results</button> 
			<button style = "cursor:pointer"id = "searchbutton2" type="button" id= "markbutton" onclick="unmarksearch();">Unmark Results</button>  
			<button style = "cursor:pointer"id = "leapbutton" name="Flybutton" type="button" onclick="performleap();">Show Results</button> 
			<button style = "cursor:pointer"id = "flybutton" name="Flybutton" type="button" onclick="performfly();">Fly to Results</button> 
			
			<FONT COLOR="FFFFFF" id = "datatxt"> Data in newick format, ultrametric, polytomies as branch length zero - </FONT>
			<input type="text" id = "datatxtin" name="datain" width = "35" /> 
			<button type="button" id = "databutton" onclick="init();">Load data</button> 
			
	</form>
	
</body>
